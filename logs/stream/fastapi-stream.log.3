2025-09-12 05:43:31,067 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDCHF.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 0.796465, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:31,069 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 0.796465, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:32,036 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDCHF.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 0.7964549999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:32,037 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 0.7964549999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:32,067 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDCHF.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.7964549999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:32,068 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.7964549999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:36,043 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDCHF.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.796465, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:36,044 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.796465, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:36,073 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDCHF.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 0.796465, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:36,075 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 0.796465, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:37,044 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDCHF.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.7964549999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:37,045 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.7964549999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:37,072 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDCHF.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 0.7964549999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:37,074 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 0.7964549999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:40,040 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 0.6664, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:40,042 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 0.6664, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:40,070 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.6664, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:40,071 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.6664, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:41,040 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 0.6664300000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:41,042 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 0.6664300000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:41,045 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDCAD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.3841649999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:41,046 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.3841649999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:41,068 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.6664300000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:41,070 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.6664300000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:41,071 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDCAD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 1.3841649999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:41,072 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 1.3841649999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:44,039 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.435, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:44,040 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.435, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:44,069 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 147.435, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:44,070 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 147.435, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:45,035 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 0.66642, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:45,035 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 0.66642, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:45,069 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.66642, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:45,071 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.66642, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:46,036 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 172.8965, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:46,037 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 172.8965, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:46,038 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.8965, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:46,038 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.8965, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:47,039 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.GBPUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.3558050000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:47,040 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.3558050000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:47,042 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 147.4345, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:47,043 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 147.4345, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:47,044 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.4345, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:47,045 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.4345, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:47,051 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURUSD.CEEM.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 1.17261, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:47,052 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 1.17261, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:47,053 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURUSD.CEEM.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.17261, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:47,053 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.17261, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:47,068 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.GBPUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 1.3558050000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:47,069 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 1.3558050000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:50,041 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 98.25800000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:50,043 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 98.25800000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:50,045 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.25800000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:50,046 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.25800000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:50,050 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 0.6664049999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:50,051 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 0.6664049999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:50,052 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.GBPUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 1.3557649999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:50,054 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 1.3557649999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:50,055 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDCHF.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 0.796475, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:50,057 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 0.796475, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:50,058 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDCHF.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.796475, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:50,059 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.796475, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:50,061 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDCAD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 1.384175, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:50,062 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 1.384175, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:50,063 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURUSD.CEEM.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 1.1726, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:50,064 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 1.1726, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:50,065 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 147.4385, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:50,066 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 147.4385, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:50,072 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.6664049999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:50,073 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.6664049999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:50,075 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.GBPUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.3557649999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:50,076 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.3557649999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:50,079 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDCAD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.384175, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:50,080 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.384175, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:50,081 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.4385, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:50,082 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.4385, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:50,083 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURUSD.CEEM.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.1726, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:50,084 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.1726, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:50,200 - INFO - igstream.sync_manager - 📊 Database stats: 0 candles in last 30min, latest: None
2025-09-12 05:43:50,202 - WARNING - igstream.sync_manager - No candle data found for CS.D.GBPUSD.MINI.IP 5m
2025-09-12 05:43:50,204 - WARNING - igstream.sync_manager - No candle data found for CS.D.GBPUSD.MINI.IP 60m
2025-09-12 05:43:50,205 - WARNING - igstream.sync_manager - No candle data found for CS.D.USDJPY.MINI.IP 5m
2025-09-12 05:43:50,207 - WARNING - igstream.sync_manager - No candle data found for CS.D.USDJPY.MINI.IP 60m
2025-09-12 05:43:50,208 - WARNING - igstream.sync_manager - No candle data found for CS.D.AUDUSD.MINI.IP 5m
2025-09-12 05:43:50,209 - WARNING - igstream.sync_manager - No candle data found for CS.D.AUDUSD.MINI.IP 60m
2025-09-12 05:43:50,209 - WARNING - igstream.sync_manager - No candle data found for CS.D.USDCAD.MINI.IP 5m
2025-09-12 05:43:50,211 - WARNING - igstream.sync_manager - No candle data found for CS.D.USDCAD.MINI.IP 60m
2025-09-12 05:43:50,213 - WARNING - igstream.sync_manager - No candle data found for CS.D.EURJPY.MINI.IP 5m
2025-09-12 05:43:50,215 - WARNING - igstream.sync_manager - No candle data found for CS.D.EURJPY.MINI.IP 60m
2025-09-12 05:43:50,216 - WARNING - igstream.sync_manager - No candle data found for CS.D.AUDJPY.MINI.IP 5m
2025-09-12 05:43:50,218 - WARNING - igstream.sync_manager - No candle data found for CS.D.AUDJPY.MINI.IP 60m
2025-09-12 05:43:50,220 - WARNING - igstream.sync_manager - No candle data found for CS.D.NZDUSD.MINI.IP 5m
2025-09-12 05:43:50,221 - WARNING - igstream.sync_manager - No candle data found for CS.D.NZDUSD.MINI.IP 60m
2025-09-12 05:43:50,222 - WARNING - igstream.sync_manager - No candle data found for CS.D.USDCHF.MINI.IP 5m
2025-09-12 05:43:50,224 - WARNING - igstream.sync_manager - No candle data found for CS.D.USDCHF.MINI.IP 60m
2025-09-12 05:43:50,225 - WARNING - igstream.sync_manager - No candle data found for CS.D.EURUSD.CEEM.IP 5m
2025-09-12 05:43:50,226 - WARNING - igstream.sync_manager - No candle data found for CS.D.EURUSD.CEEM.IP 60m
2025-09-12 05:43:50,227 - WARNING - igstream.sync_manager - ⚠️ Stream CS.D.GBPUSD.MINI.IP needs restart (stale_data). Reconnecting...
2025-09-12 05:43:50,227 - INFO - igstream.chart_streamer - Chart streaming cancelled for CS.D.GBPUSD.MINI.IP
2025-09-12 05:43:50,227 - INFO - igstream.stream_validator - 🛑 Stopping stream validation service...
2025-09-12 05:43:50,227 - INFO - igstream.chart_streamer - 📊 Validation stats for CS.D.GBPUSD.MINI.IP: {'total_validations': 0, 'successful_validations': 0, 'discrepancies_found': 0, 'api_errors': 0, 'corrections_made': 0, 'queue_size': 0, 'success_rate_pct': 0.0, 'processing': False}
2025-09-12 05:43:50,227 - INFO - igstream.chart_streamer - 🔌 Disconnecting Lightstreamer for CS.D.GBPUSD.MINI.IP...
2025-09-12 05:43:50,228 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.GBPUSD.MINI.IP: DISCONNECTED
2025-09-12 05:43:50,228 - INFO - igstream.chart_streamer - ✅ Cleanup complete for CS.D.GBPUSD.MINI.IP
2025-09-12 05:43:50,229 - INFO - igstream.sync_manager - Stopped stream for CS.D.GBPUSD.MINI.IP
2025-09-12 05:43:51,038 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 98.253, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:51,040 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 98.253, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:51,043 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 0.666385, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:51,045 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 0.666385, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:51,047 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDCAD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 1.384185, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:51,049 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 1.384185, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:51,051 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.4385, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:51,052 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.4385, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:51,069 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 172.89749999999998, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:51,071 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 172.89749999999998, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:51,075 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.89749999999998, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:51,077 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.89749999999998, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:51,079 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.253, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:51,080 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.253, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:51,082 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.666385, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:51,083 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.666385, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:51,084 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDCAD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.384185, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:51,086 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.384185, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:51,087 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 147.4385, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:51,088 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 147.4385, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:52,230 - INFO - igstream.sync_manager - 🚀 Starting chart stream for CS.D.GBPUSD.MINI.IP
2025-09-12 05:43:52,230 - INFO - igstream.sync_manager - ✅ Stream CS.D.GBPUSD.MINI.IP restart triggered due to: stale_data
2025-09-12 05:43:52,230 - WARNING - igstream.sync_manager - ⚠️ Stream CS.D.USDJPY.MINI.IP needs restart (stale_data). Reconnecting...
2025-09-12 05:43:52,230 - INFO - igstream.chart_streamer - 🚀 Starting enhanced chart stream for CS.D.GBPUSD.MINI.IP
2025-09-12 05:43:52,231 - INFO - igstream.chart_streamer - 🔌 Connecting to Lightstreamer for CS.D.GBPUSD.MINI.IP...
2025-09-12 05:43:52,231 - INFO - igstream.chart_streamer - Chart streaming cancelled for CS.D.USDJPY.MINI.IP
2025-09-12 05:43:52,232 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.GBPUSD.MINI.IP: CONNECTING
2025-09-12 05:43:52,232 - INFO - igstream.stream_validator - 🛑 Stopping stream validation service...
2025-09-12 05:43:52,233 - INFO - igstream.chart_streamer - 📊 Validation stats for CS.D.USDJPY.MINI.IP: {'total_validations': 0, 'successful_validations': 0, 'discrepancies_found': 0, 'api_errors': 0, 'corrections_made': 0, 'queue_size': 0, 'success_rate_pct': 0.0, 'processing': False}
2025-09-12 05:43:52,233 - INFO - igstream.chart_streamer - 🔌 Disconnecting Lightstreamer for CS.D.USDJPY.MINI.IP...
2025-09-12 05:43:52,235 - INFO - igstream.chart_streamer - ✅ Cleanup complete for CS.D.USDJPY.MINI.IP
2025-09-12 05:43:52,235 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.USDJPY.MINI.IP: DISCONNECTED
2025-09-12 05:43:52,238 - INFO - igstream.sync_manager - Stopped stream for CS.D.USDJPY.MINI.IP
2025-09-12 05:43:52,465 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.GBPUSD.MINI.IP: CONNECTED:WS-STREAMING
2025-09-12 05:43:53,037 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.8985, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:53,039 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.8985, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:53,041 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 172.8985, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:53,042 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 172.8985, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:53,045 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDCAD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.384195, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:53,046 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.384195, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:53,068 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDCAD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 1.384195, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:53,069 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 1.384195, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:53,232 - INFO - igstream.chart_streamer - ✅ Connected to Lightstreamer for CS.D.GBPUSD.MINI.IP
2025-09-12 05:43:53,232 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.GBPUSD.MINI.IP:5MINUTE
2025-09-12 05:43:53,233 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.GBPUSD.MINI.IP:HOUR
2025-09-12 05:43:53,233 - INFO - igstream.chart_streamer - 📡 All subscriptions active for CS.D.GBPUSD.MINI.IP
2025-09-12 05:43:53,233 - INFO - igstream.chart_streamer - 🔍 Stream validation service started for CS.D.GBPUSD.MINI.IP
2025-09-12 05:43:53,234 - INFO - igstream.stream_validator - 🚀 Starting stream validation service...
2025-09-12 05:43:53,234 - INFO - igstream.stream_validator -    Validation delay: 300s
2025-09-12 05:43:53,234 - INFO - igstream.stream_validator -    Validation frequency: every 3 candles
2025-09-12 05:43:53,234 - INFO - igstream.stream_validator -    Rate limit: 80 requests/minute
2025-09-12 05:43:53,270 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 5m for CS.D.GBPUSD.MINI.IP
2025-09-12 05:43:53,271 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 60m for CS.D.GBPUSD.MINI.IP
2025-09-12 05:43:53,306 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.GBPUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 1.3557649999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:53,309 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 1.3557649999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:53,312 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.GBPUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.3557649999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:53,314 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.3557649999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:54,037 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDCHF.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.796475, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:54,038 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.796475, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:54,066 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDCHF.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 0.796475, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:54,067 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 0.796475, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:54,239 - INFO - igstream.sync_manager - 🚀 Starting chart stream for CS.D.USDJPY.MINI.IP
2025-09-12 05:43:54,239 - INFO - igstream.sync_manager - ✅ Stream CS.D.USDJPY.MINI.IP restart triggered due to: stale_data
2025-09-12 05:43:54,239 - WARNING - igstream.sync_manager - ⚠️ Stream CS.D.AUDUSD.MINI.IP needs restart (stale_data). Reconnecting...
2025-09-12 05:43:54,239 - INFO - igstream.chart_streamer - 🚀 Starting enhanced chart stream for CS.D.USDJPY.MINI.IP
2025-09-12 05:43:54,239 - INFO - igstream.chart_streamer - 🔌 Connecting to Lightstreamer for CS.D.USDJPY.MINI.IP...
2025-09-12 05:43:54,240 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.USDJPY.MINI.IP: CONNECTING
2025-09-12 05:43:54,240 - INFO - igstream.chart_streamer - Chart streaming cancelled for CS.D.AUDUSD.MINI.IP
2025-09-12 05:43:54,240 - INFO - igstream.stream_validator - 🛑 Stopping stream validation service...
2025-09-12 05:43:54,240 - INFO - igstream.chart_streamer - 📊 Validation stats for CS.D.AUDUSD.MINI.IP: {'total_validations': 0, 'successful_validations': 0, 'discrepancies_found': 0, 'api_errors': 0, 'corrections_made': 0, 'queue_size': 0, 'success_rate_pct': 0.0, 'processing': False}
2025-09-12 05:43:54,240 - INFO - igstream.chart_streamer - 🔌 Disconnecting Lightstreamer for CS.D.AUDUSD.MINI.IP...
2025-09-12 05:43:54,241 - INFO - igstream.chart_streamer - ✅ Cleanup complete for CS.D.AUDUSD.MINI.IP
2025-09-12 05:43:54,241 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.AUDUSD.MINI.IP: DISCONNECTED
2025-09-12 05:43:54,241 - INFO - igstream.sync_manager - Stopped stream for CS.D.AUDUSD.MINI.IP
2025-09-12 05:43:54,463 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.USDJPY.MINI.IP: CONNECTED:WS-STREAMING
2025-09-12 05:43:55,240 - INFO - igstream.chart_streamer - ✅ Connected to Lightstreamer for CS.D.USDJPY.MINI.IP
2025-09-12 05:43:55,241 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.USDJPY.MINI.IP:5MINUTE
2025-09-12 05:43:55,241 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.USDJPY.MINI.IP:HOUR
2025-09-12 05:43:55,242 - INFO - igstream.chart_streamer - 📡 All subscriptions active for CS.D.USDJPY.MINI.IP
2025-09-12 05:43:55,242 - INFO - igstream.chart_streamer - 🔍 Stream validation service started for CS.D.USDJPY.MINI.IP
2025-09-12 05:43:55,242 - INFO - igstream.stream_validator - 🚀 Starting stream validation service...
2025-09-12 05:43:55,242 - INFO - igstream.stream_validator -    Validation delay: 300s
2025-09-12 05:43:55,242 - INFO - igstream.stream_validator -    Validation frequency: every 3 candles
2025-09-12 05:43:55,243 - INFO - igstream.stream_validator -    Rate limit: 80 requests/minute
2025-09-12 05:43:55,277 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 5m for CS.D.USDJPY.MINI.IP
2025-09-12 05:43:55,307 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 60m for CS.D.USDJPY.MINI.IP
2025-09-12 05:43:55,308 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 147.437, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:55,309 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 147.437, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:55,310 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.437, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:55,310 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.437, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:56,039 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.89749999999998, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:56,041 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.89749999999998, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:56,044 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.GBPUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.355745, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:56,046 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.355745, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:56,048 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDCAD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 1.384205, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:56,049 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 1.384205, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:56,051 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURUSD.CEEM.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 1.1725900000000002, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:56,052 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 1.1725900000000002, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:56,069 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 172.89749999999998, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:56,070 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 172.89749999999998, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:56,074 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.GBPUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 1.355745, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:56,075 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 1.355745, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:56,078 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDCAD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.384205, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:56,079 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.384205, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:56,081 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURUSD.CEEM.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.1725900000000002, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:56,082 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.1725900000000002, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:56,242 - INFO - igstream.sync_manager - 🚀 Starting chart stream for CS.D.AUDUSD.MINI.IP
2025-09-12 05:43:56,243 - INFO - igstream.sync_manager - ✅ Stream CS.D.AUDUSD.MINI.IP restart triggered due to: stale_data
2025-09-12 05:43:56,243 - WARNING - igstream.sync_manager - ⚠️ Stream CS.D.USDCAD.MINI.IP needs restart (stale_data). Reconnecting...
2025-09-12 05:43:56,243 - INFO - igstream.chart_streamer - 🚀 Starting enhanced chart stream for CS.D.AUDUSD.MINI.IP
2025-09-12 05:43:56,243 - INFO - igstream.chart_streamer - 🔌 Connecting to Lightstreamer for CS.D.AUDUSD.MINI.IP...
2025-09-12 05:43:56,244 - INFO - igstream.chart_streamer - Chart streaming cancelled for CS.D.USDCAD.MINI.IP
2025-09-12 05:43:56,244 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.AUDUSD.MINI.IP: CONNECTING
2025-09-12 05:43:56,245 - INFO - igstream.stream_validator - 🛑 Stopping stream validation service...
2025-09-12 05:43:56,245 - INFO - igstream.chart_streamer - 📊 Validation stats for CS.D.USDCAD.MINI.IP: {'total_validations': 0, 'successful_validations': 0, 'discrepancies_found': 0, 'api_errors': 0, 'corrections_made': 0, 'queue_size': 0, 'success_rate_pct': 0.0, 'processing': False}
2025-09-12 05:43:56,245 - INFO - igstream.chart_streamer - 🔌 Disconnecting Lightstreamer for CS.D.USDCAD.MINI.IP...
2025-09-12 05:43:56,245 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.USDCAD.MINI.IP: DISCONNECTED
2025-09-12 05:43:56,246 - INFO - igstream.chart_streamer - ✅ Cleanup complete for CS.D.USDCAD.MINI.IP
2025-09-12 05:43:56,246 - INFO - igstream.sync_manager - Stopped stream for CS.D.USDCAD.MINI.IP
2025-09-12 05:43:56,505 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.AUDUSD.MINI.IP: CONNECTED:WS-STREAMING
2025-09-12 05:43:57,244 - INFO - igstream.chart_streamer - ✅ Connected to Lightstreamer for CS.D.AUDUSD.MINI.IP
2025-09-12 05:43:57,244 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.AUDUSD.MINI.IP:5MINUTE
2025-09-12 05:43:57,245 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.AUDUSD.MINI.IP:HOUR
2025-09-12 05:43:57,245 - INFO - igstream.chart_streamer - 📡 All subscriptions active for CS.D.AUDUSD.MINI.IP
2025-09-12 05:43:57,245 - INFO - igstream.chart_streamer - 🔍 Stream validation service started for CS.D.AUDUSD.MINI.IP
2025-09-12 05:43:57,246 - INFO - igstream.stream_validator - 🚀 Starting stream validation service...
2025-09-12 05:43:57,246 - INFO - igstream.stream_validator -    Validation delay: 300s
2025-09-12 05:43:57,246 - INFO - igstream.stream_validator -    Validation frequency: every 3 candles
2025-09-12 05:43:57,246 - INFO - igstream.stream_validator -    Rate limit: 80 requests/minute
2025-09-12 05:43:57,281 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 5m for CS.D.AUDUSD.MINI.IP
2025-09-12 05:43:57,311 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 60m for CS.D.AUDUSD.MINI.IP
2025-09-12 05:43:57,314 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 0.666385, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:57,314 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 0.666385, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:57,315 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.666385, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:57,315 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.666385, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:58,045 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 172.9035, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:58,046 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 172.9035, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:58,048 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.9035, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:58,049 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.9035, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:58,060 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.442, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:58,062 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.442, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:58,063 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 147.442, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:58,065 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 147.442, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:58,247 - INFO - igstream.sync_manager - 🚀 Starting chart stream for CS.D.USDCAD.MINI.IP
2025-09-12 05:43:58,248 - INFO - igstream.sync_manager - ✅ Stream CS.D.USDCAD.MINI.IP restart triggered due to: stale_data
2025-09-12 05:43:58,248 - WARNING - igstream.sync_manager - ⚠️ Stream CS.D.EURJPY.MINI.IP needs restart (stale_data). Reconnecting...
2025-09-12 05:43:58,249 - INFO - igstream.chart_streamer - 🚀 Starting enhanced chart stream for CS.D.USDCAD.MINI.IP
2025-09-12 05:43:58,249 - INFO - igstream.chart_streamer - 🔌 Connecting to Lightstreamer for CS.D.USDCAD.MINI.IP...
2025-09-12 05:43:58,250 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.USDCAD.MINI.IP: CONNECTING
2025-09-12 05:43:58,251 - INFO - igstream.chart_streamer - Chart streaming cancelled for CS.D.EURJPY.MINI.IP
2025-09-12 05:43:58,252 - INFO - igstream.stream_validator - 🛑 Stopping stream validation service...
2025-09-12 05:43:58,252 - INFO - igstream.chart_streamer - 📊 Validation stats for CS.D.EURJPY.MINI.IP: {'total_validations': 0, 'successful_validations': 0, 'discrepancies_found': 0, 'api_errors': 0, 'corrections_made': 0, 'queue_size': 0, 'success_rate_pct': 0.0, 'processing': False}
2025-09-12 05:43:58,252 - INFO - igstream.chart_streamer - 🔌 Disconnecting Lightstreamer for CS.D.EURJPY.MINI.IP...
2025-09-12 05:43:58,253 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.EURJPY.MINI.IP: DISCONNECTED
2025-09-12 05:43:58,255 - INFO - igstream.chart_streamer - ✅ Cleanup complete for CS.D.EURJPY.MINI.IP
2025-09-12 05:43:58,255 - INFO - igstream.sync_manager - Stopped stream for CS.D.EURJPY.MINI.IP
2025-09-12 05:43:58,534 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.USDCAD.MINI.IP: CONNECTED:WS-STREAMING
2025-09-12 05:43:59,035 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.256, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:59,037 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.256, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:59,038 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 98.256, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:59,040 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 98.256, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:59,252 - INFO - igstream.chart_streamer - ✅ Connected to Lightstreamer for CS.D.USDCAD.MINI.IP
2025-09-12 05:43:59,252 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.USDCAD.MINI.IP:5MINUTE
2025-09-12 05:43:59,253 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.USDCAD.MINI.IP:HOUR
2025-09-12 05:43:59,254 - INFO - igstream.chart_streamer - 📡 All subscriptions active for CS.D.USDCAD.MINI.IP
2025-09-12 05:43:59,255 - INFO - igstream.chart_streamer - 🔍 Stream validation service started for CS.D.USDCAD.MINI.IP
2025-09-12 05:43:59,255 - INFO - igstream.stream_validator - 🚀 Starting stream validation service...
2025-09-12 05:43:59,255 - INFO - igstream.stream_validator -    Validation delay: 300s
2025-09-12 05:43:59,255 - INFO - igstream.stream_validator -    Validation frequency: every 3 candles
2025-09-12 05:43:59,255 - INFO - igstream.stream_validator -    Rate limit: 80 requests/minute
2025-09-12 05:43:59,295 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 5m for CS.D.USDCAD.MINI.IP
2025-09-12 05:43:59,325 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 60m for CS.D.USDCAD.MINI.IP
2025-09-12 05:43:59,328 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDCAD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 1.384205, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:59,329 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 1.384205, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:43:59,331 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDCAD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.384205, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:43:59,332 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.384205, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:00,035 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 98.255, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:00,036 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 98.255, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:00,037 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.255, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:00,038 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.255, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:00,039 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 0.6663600000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:00,040 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 0.6663600000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:00,041 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.6663600000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:00,042 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.6663600000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:00,043 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.GBPUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 1.3557350000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:00,044 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 1.3557350000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:00,045 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDCAD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.384205, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:00,046 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.384205, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:00,047 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.NZDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 0.5972500000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:00,048 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 0.5972500000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:00,049 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.NZDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.5972500000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:00,049 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.5972500000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:00,050 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDCHF.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.796495, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:00,051 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.796495, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:00,051 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.44299999999998, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:00,052 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.44299999999998, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:00,052 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 147.44299999999998, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:00,053 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 147.44299999999998, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:00,058 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURUSD.CEEM.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 1.1725700000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:00,058 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 1.1725700000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:00,059 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURUSD.CEEM.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.1725700000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:00,060 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.1725700000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:00,074 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.GBPUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.3557350000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:00,074 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.3557350000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:00,075 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDCAD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 1.384205, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:00,076 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 1.384205, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:00,077 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDCHF.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 0.796495, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:00,077 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 0.796495, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:00,256 - INFO - igstream.sync_manager - 🚀 Starting chart stream for CS.D.EURJPY.MINI.IP
2025-09-12 05:44:00,257 - INFO - igstream.sync_manager - ✅ Stream CS.D.EURJPY.MINI.IP restart triggered due to: stale_data
2025-09-12 05:44:00,257 - WARNING - igstream.sync_manager - ⚠️ Stream CS.D.AUDJPY.MINI.IP needs restart (stale_data). Reconnecting...
2025-09-12 05:44:00,257 - INFO - igstream.chart_streamer - 🚀 Starting enhanced chart stream for CS.D.EURJPY.MINI.IP
2025-09-12 05:44:00,258 - INFO - igstream.chart_streamer - 🔌 Connecting to Lightstreamer for CS.D.EURJPY.MINI.IP...
2025-09-12 05:44:00,260 - INFO - igstream.chart_streamer - Chart streaming cancelled for CS.D.AUDJPY.MINI.IP
2025-09-12 05:44:00,261 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.EURJPY.MINI.IP: CONNECTING
2025-09-12 05:44:00,261 - INFO - igstream.stream_validator - 🛑 Stopping stream validation service...
2025-09-12 05:44:00,262 - INFO - igstream.chart_streamer - 📊 Validation stats for CS.D.AUDJPY.MINI.IP: {'total_validations': 0, 'successful_validations': 0, 'discrepancies_found': 0, 'api_errors': 0, 'corrections_made': 0, 'queue_size': 0, 'success_rate_pct': 0.0, 'processing': False}
2025-09-12 05:44:00,262 - INFO - igstream.chart_streamer - 🔌 Disconnecting Lightstreamer for CS.D.AUDJPY.MINI.IP...
2025-09-12 05:44:00,263 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.AUDJPY.MINI.IP: DISCONNECTED
2025-09-12 05:44:00,264 - INFO - igstream.chart_streamer - ✅ Cleanup complete for CS.D.AUDJPY.MINI.IP
2025-09-12 05:44:00,264 - INFO - igstream.sync_manager - Stopped stream for CS.D.AUDJPY.MINI.IP
2025-09-12 05:44:00,518 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.EURJPY.MINI.IP: CONNECTED:WS-STREAMING
2025-09-12 05:44:01,044 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.66635, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:01,046 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.66635, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:01,051 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.GBPUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.355705, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:01,052 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.355705, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:01,053 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDCAD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.384255, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:01,054 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.384255, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:01,055 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDCHF.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.796495, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:01,056 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.796495, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:01,056 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 147.445, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:01,057 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 147.445, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:01,057 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.445, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:01,058 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.445, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:01,061 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURUSD.CEEM.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 1.1725299999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:01,061 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 1.1725299999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:01,076 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 0.66635, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:01,077 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 0.66635, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:01,082 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.GBPUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 1.355705, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:01,083 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 1.355705, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:01,084 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDCAD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 1.384255, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:01,085 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 1.384255, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:01,087 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDCHF.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 0.796495, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:01,088 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 0.796495, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:01,091 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURUSD.CEEM.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.1725299999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:01,092 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.1725299999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:01,261 - INFO - igstream.chart_streamer - ✅ Connected to Lightstreamer for CS.D.EURJPY.MINI.IP
2025-09-12 05:44:01,262 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.EURJPY.MINI.IP:5MINUTE
2025-09-12 05:44:01,262 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.EURJPY.MINI.IP:HOUR
2025-09-12 05:44:01,263 - INFO - igstream.chart_streamer - 📡 All subscriptions active for CS.D.EURJPY.MINI.IP
2025-09-12 05:44:01,263 - INFO - igstream.chart_streamer - 🔍 Stream validation service started for CS.D.EURJPY.MINI.IP
2025-09-12 05:44:01,264 - INFO - igstream.stream_validator - 🚀 Starting stream validation service...
2025-09-12 05:44:01,265 - INFO - igstream.stream_validator -    Validation delay: 300s
2025-09-12 05:44:01,265 - INFO - igstream.stream_validator -    Validation frequency: every 3 candles
2025-09-12 05:44:01,265 - INFO - igstream.stream_validator -    Rate limit: 80 requests/minute
2025-09-12 05:44:01,297 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 5m for CS.D.EURJPY.MINI.IP
2025-09-12 05:44:01,328 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 60m for CS.D.EURJPY.MINI.IP
2025-09-12 05:44:01,330 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 172.89749999999998, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:01,331 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 172.89749999999998, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:01,332 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.89749999999998, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:01,333 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.89749999999998, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:02,042 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 172.8985, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:02,043 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 172.8985, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:02,045 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.8985, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:02,045 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.8985, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:02,048 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURUSD.CEEM.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 1.1725299999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:02,049 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 1.1725299999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:02,083 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURUSD.CEEM.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.1725299999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:02,084 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.1725299999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:02,265 - INFO - igstream.sync_manager - 🚀 Starting chart stream for CS.D.AUDJPY.MINI.IP
2025-09-12 05:44:02,266 - INFO - igstream.sync_manager - ✅ Stream CS.D.AUDJPY.MINI.IP restart triggered due to: stale_data
2025-09-12 05:44:02,266 - WARNING - igstream.sync_manager - ⚠️ Stream CS.D.NZDUSD.MINI.IP needs restart (stale_data). Reconnecting...
2025-09-12 05:44:02,266 - INFO - igstream.chart_streamer - 🚀 Starting enhanced chart stream for CS.D.AUDJPY.MINI.IP
2025-09-12 05:44:02,266 - INFO - igstream.chart_streamer - 🔌 Connecting to Lightstreamer for CS.D.AUDJPY.MINI.IP...
2025-09-12 05:44:02,266 - INFO - igstream.chart_streamer - Chart streaming cancelled for CS.D.NZDUSD.MINI.IP
2025-09-12 05:44:02,268 - INFO - igstream.stream_validator - 🛑 Stopping stream validation service...
2025-09-12 05:44:02,268 - INFO - igstream.chart_streamer - 📊 Validation stats for CS.D.NZDUSD.MINI.IP: {'total_validations': 0, 'successful_validations': 0, 'discrepancies_found': 0, 'api_errors': 0, 'corrections_made': 0, 'queue_size': 0, 'success_rate_pct': 0.0, 'processing': False}
2025-09-12 05:44:02,268 - INFO - igstream.chart_streamer - 🔌 Disconnecting Lightstreamer for CS.D.NZDUSD.MINI.IP...
2025-09-12 05:44:02,267 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.AUDJPY.MINI.IP: CONNECTING
2025-09-12 05:44:02,269 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.NZDUSD.MINI.IP: DISCONNECTED
2025-09-12 05:44:02,269 - INFO - igstream.chart_streamer - ✅ Cleanup complete for CS.D.NZDUSD.MINI.IP
2025-09-12 05:44:02,270 - INFO - igstream.sync_manager - Stopped stream for CS.D.NZDUSD.MINI.IP
2025-09-12 05:44:02,499 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.AUDJPY.MINI.IP: CONNECTED:WS-STREAMING
2025-09-12 05:44:03,267 - INFO - igstream.chart_streamer - ✅ Connected to Lightstreamer for CS.D.AUDJPY.MINI.IP
2025-09-12 05:44:03,268 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.AUDJPY.MINI.IP:5MINUTE
2025-09-12 05:44:03,269 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.AUDJPY.MINI.IP:HOUR
2025-09-12 05:44:03,270 - INFO - igstream.chart_streamer - 📡 All subscriptions active for CS.D.AUDJPY.MINI.IP
2025-09-12 05:44:03,271 - INFO - igstream.chart_streamer - 🔍 Stream validation service started for CS.D.AUDJPY.MINI.IP
2025-09-12 05:44:03,271 - INFO - igstream.stream_validator - 🚀 Starting stream validation service...
2025-09-12 05:44:03,272 - INFO - igstream.stream_validator -    Validation delay: 300s
2025-09-12 05:44:03,272 - INFO - igstream.stream_validator -    Validation frequency: every 3 candles
2025-09-12 05:44:03,272 - INFO - igstream.stream_validator -    Rate limit: 80 requests/minute
2025-09-12 05:44:03,307 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 5m for CS.D.AUDJPY.MINI.IP
2025-09-12 05:44:03,338 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 60m for CS.D.AUDJPY.MINI.IP
2025-09-12 05:44:03,344 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 98.255, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:03,345 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 98.255, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:03,348 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.255, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:03,349 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.255, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:04,037 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 172.89749999999998, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:04,038 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 172.89749999999998, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:04,066 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.89749999999998, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:04,067 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.89749999999998, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:04,271 - INFO - igstream.sync_manager - 🚀 Starting chart stream for CS.D.NZDUSD.MINI.IP
2025-09-12 05:44:04,271 - INFO - igstream.sync_manager - ✅ Stream CS.D.NZDUSD.MINI.IP restart triggered due to: stale_data
2025-09-12 05:44:04,271 - WARNING - igstream.sync_manager - ⚠️ Stream CS.D.USDCHF.MINI.IP needs restart (stale_data). Reconnecting...
2025-09-12 05:44:04,271 - INFO - igstream.chart_streamer - 🚀 Starting enhanced chart stream for CS.D.NZDUSD.MINI.IP
2025-09-12 05:44:04,271 - INFO - igstream.chart_streamer - 🔌 Connecting to Lightstreamer for CS.D.NZDUSD.MINI.IP...
2025-09-12 05:44:04,272 - INFO - igstream.chart_streamer - Chart streaming cancelled for CS.D.USDCHF.MINI.IP
2025-09-12 05:44:04,272 - INFO - igstream.stream_validator - 🛑 Stopping stream validation service...
2025-09-12 05:44:04,272 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.NZDUSD.MINI.IP: CONNECTING
2025-09-12 05:44:04,272 - INFO - igstream.chart_streamer - 📊 Validation stats for CS.D.USDCHF.MINI.IP: {'total_validations': 0, 'successful_validations': 0, 'discrepancies_found': 0, 'api_errors': 0, 'corrections_made': 0, 'queue_size': 0, 'success_rate_pct': 0.0, 'processing': False}
2025-09-12 05:44:04,272 - INFO - igstream.chart_streamer - 🔌 Disconnecting Lightstreamer for CS.D.USDCHF.MINI.IP...
2025-09-12 05:44:04,273 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.USDCHF.MINI.IP: DISCONNECTED
2025-09-12 05:44:04,273 - INFO - igstream.chart_streamer - ✅ Cleanup complete for CS.D.USDCHF.MINI.IP
2025-09-12 05:44:04,273 - INFO - igstream.sync_manager - Stopped stream for CS.D.USDCHF.MINI.IP
2025-09-12 05:44:04,503 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.NZDUSD.MINI.IP: CONNECTED:WS-STREAMING
2025-09-12 05:44:05,037 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 98.25200000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:05,038 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 98.25200000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:05,040 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.25200000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:05,041 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.25200000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:05,042 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.66633, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:05,044 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.66633, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:05,045 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.GBPUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 1.3556650000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:05,047 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 1.3556650000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:05,048 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.GBPUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.3556650000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:05,049 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.3556650000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:05,056 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURUSD.CEEM.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 1.17252, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:05,057 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 1.17252, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:05,059 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURUSD.CEEM.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.17252, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:05,060 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.17252, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:05,070 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 0.66633, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:05,071 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 0.66633, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:05,273 - INFO - igstream.chart_streamer - ✅ Connected to Lightstreamer for CS.D.NZDUSD.MINI.IP
2025-09-12 05:44:05,273 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.NZDUSD.MINI.IP:5MINUTE
2025-09-12 05:44:05,273 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.NZDUSD.MINI.IP:HOUR
2025-09-12 05:44:05,274 - INFO - igstream.chart_streamer - 📡 All subscriptions active for CS.D.NZDUSD.MINI.IP
2025-09-12 05:44:05,274 - INFO - igstream.chart_streamer - 🔍 Stream validation service started for CS.D.NZDUSD.MINI.IP
2025-09-12 05:44:05,274 - INFO - igstream.stream_validator - 🚀 Starting stream validation service...
2025-09-12 05:44:05,274 - INFO - igstream.stream_validator -    Validation delay: 300s
2025-09-12 05:44:05,274 - INFO - igstream.stream_validator -    Validation frequency: every 3 candles
2025-09-12 05:44:05,274 - INFO - igstream.stream_validator -    Rate limit: 80 requests/minute
2025-09-12 05:44:05,310 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 5m for CS.D.NZDUSD.MINI.IP
2025-09-12 05:44:05,343 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 60m for CS.D.NZDUSD.MINI.IP
2025-09-12 05:44:05,345 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.NZDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 0.59723, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:05,346 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 0.59723, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:05,347 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.NZDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.59723, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:05,349 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.59723, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:06,274 - INFO - igstream.sync_manager - 🚀 Starting chart stream for CS.D.USDCHF.MINI.IP
2025-09-12 05:44:06,274 - INFO - igstream.sync_manager - ✅ Stream CS.D.USDCHF.MINI.IP restart triggered due to: stale_data
2025-09-12 05:44:06,274 - WARNING - igstream.sync_manager - ⚠️ Stream CS.D.EURUSD.CEEM.IP needs restart (stale_data). Reconnecting...
2025-09-12 05:44:06,274 - INFO - igstream.chart_streamer - 🚀 Starting enhanced chart stream for CS.D.USDCHF.MINI.IP
2025-09-12 05:44:06,275 - INFO - igstream.chart_streamer - 🔌 Connecting to Lightstreamer for CS.D.USDCHF.MINI.IP...
2025-09-12 05:44:06,275 - INFO - igstream.chart_streamer - Chart streaming cancelled for CS.D.EURUSD.CEEM.IP
2025-09-12 05:44:06,276 - INFO - igstream.stream_validator - 🛑 Stopping stream validation service...
2025-09-12 05:44:06,276 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.USDCHF.MINI.IP: CONNECTING
2025-09-12 05:44:06,277 - INFO - igstream.chart_streamer - 📊 Validation stats for CS.D.EURUSD.CEEM.IP: {'total_validations': 0, 'successful_validations': 0, 'discrepancies_found': 0, 'api_errors': 0, 'corrections_made': 0, 'queue_size': 0, 'success_rate_pct': 0.0, 'processing': False}
2025-09-12 05:44:06,277 - INFO - igstream.chart_streamer - 🔌 Disconnecting Lightstreamer for CS.D.EURUSD.CEEM.IP...
2025-09-12 05:44:06,278 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.EURUSD.CEEM.IP: DISCONNECTED
2025-09-12 05:44:06,278 - INFO - igstream.chart_streamer - ✅ Cleanup complete for CS.D.EURUSD.CEEM.IP
2025-09-12 05:44:06,279 - INFO - igstream.sync_manager - Stopped stream for CS.D.EURUSD.CEEM.IP
2025-09-12 05:44:06,581 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.USDCHF.MINI.IP: CONNECTED:WS-STREAMING
2025-09-12 05:44:07,277 - INFO - igstream.chart_streamer - ✅ Connected to Lightstreamer for CS.D.USDCHF.MINI.IP
2025-09-12 05:44:07,277 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.USDCHF.MINI.IP:5MINUTE
2025-09-12 05:44:07,278 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.USDCHF.MINI.IP:HOUR
2025-09-12 05:44:07,279 - INFO - igstream.chart_streamer - 📡 All subscriptions active for CS.D.USDCHF.MINI.IP
2025-09-12 05:44:07,279 - INFO - igstream.chart_streamer - 🔍 Stream validation service started for CS.D.USDCHF.MINI.IP
2025-09-12 05:44:07,280 - INFO - igstream.stream_validator - 🚀 Starting stream validation service...
2025-09-12 05:44:07,280 - INFO - igstream.stream_validator -    Validation delay: 300s
2025-09-12 05:44:07,280 - INFO - igstream.stream_validator -    Validation frequency: every 3 candles
2025-09-12 05:44:07,280 - INFO - igstream.stream_validator -    Rate limit: 80 requests/minute
2025-09-12 05:44:07,320 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 60m for CS.D.USDCHF.MINI.IP
2025-09-12 05:44:07,320 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 5m for CS.D.USDCHF.MINI.IP
2025-09-12 05:44:07,357 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDCHF.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 0.796495, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:07,359 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 0.796495, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:07,361 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDCHF.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.796495, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:07,362 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.796495, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:08,279 - INFO - igstream.sync_manager - 🚀 Starting chart stream for CS.D.EURUSD.CEEM.IP
2025-09-12 05:44:08,279 - INFO - igstream.sync_manager - ✅ Stream CS.D.EURUSD.CEEM.IP restart triggered due to: stale_data
2025-09-12 05:44:08,280 - INFO - igstream.chart_streamer - 🚀 Starting enhanced chart stream for CS.D.EURUSD.CEEM.IP
2025-09-12 05:44:08,280 - INFO - igstream.chart_streamer - 🔌 Connecting to Lightstreamer for CS.D.EURUSD.CEEM.IP...
2025-09-12 05:44:08,280 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.EURUSD.CEEM.IP: CONNECTING
2025-09-12 05:44:08,556 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.EURUSD.CEEM.IP: CONNECTED:WS-STREAMING
2025-09-12 05:44:09,281 - INFO - igstream.chart_streamer - ✅ Connected to Lightstreamer for CS.D.EURUSD.CEEM.IP
2025-09-12 05:44:09,281 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.EURUSD.CEEM.IP:5MINUTE
2025-09-12 05:44:09,282 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.EURUSD.CEEM.IP:HOUR
2025-09-12 05:44:09,282 - INFO - igstream.chart_streamer - 📡 All subscriptions active for CS.D.EURUSD.CEEM.IP
2025-09-12 05:44:09,283 - INFO - igstream.chart_streamer - 🔍 Stream validation service started for CS.D.EURUSD.CEEM.IP
2025-09-12 05:44:09,283 - INFO - igstream.stream_validator - 🚀 Starting stream validation service...
2025-09-12 05:44:09,283 - INFO - igstream.stream_validator -    Validation delay: 300s
2025-09-12 05:44:09,283 - INFO - igstream.stream_validator -    Validation frequency: every 3 candles
2025-09-12 05:44:09,283 - INFO - igstream.stream_validator -    Rate limit: 80 requests/minute
2025-09-12 05:44:09,320 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 5m for CS.D.EURUSD.CEEM.IP
2025-09-12 05:44:09,320 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 60m for CS.D.EURUSD.CEEM.IP
2025-09-12 05:44:09,354 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURUSD.CEEM.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.17252, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:09,356 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.17252, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:09,359 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURUSD.CEEM.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 1.17252, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:09,360 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 1.17252, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:10,034 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 172.8965, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:10,034 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 172.8965, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:10,035 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.8965, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:10,036 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.8965, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:13,037 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.6663399999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:13,037 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.6663399999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:13,039 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 0.6663399999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:13,040 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 0.6663399999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:16,037 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 147.446, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:16,037 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 147.446, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:16,039 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.446, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:16,039 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.446, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:19,040 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.GBPUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.355675, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:19,041 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.355675, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:19,070 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.GBPUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 1.355675, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:19,071 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 1.355675, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:20,038 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.GBPUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 1.3556650000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:20,039 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 1.3556650000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:20,041 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.GBPUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.3556650000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:20,041 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.3556650000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:20,043 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.447, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:20,044 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.447, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:20,045 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 147.447, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:20,046 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 147.447, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:31,039 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 98.2525, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:31,041 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 98.2525, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:31,043 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 172.8985, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:31,045 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 172.8985, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:31,046 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.8985, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:31,048 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.8985, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:31,049 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.GBPUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 1.355675, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:31,051 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 1.355675, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:31,053 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 147.448, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:31,054 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 147.448, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:31,065 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.2525, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:31,068 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.2525, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:31,070 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.GBPUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.355675, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:31,072 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.355675, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:31,073 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.448, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:31,074 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.448, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:32,043 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDCHF.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 0.79646, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:32,045 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 0.79646, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:32,047 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDCHF.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.79646, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:32,048 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.79646, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:35,037 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDCAD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.3842349999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:35,038 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.3842349999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:35,067 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDCAD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 1.3842349999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:35,068 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 1.3842349999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:37,035 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 172.8985, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:37,036 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 172.8985, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:37,037 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.GBPUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 1.3556650000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:37,038 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 1.3556650000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:37,064 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.8985, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:37,065 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.8985, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:37,067 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.GBPUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.3556650000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:37,068 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.3556650000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:41,036 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.89749999999998, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:41,038 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.89749999999998, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:41,039 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 147.447, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:41,040 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 147.447, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:41,068 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 172.89749999999998, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:41,070 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 172.89749999999998, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:41,072 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.447, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:41,073 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.447, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:42,038 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.449, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:42,040 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.449, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:42,066 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 147.449, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:42,068 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 147.449, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:44,034 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 0.66633, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:44,034 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 0.66633, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:44,035 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.66633, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:44,036 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.66633, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:46,039 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.45, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:46,040 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.45, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:46,071 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 147.45, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:46,072 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 147.45, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:48,036 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 147.448, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:48,037 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 147.448, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:48,039 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.448, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:48,040 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.448, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:49,033 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.2555, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:49,035 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.2555, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:49,039 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 98.2555, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:49,041 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 98.2555, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:49,043 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 0.66635, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:49,045 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 0.66635, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:49,046 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.GBPUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 1.355685, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:49,048 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 1.355685, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:49,050 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDCAD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.384245, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:49,051 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.384245, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:49,053 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDCAD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 1.384245, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:49,054 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 1.384245, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:49,056 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.NZDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 0.59724, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:49,057 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 0.59724, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:49,067 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.66635, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:49,068 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.66635, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:49,070 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.GBPUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.355685, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:49,071 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.355685, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:49,073 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.NZDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.59724, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:49,074 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.59724, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:50,043 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDCAD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.384245, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:50,044 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.384245, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:50,045 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDCAD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 1.384245, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:50,046 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 1.384245, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:50,047 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.NZDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 0.5972500000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:50,048 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 0.5972500000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:50,074 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.NZDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.5972500000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:50,076 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.5972500000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:56,031 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.66632, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:56,033 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.66632, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:56,034 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 0.66632, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:56,035 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 0.66632, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:58,066 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 147.447, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:58,067 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 147.447, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:58,068 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.447, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:58,069 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.447, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:59,040 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 147.449, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:59,041 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 147.449, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:44:59,043 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.449, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:44:59,044 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.449, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:00,042 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURUSD.CEEM.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 1.1725299999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:00,043 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 40), 'close': 1.1725299999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:00,072 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURUSD.CEEM.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.1725299999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:00,073 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.1725299999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:01,035 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.8965, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:01,037 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.8965, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:01,038 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.NZDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.59726, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:01,039 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.59726, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:01,066 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.8965, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:01,067 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.8965, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:01,069 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.NZDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.59726, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:01,070 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.59726, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:02,037 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.6663399999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:02,039 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.6663399999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:02,041 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.6663399999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:02,042 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.6663399999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:02,044 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.89749999999998, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:02,045 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.89749999999998, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:02,046 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.NZDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.5972500000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:02,046 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.5972500000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:02,067 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.89749999999998, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:02,068 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.89749999999998, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:02,069 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.NZDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.5972500000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:02,070 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.5972500000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:03,037 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.451, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:03,038 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.451, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:03,068 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.451, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:03,069 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.451, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:04,038 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.8965, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:04,040 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.8965, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:04,069 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.8965, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:04,071 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.8965, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:05,041 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.452, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:05,042 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.452, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:05,070 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.452, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:05,072 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.452, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:06,042 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.2535, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:06,045 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.2535, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:06,051 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.66633, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:06,053 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.66633, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:06,055 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.GBPUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.355655, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:06,057 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.355655, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:06,059 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.NZDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.59726, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:06,061 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.59726, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:06,064 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURUSD.CEEM.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.17252, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:06,065 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.17252, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:06,067 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURUSD.CEEM.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.17252, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:06,068 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.17252, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:06,069 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 98.2535, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:06,070 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 98.2535, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:06,071 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.66633, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:06,071 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.66633, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:06,074 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.GBPUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.355655, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:06,075 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.355655, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:06,077 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.NZDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.59726, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:06,077 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.59726, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:07,033 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 98.25450000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:07,034 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 98.25450000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:07,038 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.NZDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.5972500000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:07,039 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.5972500000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:07,040 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.NZDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.5972500000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:07,042 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.5972500000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:07,066 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.25450000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:07,067 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.25450000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:08,285 - INFO - igstream.sync_manager - 📊 Database stats: 0 candles in last 30min, latest: None
2025-09-12 05:45:08,287 - WARNING - igstream.sync_manager - No candle data found for CS.D.GBPUSD.MINI.IP 5m
2025-09-12 05:45:08,289 - WARNING - igstream.sync_manager - No candle data found for CS.D.GBPUSD.MINI.IP 60m
2025-09-12 05:45:08,291 - WARNING - igstream.sync_manager - No candle data found for CS.D.USDJPY.MINI.IP 5m
2025-09-12 05:45:08,293 - WARNING - igstream.sync_manager - No candle data found for CS.D.USDJPY.MINI.IP 60m
2025-09-12 05:45:08,295 - WARNING - igstream.sync_manager - No candle data found for CS.D.AUDUSD.MINI.IP 5m
2025-09-12 05:45:08,297 - WARNING - igstream.sync_manager - No candle data found for CS.D.AUDUSD.MINI.IP 60m
2025-09-12 05:45:08,299 - WARNING - igstream.sync_manager - No candle data found for CS.D.USDCAD.MINI.IP 5m
2025-09-12 05:45:08,301 - WARNING - igstream.sync_manager - No candle data found for CS.D.USDCAD.MINI.IP 60m
2025-09-12 05:45:08,303 - WARNING - igstream.sync_manager - No candle data found for CS.D.EURJPY.MINI.IP 5m
2025-09-12 05:45:08,305 - WARNING - igstream.sync_manager - No candle data found for CS.D.EURJPY.MINI.IP 60m
2025-09-12 05:45:08,307 - WARNING - igstream.sync_manager - No candle data found for CS.D.AUDJPY.MINI.IP 5m
2025-09-12 05:45:08,308 - WARNING - igstream.sync_manager - No candle data found for CS.D.AUDJPY.MINI.IP 60m
2025-09-12 05:45:08,309 - WARNING - igstream.sync_manager - No candle data found for CS.D.NZDUSD.MINI.IP 5m
2025-09-12 05:45:08,310 - WARNING - igstream.sync_manager - No candle data found for CS.D.NZDUSD.MINI.IP 60m
2025-09-12 05:45:08,311 - WARNING - igstream.sync_manager - No candle data found for CS.D.USDCHF.MINI.IP 5m
2025-09-12 05:45:08,313 - WARNING - igstream.sync_manager - No candle data found for CS.D.USDCHF.MINI.IP 60m
2025-09-12 05:45:08,315 - WARNING - igstream.sync_manager - No candle data found for CS.D.EURUSD.CEEM.IP 5m
2025-09-12 05:45:08,316 - WARNING - igstream.sync_manager - No candle data found for CS.D.EURUSD.CEEM.IP 60m
2025-09-12 05:45:08,317 - WARNING - igstream.sync_manager - ⚠️ Stream CS.D.GBPUSD.MINI.IP needs restart (stale_data). Reconnecting...
2025-09-12 05:45:08,317 - INFO - igstream.chart_streamer - Chart streaming cancelled for CS.D.GBPUSD.MINI.IP
2025-09-12 05:45:08,317 - INFO - igstream.stream_validator - 🛑 Stopping stream validation service...
2025-09-12 05:45:08,317 - INFO - igstream.chart_streamer - 📊 Validation stats for CS.D.GBPUSD.MINI.IP: {'total_validations': 0, 'successful_validations': 0, 'discrepancies_found': 0, 'api_errors': 0, 'corrections_made': 0, 'queue_size': 0, 'success_rate_pct': 0.0, 'processing': False}
2025-09-12 05:45:08,318 - INFO - igstream.chart_streamer - 🔌 Disconnecting Lightstreamer for CS.D.GBPUSD.MINI.IP...
2025-09-12 05:45:08,318 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.GBPUSD.MINI.IP: DISCONNECTED
2025-09-12 05:45:08,319 - INFO - igstream.chart_streamer - ✅ Cleanup complete for CS.D.GBPUSD.MINI.IP
2025-09-12 05:45:08,320 - INFO - igstream.sync_manager - Stopped stream for CS.D.GBPUSD.MINI.IP
2025-09-12 05:45:09,038 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDCHF.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.79647, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:09,039 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.79647, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:09,067 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDCHF.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.79647, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:09,068 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.79647, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:10,321 - INFO - igstream.sync_manager - 🚀 Starting chart stream for CS.D.GBPUSD.MINI.IP
2025-09-12 05:45:10,321 - INFO - igstream.sync_manager - ✅ Stream CS.D.GBPUSD.MINI.IP restart triggered due to: stale_data
2025-09-12 05:45:10,321 - WARNING - igstream.sync_manager - ⚠️ Stream CS.D.USDJPY.MINI.IP needs restart (stale_data). Reconnecting...
2025-09-12 05:45:10,321 - INFO - igstream.chart_streamer - 🚀 Starting enhanced chart stream for CS.D.GBPUSD.MINI.IP
2025-09-12 05:45:10,322 - INFO - igstream.chart_streamer - 🔌 Connecting to Lightstreamer for CS.D.GBPUSD.MINI.IP...
2025-09-12 05:45:10,322 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.GBPUSD.MINI.IP: CONNECTING
2025-09-12 05:45:10,322 - INFO - igstream.chart_streamer - Chart streaming cancelled for CS.D.USDJPY.MINI.IP
2025-09-12 05:45:10,323 - INFO - igstream.stream_validator - 🛑 Stopping stream validation service...
2025-09-12 05:45:10,323 - INFO - igstream.chart_streamer - 📊 Validation stats for CS.D.USDJPY.MINI.IP: {'total_validations': 0, 'successful_validations': 0, 'discrepancies_found': 0, 'api_errors': 0, 'corrections_made': 0, 'queue_size': 0, 'success_rate_pct': 0.0, 'processing': False}
2025-09-12 05:45:10,324 - INFO - igstream.chart_streamer - 🔌 Disconnecting Lightstreamer for CS.D.USDJPY.MINI.IP...
2025-09-12 05:45:10,324 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.USDJPY.MINI.IP: DISCONNECTED
2025-09-12 05:45:10,324 - INFO - igstream.chart_streamer - ✅ Cleanup complete for CS.D.USDJPY.MINI.IP
2025-09-12 05:45:10,325 - INFO - igstream.sync_manager - Stopped stream for CS.D.USDJPY.MINI.IP
2025-09-12 05:45:10,609 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.GBPUSD.MINI.IP: CONNECTED:WS-STREAMING
2025-09-12 05:45:11,323 - INFO - igstream.chart_streamer - ✅ Connected to Lightstreamer for CS.D.GBPUSD.MINI.IP
2025-09-12 05:45:11,324 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.GBPUSD.MINI.IP:5MINUTE
2025-09-12 05:45:11,324 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.GBPUSD.MINI.IP:HOUR
2025-09-12 05:45:11,325 - INFO - igstream.chart_streamer - 📡 All subscriptions active for CS.D.GBPUSD.MINI.IP
2025-09-12 05:45:11,325 - INFO - igstream.chart_streamer - 🔍 Stream validation service started for CS.D.GBPUSD.MINI.IP
2025-09-12 05:45:11,325 - INFO - igstream.stream_validator - 🚀 Starting stream validation service...
2025-09-12 05:45:11,325 - INFO - igstream.stream_validator -    Validation delay: 300s
2025-09-12 05:45:11,325 - INFO - igstream.stream_validator -    Validation frequency: every 3 candles
2025-09-12 05:45:11,325 - INFO - igstream.stream_validator -    Rate limit: 80 requests/minute
2025-09-12 05:45:11,360 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 5m for CS.D.GBPUSD.MINI.IP
2025-09-12 05:45:11,361 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 60m for CS.D.GBPUSD.MINI.IP
2025-09-12 05:45:11,393 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.GBPUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.355655, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:11,394 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.355655, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:11,396 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.GBPUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.355655, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:11,396 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.355655, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:12,325 - INFO - igstream.sync_manager - 🚀 Starting chart stream for CS.D.USDJPY.MINI.IP
2025-09-12 05:45:12,326 - INFO - igstream.sync_manager - ✅ Stream CS.D.USDJPY.MINI.IP restart triggered due to: stale_data
2025-09-12 05:45:12,326 - WARNING - igstream.sync_manager - ⚠️ Stream CS.D.AUDUSD.MINI.IP needs restart (stale_data). Reconnecting...
2025-09-12 05:45:12,326 - INFO - igstream.chart_streamer - 🚀 Starting enhanced chart stream for CS.D.USDJPY.MINI.IP
2025-09-12 05:45:12,326 - INFO - igstream.chart_streamer - 🔌 Connecting to Lightstreamer for CS.D.USDJPY.MINI.IP...
2025-09-12 05:45:12,326 - INFO - igstream.chart_streamer - Chart streaming cancelled for CS.D.AUDUSD.MINI.IP
2025-09-12 05:45:12,327 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.USDJPY.MINI.IP: CONNECTING
2025-09-12 05:45:12,327 - INFO - igstream.stream_validator - 🛑 Stopping stream validation service...
2025-09-12 05:45:12,327 - INFO - igstream.chart_streamer - 📊 Validation stats for CS.D.AUDUSD.MINI.IP: {'total_validations': 0, 'successful_validations': 0, 'discrepancies_found': 0, 'api_errors': 0, 'corrections_made': 0, 'queue_size': 0, 'success_rate_pct': 0.0, 'processing': False}
2025-09-12 05:45:12,327 - INFO - igstream.chart_streamer - 🔌 Disconnecting Lightstreamer for CS.D.AUDUSD.MINI.IP...
2025-09-12 05:45:12,328 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.AUDUSD.MINI.IP: DISCONNECTED
2025-09-12 05:45:12,328 - INFO - igstream.chart_streamer - ✅ Cleanup complete for CS.D.AUDUSD.MINI.IP
2025-09-12 05:45:12,329 - INFO - igstream.sync_manager - Stopped stream for CS.D.AUDUSD.MINI.IP
2025-09-12 05:45:12,632 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.USDJPY.MINI.IP: CONNECTED:WS-STREAMING
2025-09-12 05:45:13,328 - INFO - igstream.chart_streamer - ✅ Connected to Lightstreamer for CS.D.USDJPY.MINI.IP
2025-09-12 05:45:13,329 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.USDJPY.MINI.IP:5MINUTE
2025-09-12 05:45:13,329 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.USDJPY.MINI.IP:HOUR
2025-09-12 05:45:13,329 - INFO - igstream.chart_streamer - 📡 All subscriptions active for CS.D.USDJPY.MINI.IP
2025-09-12 05:45:13,330 - INFO - igstream.chart_streamer - 🔍 Stream validation service started for CS.D.USDJPY.MINI.IP
2025-09-12 05:45:13,330 - INFO - igstream.stream_validator - 🚀 Starting stream validation service...
2025-09-12 05:45:13,330 - INFO - igstream.stream_validator -    Validation delay: 300s
2025-09-12 05:45:13,330 - INFO - igstream.stream_validator -    Validation frequency: every 3 candles
2025-09-12 05:45:13,330 - INFO - igstream.stream_validator -    Rate limit: 80 requests/minute
2025-09-12 05:45:13,366 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 5m for CS.D.USDJPY.MINI.IP
2025-09-12 05:45:13,366 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 60m for CS.D.USDJPY.MINI.IP
2025-09-12 05:45:13,403 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.453, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:13,408 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.453, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:13,410 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.453, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
