2025-09-12 05:46:24,034 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 98.231, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:24,036 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 98.231, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:24,037 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.231, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:24,038 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.231, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:24,040 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.666145, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:24,041 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.666145, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:24,044 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.90550000000002, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:24,045 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.90550000000002, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:24,047 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.90550000000002, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:24,048 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.90550000000002, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:24,049 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.GBPUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.3556050000000002, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:24,049 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.3556050000000002, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:24,051 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDCAD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.384305, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:24,052 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.384305, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:24,053 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDCAD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.384305, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:24,054 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.384305, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:24,056 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.NZDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.5971299999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:24,057 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.5971299999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:24,058 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.NZDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.5971299999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:24,060 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.5971299999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:24,062 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.454, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:24,063 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.454, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:24,064 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.454, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:24,065 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.454, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:24,067 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURUSD.CEEM.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.17252, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:24,068 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.17252, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:24,071 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURUSD.CEEM.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.17252, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:24,073 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.17252, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:24,076 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.666145, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:24,077 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.666145, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:24,078 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.GBPUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.3556050000000002, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:24,079 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.3556050000000002, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:25,032 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.232, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:25,034 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.232, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:25,035 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 98.232, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:25,035 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 98.232, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:25,036 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.9065, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:25,037 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.9065, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:25,064 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.9065, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:25,066 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.9065, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:26,362 - INFO - igstream.sync_manager - 📊 Database stats: 0 candles in last 30min, latest: None
2025-09-12 05:46:26,364 - WARNING - igstream.sync_manager - No candle data found for CS.D.GBPUSD.MINI.IP 5m
2025-09-12 05:46:26,366 - WARNING - igstream.sync_manager - No candle data found for CS.D.GBPUSD.MINI.IP 60m
2025-09-12 05:46:26,368 - WARNING - igstream.sync_manager - No candle data found for CS.D.USDJPY.MINI.IP 5m
2025-09-12 05:46:26,369 - WARNING - igstream.sync_manager - No candle data found for CS.D.USDJPY.MINI.IP 60m
2025-09-12 05:46:26,371 - WARNING - igstream.sync_manager - No candle data found for CS.D.AUDUSD.MINI.IP 5m
2025-09-12 05:46:26,372 - WARNING - igstream.sync_manager - No candle data found for CS.D.AUDUSD.MINI.IP 60m
2025-09-12 05:46:26,374 - WARNING - igstream.sync_manager - No candle data found for CS.D.USDCAD.MINI.IP 5m
2025-09-12 05:46:26,376 - WARNING - igstream.sync_manager - No candle data found for CS.D.USDCAD.MINI.IP 60m
2025-09-12 05:46:26,377 - WARNING - igstream.sync_manager - No candle data found for CS.D.EURJPY.MINI.IP 5m
2025-09-12 05:46:26,378 - WARNING - igstream.sync_manager - No candle data found for CS.D.EURJPY.MINI.IP 60m
2025-09-12 05:46:26,379 - WARNING - igstream.sync_manager - No candle data found for CS.D.AUDJPY.MINI.IP 5m
2025-09-12 05:46:26,380 - WARNING - igstream.sync_manager - No candle data found for CS.D.AUDJPY.MINI.IP 60m
2025-09-12 05:46:26,381 - WARNING - igstream.sync_manager - No candle data found for CS.D.NZDUSD.MINI.IP 5m
2025-09-12 05:46:26,382 - WARNING - igstream.sync_manager - No candle data found for CS.D.NZDUSD.MINI.IP 60m
2025-09-12 05:46:26,383 - WARNING - igstream.sync_manager - No candle data found for CS.D.USDCHF.MINI.IP 5m
2025-09-12 05:46:26,385 - WARNING - igstream.sync_manager - No candle data found for CS.D.USDCHF.MINI.IP 60m
2025-09-12 05:46:26,385 - WARNING - igstream.sync_manager - No candle data found for CS.D.EURUSD.CEEM.IP 5m
2025-09-12 05:46:26,386 - WARNING - igstream.sync_manager - No candle data found for CS.D.EURUSD.CEEM.IP 60m
2025-09-12 05:46:26,386 - WARNING - igstream.sync_manager - ⚠️ Stream CS.D.GBPUSD.MINI.IP needs restart (stale_data). Reconnecting...
2025-09-12 05:46:26,386 - INFO - igstream.chart_streamer - Chart streaming cancelled for CS.D.GBPUSD.MINI.IP
2025-09-12 05:46:26,387 - INFO - igstream.stream_validator - 🛑 Stopping stream validation service...
2025-09-12 05:46:26,387 - INFO - igstream.chart_streamer - 📊 Validation stats for CS.D.GBPUSD.MINI.IP: {'total_validations': 0, 'successful_validations': 0, 'discrepancies_found': 0, 'api_errors': 0, 'corrections_made': 0, 'queue_size': 0, 'success_rate_pct': 0.0, 'processing': False}
2025-09-12 05:46:26,387 - INFO - igstream.chart_streamer - 🔌 Disconnecting Lightstreamer for CS.D.GBPUSD.MINI.IP...
2025-09-12 05:46:26,387 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.GBPUSD.MINI.IP: DISCONNECTED
2025-09-12 05:46:26,387 - INFO - igstream.chart_streamer - ✅ Cleanup complete for CS.D.GBPUSD.MINI.IP
2025-09-12 05:46:26,387 - INFO - igstream.sync_manager - Stopped stream for CS.D.GBPUSD.MINI.IP
2025-09-12 05:46:27,032 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 98.235, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:27,033 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 98.235, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:27,035 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.666165, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:27,036 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.666165, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:27,039 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.NZDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.59714, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:27,039 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.59714, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:27,040 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.NZDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.59714, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:27,041 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.59714, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:27,063 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.235, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:27,065 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.235, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:27,067 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.666165, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:27,068 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.666165, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:28,036 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 98.235, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:28,037 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 98.235, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:28,040 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDCHF.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.7965150000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:28,041 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.7965150000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:28,066 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.235, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:28,067 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.235, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:28,070 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDCHF.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.7965150000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:28,071 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.7965150000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:28,388 - INFO - igstream.sync_manager - 🚀 Starting chart stream for CS.D.GBPUSD.MINI.IP
2025-09-12 05:46:28,388 - INFO - igstream.sync_manager - ✅ Stream CS.D.GBPUSD.MINI.IP restart triggered due to: stale_data
2025-09-12 05:46:28,388 - WARNING - igstream.sync_manager - ⚠️ Stream CS.D.USDJPY.MINI.IP needs restart (stale_data). Reconnecting...
2025-09-12 05:46:28,388 - INFO - igstream.chart_streamer - 🚀 Starting enhanced chart stream for CS.D.GBPUSD.MINI.IP
2025-09-12 05:46:28,388 - INFO - igstream.chart_streamer - 🔌 Connecting to Lightstreamer for CS.D.GBPUSD.MINI.IP...
2025-09-12 05:46:28,388 - INFO - igstream.chart_streamer - Chart streaming cancelled for CS.D.USDJPY.MINI.IP
2025-09-12 05:46:28,388 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.GBPUSD.MINI.IP: CONNECTING
2025-09-12 05:46:28,388 - INFO - igstream.stream_validator - 🛑 Stopping stream validation service...
2025-09-12 05:46:28,389 - INFO - igstream.chart_streamer - 📊 Validation stats for CS.D.USDJPY.MINI.IP: {'total_validations': 0, 'successful_validations': 0, 'discrepancies_found': 0, 'api_errors': 0, 'corrections_made': 0, 'queue_size': 0, 'success_rate_pct': 0.0, 'processing': False}
2025-09-12 05:46:28,389 - INFO - igstream.chart_streamer - 🔌 Disconnecting Lightstreamer for CS.D.USDJPY.MINI.IP...
2025-09-12 05:46:28,390 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.USDJPY.MINI.IP: DISCONNECTED
2025-09-12 05:46:28,391 - INFO - igstream.chart_streamer - ✅ Cleanup complete for CS.D.USDJPY.MINI.IP
2025-09-12 05:46:28,391 - INFO - igstream.sync_manager - Stopped stream for CS.D.USDJPY.MINI.IP
2025-09-12 05:46:28,701 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.GBPUSD.MINI.IP: CONNECTED:WS-STREAMING
2025-09-12 05:46:29,039 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 98.235, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:29,042 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 98.235, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:29,044 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.235, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:29,046 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.235, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:29,048 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.9065, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:29,049 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.9065, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:29,050 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.9065, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:29,051 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.9065, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:29,052 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.NZDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.5971299999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:29,053 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.5971299999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:29,054 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.NZDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.5971299999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:29,055 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.5971299999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:29,389 - INFO - igstream.chart_streamer - ✅ Connected to Lightstreamer for CS.D.GBPUSD.MINI.IP
2025-09-12 05:46:29,389 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.GBPUSD.MINI.IP:5MINUTE
2025-09-12 05:46:29,390 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.GBPUSD.MINI.IP:HOUR
2025-09-12 05:46:29,391 - INFO - igstream.chart_streamer - 📡 All subscriptions active for CS.D.GBPUSD.MINI.IP
2025-09-12 05:46:29,391 - INFO - igstream.chart_streamer - 🔍 Stream validation service started for CS.D.GBPUSD.MINI.IP
2025-09-12 05:46:29,391 - INFO - igstream.stream_validator - 🚀 Starting stream validation service...
2025-09-12 05:46:29,391 - INFO - igstream.stream_validator -    Validation delay: 300s
2025-09-12 05:46:29,391 - INFO - igstream.stream_validator -    Validation frequency: every 3 candles
2025-09-12 05:46:29,391 - INFO - igstream.stream_validator -    Rate limit: 80 requests/minute
2025-09-12 05:46:29,427 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 5m for CS.D.GBPUSD.MINI.IP
2025-09-12 05:46:29,456 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 60m for CS.D.GBPUSD.MINI.IP
2025-09-12 05:46:29,458 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.GBPUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.355615, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:29,459 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.355615, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:29,460 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.GBPUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.355615, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:29,460 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.355615, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:30,040 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 98.233, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:30,041 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 98.233, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:30,042 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.666145, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:30,043 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.666145, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:30,045 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.9085, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:30,046 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.9085, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:30,047 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.9085, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:30,048 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.9085, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:30,048 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.NZDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.59714, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:30,049 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.59714, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:30,049 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.NZDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.59714, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:30,050 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.59714, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:30,060 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURUSD.CEEM.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.17251, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:30,061 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.17251, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:30,062 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURUSD.CEEM.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.17251, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:30,062 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.17251, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:30,068 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.233, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:30,069 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.233, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:30,071 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.666145, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:30,072 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.666145, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:30,392 - INFO - igstream.sync_manager - 🚀 Starting chart stream for CS.D.USDJPY.MINI.IP
2025-09-12 05:46:30,392 - INFO - igstream.sync_manager - ✅ Stream CS.D.USDJPY.MINI.IP restart triggered due to: stale_data
2025-09-12 05:46:30,392 - WARNING - igstream.sync_manager - ⚠️ Stream CS.D.AUDUSD.MINI.IP needs restart (stale_data). Reconnecting...
2025-09-12 05:46:30,392 - INFO - igstream.chart_streamer - 🚀 Starting enhanced chart stream for CS.D.USDJPY.MINI.IP
2025-09-12 05:46:30,392 - INFO - igstream.chart_streamer - 🔌 Connecting to Lightstreamer for CS.D.USDJPY.MINI.IP...
2025-09-12 05:46:30,393 - INFO - igstream.chart_streamer - Chart streaming cancelled for CS.D.AUDUSD.MINI.IP
2025-09-12 05:46:30,393 - INFO - igstream.stream_validator - 🛑 Stopping stream validation service...
2025-09-12 05:46:30,393 - INFO - igstream.chart_streamer - 📊 Validation stats for CS.D.AUDUSD.MINI.IP: {'total_validations': 0, 'successful_validations': 0, 'discrepancies_found': 0, 'api_errors': 0, 'corrections_made': 0, 'queue_size': 0, 'success_rate_pct': 0.0, 'processing': False}
2025-09-12 05:46:30,393 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.USDJPY.MINI.IP: CONNECTING
2025-09-12 05:46:30,394 - INFO - igstream.chart_streamer - 🔌 Disconnecting Lightstreamer for CS.D.AUDUSD.MINI.IP...
2025-09-12 05:46:30,395 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.AUDUSD.MINI.IP: DISCONNECTED
2025-09-12 05:46:30,396 - INFO - igstream.chart_streamer - ✅ Cleanup complete for CS.D.AUDUSD.MINI.IP
2025-09-12 05:46:30,396 - INFO - igstream.sync_manager - Stopped stream for CS.D.AUDUSD.MINI.IP
2025-09-12 05:46:30,641 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.USDJPY.MINI.IP: CONNECTED:WS-STREAMING
2025-09-12 05:46:31,036 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.235, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:31,037 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.235, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:31,039 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 98.235, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:31,040 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 98.235, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:31,393 - INFO - igstream.chart_streamer - ✅ Connected to Lightstreamer for CS.D.USDJPY.MINI.IP
2025-09-12 05:46:31,393 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.USDJPY.MINI.IP:5MINUTE
2025-09-12 05:46:31,393 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.USDJPY.MINI.IP:HOUR
2025-09-12 05:46:31,393 - INFO - igstream.chart_streamer - 📡 All subscriptions active for CS.D.USDJPY.MINI.IP
2025-09-12 05:46:31,393 - INFO - igstream.chart_streamer - 🔍 Stream validation service started for CS.D.USDJPY.MINI.IP
2025-09-12 05:46:31,394 - INFO - igstream.stream_validator - 🚀 Starting stream validation service...
2025-09-12 05:46:31,394 - INFO - igstream.stream_validator -    Validation delay: 300s
2025-09-12 05:46:31,394 - INFO - igstream.stream_validator -    Validation frequency: every 3 candles
2025-09-12 05:46:31,394 - INFO - igstream.stream_validator -    Rate limit: 80 requests/minute
2025-09-12 05:46:31,430 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 5m for CS.D.USDJPY.MINI.IP
2025-09-12 05:46:31,430 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 60m for CS.D.USDJPY.MINI.IP
2025-09-12 05:46:31,462 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.45600000000002, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:31,463 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.45600000000002, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:31,464 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.45600000000002, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:31,465 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.45600000000002, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:32,039 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 98.23400000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:32,041 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 98.23400000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:32,043 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.23400000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:32,045 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.23400000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:32,047 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.9075, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:32,048 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.9075, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:32,050 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.454, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:32,052 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.454, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:32,071 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.9075, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:32,073 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.9075, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:32,076 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.454, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:32,077 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.454, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:32,397 - INFO - igstream.sync_manager - 🚀 Starting chart stream for CS.D.AUDUSD.MINI.IP
2025-09-12 05:46:32,397 - INFO - igstream.sync_manager - ✅ Stream CS.D.AUDUSD.MINI.IP restart triggered due to: stale_data
2025-09-12 05:46:32,397 - WARNING - igstream.sync_manager - ⚠️ Stream CS.D.USDCAD.MINI.IP needs restart (stale_data). Reconnecting...
2025-09-12 05:46:32,398 - INFO - igstream.chart_streamer - 🚀 Starting enhanced chart stream for CS.D.AUDUSD.MINI.IP
2025-09-12 05:46:32,398 - INFO - igstream.chart_streamer - 🔌 Connecting to Lightstreamer for CS.D.AUDUSD.MINI.IP...
2025-09-12 05:46:32,398 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.AUDUSD.MINI.IP: CONNECTING
2025-09-12 05:46:32,399 - INFO - igstream.chart_streamer - Chart streaming cancelled for CS.D.USDCAD.MINI.IP
2025-09-12 05:46:32,399 - INFO - igstream.stream_validator - 🛑 Stopping stream validation service...
2025-09-12 05:46:32,399 - INFO - igstream.chart_streamer - 📊 Validation stats for CS.D.USDCAD.MINI.IP: {'total_validations': 0, 'successful_validations': 0, 'discrepancies_found': 0, 'api_errors': 0, 'corrections_made': 0, 'queue_size': 0, 'success_rate_pct': 0.0, 'processing': False}
2025-09-12 05:46:32,399 - INFO - igstream.chart_streamer - 🔌 Disconnecting Lightstreamer for CS.D.USDCAD.MINI.IP...
2025-09-12 05:46:32,400 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.USDCAD.MINI.IP: DISCONNECTED
2025-09-12 05:46:32,400 - INFO - igstream.chart_streamer - ✅ Cleanup complete for CS.D.USDCAD.MINI.IP
2025-09-12 05:46:32,401 - INFO - igstream.sync_manager - Stopped stream for CS.D.USDCAD.MINI.IP
2025-09-12 05:46:32,630 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.AUDUSD.MINI.IP: CONNECTED:WS-STREAMING
2025-09-12 05:46:33,041 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.NZDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.5971299999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:33,041 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.5971299999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:33,071 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.NZDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.5971299999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:33,071 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.5971299999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:33,399 - INFO - igstream.chart_streamer - ✅ Connected to Lightstreamer for CS.D.AUDUSD.MINI.IP
2025-09-12 05:46:33,399 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.AUDUSD.MINI.IP:5MINUTE
2025-09-12 05:46:33,400 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.AUDUSD.MINI.IP:HOUR
2025-09-12 05:46:33,400 - INFO - igstream.chart_streamer - 📡 All subscriptions active for CS.D.AUDUSD.MINI.IP
2025-09-12 05:46:33,400 - INFO - igstream.chart_streamer - 🔍 Stream validation service started for CS.D.AUDUSD.MINI.IP
2025-09-12 05:46:33,400 - INFO - igstream.stream_validator - 🚀 Starting stream validation service...
2025-09-12 05:46:33,400 - INFO - igstream.stream_validator -    Validation delay: 300s
2025-09-12 05:46:33,400 - INFO - igstream.stream_validator -    Validation frequency: every 3 candles
2025-09-12 05:46:33,400 - INFO - igstream.stream_validator -    Rate limit: 80 requests/minute
2025-09-12 05:46:33,438 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 5m for CS.D.AUDUSD.MINI.IP
2025-09-12 05:46:33,469 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 60m for CS.D.AUDUSD.MINI.IP
2025-09-12 05:46:33,472 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.666165, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:33,473 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.666165, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:33,475 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.666165, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:33,476 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.666165, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:34,040 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.GBPUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.3556249999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:34,041 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.3556249999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:34,070 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.GBPUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.3556249999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:34,072 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.3556249999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:34,401 - INFO - igstream.sync_manager - 🚀 Starting chart stream for CS.D.USDCAD.MINI.IP
2025-09-12 05:46:34,402 - INFO - igstream.sync_manager - ✅ Stream CS.D.USDCAD.MINI.IP restart triggered due to: stale_data
2025-09-12 05:46:34,402 - WARNING - igstream.sync_manager - ⚠️ Stream CS.D.EURJPY.MINI.IP needs restart (stale_data). Reconnecting...
2025-09-12 05:46:34,402 - INFO - igstream.chart_streamer - 🚀 Starting enhanced chart stream for CS.D.USDCAD.MINI.IP
2025-09-12 05:46:34,402 - INFO - igstream.chart_streamer - 🔌 Connecting to Lightstreamer for CS.D.USDCAD.MINI.IP...
2025-09-12 05:46:34,402 - INFO - igstream.chart_streamer - Chart streaming cancelled for CS.D.EURJPY.MINI.IP
2025-09-12 05:46:34,402 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.USDCAD.MINI.IP: CONNECTING
2025-09-12 05:46:34,403 - INFO - igstream.stream_validator - 🛑 Stopping stream validation service...
2025-09-12 05:46:34,403 - INFO - igstream.chart_streamer - 📊 Validation stats for CS.D.EURJPY.MINI.IP: {'total_validations': 0, 'successful_validations': 0, 'discrepancies_found': 0, 'api_errors': 0, 'corrections_made': 0, 'queue_size': 0, 'success_rate_pct': 0.0, 'processing': False}
2025-09-12 05:46:34,403 - INFO - igstream.chart_streamer - 🔌 Disconnecting Lightstreamer for CS.D.EURJPY.MINI.IP...
2025-09-12 05:46:34,403 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.EURJPY.MINI.IP: DISCONNECTED
2025-09-12 05:46:34,403 - INFO - igstream.chart_streamer - ✅ Cleanup complete for CS.D.EURJPY.MINI.IP
2025-09-12 05:46:34,404 - INFO - igstream.sync_manager - Stopped stream for CS.D.EURJPY.MINI.IP
2025-09-12 05:46:34,680 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.USDCAD.MINI.IP: CONNECTED:WS-STREAMING
2025-09-12 05:46:35,040 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 98.239, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:35,041 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 98.239, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:35,045 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.666185, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:35,046 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.666185, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:35,048 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.GBPUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.355655, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:35,050 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.355655, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:35,052 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.453, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:35,054 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.453, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:35,057 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.NZDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.59714, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:35,058 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.59714, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:35,060 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURUSD.CEEM.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.1725400000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:35,062 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.1725400000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:35,071 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.239, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:35,072 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.239, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:35,077 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.666185, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:35,079 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.666185, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:35,082 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.GBPUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.355655, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:35,083 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.355655, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:35,087 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.453, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:35,088 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.453, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:35,090 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.NZDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.59714, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:35,090 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.59714, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:35,092 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURUSD.CEEM.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.1725400000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:35,093 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.1725400000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:35,403 - INFO - igstream.chart_streamer - ✅ Connected to Lightstreamer for CS.D.USDCAD.MINI.IP
2025-09-12 05:46:35,403 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.USDCAD.MINI.IP:5MINUTE
2025-09-12 05:46:35,404 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.USDCAD.MINI.IP:HOUR
2025-09-12 05:46:35,405 - INFO - igstream.chart_streamer - 📡 All subscriptions active for CS.D.USDCAD.MINI.IP
2025-09-12 05:46:35,405 - INFO - igstream.chart_streamer - 🔍 Stream validation service started for CS.D.USDCAD.MINI.IP
2025-09-12 05:46:35,405 - INFO - igstream.stream_validator - 🚀 Starting stream validation service...
2025-09-12 05:46:35,405 - INFO - igstream.stream_validator -    Validation delay: 300s
2025-09-12 05:46:35,405 - INFO - igstream.stream_validator -    Validation frequency: every 3 candles
2025-09-12 05:46:35,405 - INFO - igstream.stream_validator -    Rate limit: 80 requests/minute
2025-09-12 05:46:35,444 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 5m for CS.D.USDCAD.MINI.IP
2025-09-12 05:46:35,473 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 60m for CS.D.USDCAD.MINI.IP
2025-09-12 05:46:35,474 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDCAD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.384285, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:35,475 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.384285, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:35,476 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDCAD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.384285, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:35,477 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.384285, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:36,039 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.238, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:36,040 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.238, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:36,042 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 98.238, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:36,043 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 98.238, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:36,405 - INFO - igstream.sync_manager - 🚀 Starting chart stream for CS.D.EURJPY.MINI.IP
2025-09-12 05:46:36,405 - INFO - igstream.sync_manager - ✅ Stream CS.D.EURJPY.MINI.IP restart triggered due to: stale_data
2025-09-12 05:46:36,408 - WARNING - igstream.sync_manager - ⚠️ Stream CS.D.AUDJPY.MINI.IP needs restart (stale_data). Reconnecting...
2025-09-12 05:46:36,409 - INFO - igstream.chart_streamer - 🚀 Starting enhanced chart stream for CS.D.EURJPY.MINI.IP
2025-09-12 05:46:36,409 - INFO - igstream.chart_streamer - 🔌 Connecting to Lightstreamer for CS.D.EURJPY.MINI.IP...
2025-09-12 05:46:36,410 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.EURJPY.MINI.IP: CONNECTING
2025-09-12 05:46:36,410 - INFO - igstream.chart_streamer - Chart streaming cancelled for CS.D.AUDJPY.MINI.IP
2025-09-12 05:46:36,411 - INFO - igstream.stream_validator - 🛑 Stopping stream validation service...
2025-09-12 05:46:36,411 - INFO - igstream.chart_streamer - 📊 Validation stats for CS.D.AUDJPY.MINI.IP: {'total_validations': 0, 'successful_validations': 0, 'discrepancies_found': 0, 'api_errors': 0, 'corrections_made': 0, 'queue_size': 0, 'success_rate_pct': 0.0, 'processing': False}
2025-09-12 05:46:36,411 - INFO - igstream.chart_streamer - 🔌 Disconnecting Lightstreamer for CS.D.AUDJPY.MINI.IP...
2025-09-12 05:46:36,412 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.AUDJPY.MINI.IP: DISCONNECTED
2025-09-12 05:46:36,413 - INFO - igstream.chart_streamer - ✅ Cleanup complete for CS.D.AUDJPY.MINI.IP
2025-09-12 05:46:36,414 - INFO - igstream.sync_manager - Stopped stream for CS.D.AUDJPY.MINI.IP
2025-09-12 05:46:36,638 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.EURJPY.MINI.IP: CONNECTED:WS-STREAMING
2025-09-12 05:46:37,040 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.6661950000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:37,041 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.6661950000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:37,045 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.454, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:37,046 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.454, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:37,047 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.454, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:37,047 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.454, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:37,070 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.6661950000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:37,071 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.6661950000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:37,411 - INFO - igstream.chart_streamer - ✅ Connected to Lightstreamer for CS.D.EURJPY.MINI.IP
2025-09-12 05:46:37,411 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.EURJPY.MINI.IP:5MINUTE
2025-09-12 05:46:37,411 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.EURJPY.MINI.IP:HOUR
2025-09-12 05:46:37,412 - INFO - igstream.chart_streamer - 📡 All subscriptions active for CS.D.EURJPY.MINI.IP
2025-09-12 05:46:37,412 - INFO - igstream.chart_streamer - 🔍 Stream validation service started for CS.D.EURJPY.MINI.IP
2025-09-12 05:46:37,412 - INFO - igstream.stream_validator - 🚀 Starting stream validation service...
2025-09-12 05:46:37,412 - INFO - igstream.stream_validator -    Validation delay: 300s
2025-09-12 05:46:37,412 - INFO - igstream.stream_validator -    Validation frequency: every 3 candles
2025-09-12 05:46:37,412 - INFO - igstream.stream_validator -    Rate limit: 80 requests/minute
2025-09-12 05:46:37,448 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 5m for CS.D.EURJPY.MINI.IP
2025-09-12 05:46:37,480 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 60m for CS.D.EURJPY.MINI.IP
2025-09-12 05:46:37,482 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.9105, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:37,483 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.9105, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:37,484 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.9105, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:37,485 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.9105, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:38,415 - INFO - igstream.sync_manager - 🚀 Starting chart stream for CS.D.AUDJPY.MINI.IP
2025-09-12 05:46:38,415 - INFO - igstream.sync_manager - ✅ Stream CS.D.AUDJPY.MINI.IP restart triggered due to: stale_data
2025-09-12 05:46:38,416 - WARNING - igstream.sync_manager - ⚠️ Stream CS.D.NZDUSD.MINI.IP needs restart (stale_data). Reconnecting...
2025-09-12 05:46:38,416 - INFO - igstream.chart_streamer - 🚀 Starting enhanced chart stream for CS.D.AUDJPY.MINI.IP
2025-09-12 05:46:38,416 - INFO - igstream.chart_streamer - 🔌 Connecting to Lightstreamer for CS.D.AUDJPY.MINI.IP...
2025-09-12 05:46:38,417 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.AUDJPY.MINI.IP: CONNECTING
2025-09-12 05:46:38,417 - INFO - igstream.chart_streamer - Chart streaming cancelled for CS.D.NZDUSD.MINI.IP
2025-09-12 05:46:38,418 - INFO - igstream.stream_validator - 🛑 Stopping stream validation service...
2025-09-12 05:46:38,419 - INFO - igstream.chart_streamer - 📊 Validation stats for CS.D.NZDUSD.MINI.IP: {'total_validations': 0, 'successful_validations': 0, 'discrepancies_found': 0, 'api_errors': 0, 'corrections_made': 0, 'queue_size': 0, 'success_rate_pct': 0.0, 'processing': False}
2025-09-12 05:46:38,419 - INFO - igstream.chart_streamer - 🔌 Disconnecting Lightstreamer for CS.D.NZDUSD.MINI.IP...
2025-09-12 05:46:38,419 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.NZDUSD.MINI.IP: DISCONNECTED
2025-09-12 05:46:38,420 - INFO - igstream.chart_streamer - ✅ Cleanup complete for CS.D.NZDUSD.MINI.IP
2025-09-12 05:46:38,420 - INFO - igstream.sync_manager - Stopped stream for CS.D.NZDUSD.MINI.IP
2025-09-12 05:46:38,691 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.AUDJPY.MINI.IP: CONNECTED:WS-STREAMING
2025-09-12 05:46:39,041 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.66622, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:39,044 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.66622, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:39,046 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDCAD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.384275, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:39,047 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.384275, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:39,071 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.66622, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:39,072 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.66622, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:39,074 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDCAD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.384275, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:39,074 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.384275, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:39,418 - INFO - igstream.chart_streamer - ✅ Connected to Lightstreamer for CS.D.AUDJPY.MINI.IP
2025-09-12 05:46:39,419 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.AUDJPY.MINI.IP:5MINUTE
2025-09-12 05:46:39,419 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.AUDJPY.MINI.IP:HOUR
2025-09-12 05:46:39,419 - INFO - igstream.chart_streamer - 📡 All subscriptions active for CS.D.AUDJPY.MINI.IP
2025-09-12 05:46:39,420 - INFO - igstream.chart_streamer - 🔍 Stream validation service started for CS.D.AUDJPY.MINI.IP
2025-09-12 05:46:39,420 - INFO - igstream.stream_validator - 🚀 Starting stream validation service...
2025-09-12 05:46:39,420 - INFO - igstream.stream_validator -    Validation delay: 300s
2025-09-12 05:46:39,420 - INFO - igstream.stream_validator -    Validation frequency: every 3 candles
2025-09-12 05:46:39,420 - INFO - igstream.stream_validator -    Rate limit: 80 requests/minute
2025-09-12 05:46:39,456 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 5m for CS.D.AUDJPY.MINI.IP
2025-09-12 05:46:39,487 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 60m for CS.D.AUDJPY.MINI.IP
2025-09-12 05:46:39,491 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 98.24199999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:39,492 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 98.24199999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:39,494 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.24199999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:39,495 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.24199999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:40,036 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 98.243, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:40,038 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 98.243, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:40,041 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.243, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:40,043 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.243, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:40,046 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.66625, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:40,047 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.66625, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:40,050 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.9075, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:40,052 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.9075, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:40,054 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.GBPUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.3556650000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:40,055 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.3556650000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:40,056 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDCAD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.384255, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:40,057 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.384255, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:40,058 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDCHF.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.796485, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:40,059 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.796485, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:40,061 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.447, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:40,062 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.447, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:40,064 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.447, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:40,065 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.447, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:40,068 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURUSD.CEEM.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.1725599999999998, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:40,070 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.1725599999999998, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:40,074 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURUSD.CEEM.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.1725599999999998, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:40,075 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.1725599999999998, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:40,077 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.66625, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:40,079 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.66625, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:40,080 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.9075, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:40,081 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.9075, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:40,083 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.GBPUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.3556650000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:40,084 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.3556650000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:40,086 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDCAD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.384255, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:40,087 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.384255, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:40,089 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDCHF.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.796485, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:40,090 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.796485, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:40,421 - INFO - igstream.sync_manager - 🚀 Starting chart stream for CS.D.NZDUSD.MINI.IP
2025-09-12 05:46:40,421 - INFO - igstream.sync_manager - ✅ Stream CS.D.NZDUSD.MINI.IP restart triggered due to: stale_data
2025-09-12 05:46:40,421 - WARNING - igstream.sync_manager - ⚠️ Stream CS.D.USDCHF.MINI.IP needs restart (stale_data). Reconnecting...
2025-09-12 05:46:40,421 - INFO - igstream.chart_streamer - 🚀 Starting enhanced chart stream for CS.D.NZDUSD.MINI.IP
2025-09-12 05:46:40,422 - INFO - igstream.chart_streamer - 🔌 Connecting to Lightstreamer for CS.D.NZDUSD.MINI.IP...
2025-09-12 05:46:40,422 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.NZDUSD.MINI.IP: CONNECTING
2025-09-12 05:46:40,423 - INFO - igstream.chart_streamer - Chart streaming cancelled for CS.D.USDCHF.MINI.IP
2025-09-12 05:46:40,423 - INFO - igstream.stream_validator - 🛑 Stopping stream validation service...
2025-09-12 05:46:40,423 - INFO - igstream.chart_streamer - 📊 Validation stats for CS.D.USDCHF.MINI.IP: {'total_validations': 0, 'successful_validations': 0, 'discrepancies_found': 0, 'api_errors': 0, 'corrections_made': 0, 'queue_size': 0, 'success_rate_pct': 0.0, 'processing': False}
2025-09-12 05:46:40,423 - INFO - igstream.chart_streamer - 🔌 Disconnecting Lightstreamer for CS.D.USDCHF.MINI.IP...
2025-09-12 05:46:40,424 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.USDCHF.MINI.IP: DISCONNECTED
2025-09-12 05:46:40,424 - INFO - igstream.chart_streamer - ✅ Cleanup complete for CS.D.USDCHF.MINI.IP
2025-09-12 05:46:40,424 - INFO - igstream.sync_manager - Stopped stream for CS.D.USDCHF.MINI.IP
2025-09-12 05:46:40,699 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.NZDUSD.MINI.IP: CONNECTED:WS-STREAMING
2025-09-12 05:46:41,036 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 98.24199999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:41,037 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 98.24199999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:41,041 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.448, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:41,042 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.448, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:41,042 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.448, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:41,043 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.448, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:41,064 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.24199999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:41,065 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.24199999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:41,423 - INFO - igstream.chart_streamer - ✅ Connected to Lightstreamer for CS.D.NZDUSD.MINI.IP
2025-09-12 05:46:41,423 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.NZDUSD.MINI.IP:5MINUTE
2025-09-12 05:46:41,424 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.NZDUSD.MINI.IP:HOUR
2025-09-12 05:46:41,424 - INFO - igstream.chart_streamer - 📡 All subscriptions active for CS.D.NZDUSD.MINI.IP
2025-09-12 05:46:41,424 - INFO - igstream.chart_streamer - 🔍 Stream validation service started for CS.D.NZDUSD.MINI.IP
2025-09-12 05:46:41,424 - INFO - igstream.stream_validator - 🚀 Starting stream validation service...
2025-09-12 05:46:41,424 - INFO - igstream.stream_validator -    Validation delay: 300s
2025-09-12 05:46:41,425 - INFO - igstream.stream_validator -    Validation frequency: every 3 candles
2025-09-12 05:46:41,425 - INFO - igstream.stream_validator -    Rate limit: 80 requests/minute
2025-09-12 05:46:41,463 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 5m for CS.D.NZDUSD.MINI.IP
2025-09-12 05:46:41,493 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 60m for CS.D.NZDUSD.MINI.IP
2025-09-12 05:46:41,495 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.NZDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.59718, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:41,496 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.59718, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:41,498 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.NZDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.59718, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:41,499 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.59718, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:42,037 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.9065, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:42,038 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.9065, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:42,068 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.9065, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:42,070 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.9065, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:42,425 - INFO - igstream.sync_manager - 🚀 Starting chart stream for CS.D.USDCHF.MINI.IP
2025-09-12 05:46:42,425 - INFO - igstream.sync_manager - ✅ Stream CS.D.USDCHF.MINI.IP restart triggered due to: stale_data
2025-09-12 05:46:42,425 - WARNING - igstream.sync_manager - ⚠️ Stream CS.D.EURUSD.CEEM.IP needs restart (stale_data). Reconnecting...
2025-09-12 05:46:42,425 - INFO - igstream.chart_streamer - 🚀 Starting enhanced chart stream for CS.D.USDCHF.MINI.IP
2025-09-12 05:46:42,425 - INFO - igstream.chart_streamer - 🔌 Connecting to Lightstreamer for CS.D.USDCHF.MINI.IP...
2025-09-12 05:46:42,426 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.USDCHF.MINI.IP: CONNECTING
2025-09-12 05:46:42,426 - INFO - igstream.chart_streamer - Chart streaming cancelled for CS.D.EURUSD.CEEM.IP
2025-09-12 05:46:42,426 - INFO - igstream.stream_validator - 🛑 Stopping stream validation service...
2025-09-12 05:46:42,427 - INFO - igstream.chart_streamer - 📊 Validation stats for CS.D.EURUSD.CEEM.IP: {'total_validations': 0, 'successful_validations': 0, 'discrepancies_found': 0, 'api_errors': 0, 'corrections_made': 0, 'queue_size': 0, 'success_rate_pct': 0.0, 'processing': False}
2025-09-12 05:46:42,427 - INFO - igstream.chart_streamer - 🔌 Disconnecting Lightstreamer for CS.D.EURUSD.CEEM.IP...
2025-09-12 05:46:42,427 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.EURUSD.CEEM.IP: DISCONNECTED
2025-09-12 05:46:42,428 - INFO - igstream.chart_streamer - ✅ Cleanup complete for CS.D.EURUSD.CEEM.IP
2025-09-12 05:46:42,428 - INFO - igstream.sync_manager - Stopped stream for CS.D.EURUSD.CEEM.IP
2025-09-12 05:46:42,654 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.USDCHF.MINI.IP: CONNECTED:WS-STREAMING
2025-09-12 05:46:43,039 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.90550000000002, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:43,040 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.90550000000002, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:43,042 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.90550000000002, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:43,043 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.90550000000002, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:43,427 - INFO - igstream.chart_streamer - ✅ Connected to Lightstreamer for CS.D.USDCHF.MINI.IP
2025-09-12 05:46:43,427 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.USDCHF.MINI.IP:5MINUTE
2025-09-12 05:46:43,428 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.USDCHF.MINI.IP:HOUR
2025-09-12 05:46:43,428 - INFO - igstream.chart_streamer - 📡 All subscriptions active for CS.D.USDCHF.MINI.IP
2025-09-12 05:46:43,429 - INFO - igstream.chart_streamer - 🔍 Stream validation service started for CS.D.USDCHF.MINI.IP
2025-09-12 05:46:43,429 - INFO - igstream.stream_validator - 🚀 Starting stream validation service...
2025-09-12 05:46:43,429 - INFO - igstream.stream_validator -    Validation delay: 300s
2025-09-12 05:46:43,429 - INFO - igstream.stream_validator -    Validation frequency: every 3 candles
2025-09-12 05:46:43,429 - INFO - igstream.stream_validator -    Rate limit: 80 requests/minute
2025-09-12 05:46:43,464 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 5m for CS.D.USDCHF.MINI.IP
2025-09-12 05:46:43,464 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 60m for CS.D.USDCHF.MINI.IP
2025-09-12 05:46:43,497 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDCHF.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.796485, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:43,498 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.796485, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:43,500 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDCHF.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.796485, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:43,501 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.796485, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:44,428 - INFO - igstream.sync_manager - 🚀 Starting chart stream for CS.D.EURUSD.CEEM.IP
2025-09-12 05:46:44,429 - INFO - igstream.sync_manager - ✅ Stream CS.D.EURUSD.CEEM.IP restart triggered due to: stale_data
2025-09-12 05:46:44,429 - INFO - igstream.chart_streamer - 🚀 Starting enhanced chart stream for CS.D.EURUSD.CEEM.IP
2025-09-12 05:46:44,429 - INFO - igstream.chart_streamer - 🔌 Connecting to Lightstreamer for CS.D.EURUSD.CEEM.IP...
2025-09-12 05:46:44,430 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.EURUSD.CEEM.IP: CONNECTING
2025-09-12 05:46:44,694 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.EURUSD.CEEM.IP: CONNECTED:WS-STREAMING
2025-09-12 05:46:45,430 - INFO - igstream.chart_streamer - ✅ Connected to Lightstreamer for CS.D.EURUSD.CEEM.IP
2025-09-12 05:46:45,431 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.EURUSD.CEEM.IP:5MINUTE
2025-09-12 05:46:45,431 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.EURUSD.CEEM.IP:HOUR
2025-09-12 05:46:45,431 - INFO - igstream.chart_streamer - 📡 All subscriptions active for CS.D.EURUSD.CEEM.IP
2025-09-12 05:46:45,431 - INFO - igstream.chart_streamer - 🔍 Stream validation service started for CS.D.EURUSD.CEEM.IP
2025-09-12 05:46:45,431 - INFO - igstream.stream_validator - 🚀 Starting stream validation service...
2025-09-12 05:46:45,431 - INFO - igstream.stream_validator -    Validation delay: 300s
2025-09-12 05:46:45,431 - INFO - igstream.stream_validator -    Validation frequency: every 3 candles
2025-09-12 05:46:45,431 - INFO - igstream.stream_validator -    Rate limit: 80 requests/minute
2025-09-12 05:46:45,468 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 5m for CS.D.EURUSD.CEEM.IP
2025-09-12 05:46:45,499 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 60m for CS.D.EURUSD.CEEM.IP
2025-09-12 05:46:45,502 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURUSD.CEEM.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.1725599999999998, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:45,503 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.1725599999999998, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:45,506 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURUSD.CEEM.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.1725599999999998, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:45,508 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.1725599999999998, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:51,030 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.9065, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:51,031 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.9065, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:51,033 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.9065, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:51,034 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.9065, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:53,041 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.90550000000002, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:53,042 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.90550000000002, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:53,044 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.90550000000002, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:53,045 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.90550000000002, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:57,037 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.449, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:57,038 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.449, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:57,067 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.449, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:57,068 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.449, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:59,033 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.448, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:59,034 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.448, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:59,062 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.448, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:59,063 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.448, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:47:01,044 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.90550000000002, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:47:01,046 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.90550000000002, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:47:01,047 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.447, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:47:01,048 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.447, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:47:01,076 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.90550000000002, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:47:01,077 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.90550000000002, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:47:01,080 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.447, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:47:01,081 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.447, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:47:02,042 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.243, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:47:02,044 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.243, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:47:02,046 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 98.243, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:47:02,047 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 98.243, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:47:02,048 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.9065, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:47:02,049 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.9065, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:47:02,050 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.9065, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:47:02,050 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.9065, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:47:02,051 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.448, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:47:02,052 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.448, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:47:02,079 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.448, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:47:02,081 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.448, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:47:03,039 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 98.24000000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:47:03,040 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 98.24000000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:47:03,043 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.24000000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:47:03,044 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.24000000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:47:03,045 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.6662349999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:47:03,046 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.6662349999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:47:03,047 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.9035, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:47:03,048 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.9035, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:47:03,050 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.GBPUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.355635, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:47:03,051 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.355635, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:47:03,053 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.GBPUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.355635, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:47:03,054 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.355635, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:47:03,058 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURUSD.CEEM.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.1725299999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:47:03,059 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.1725299999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:47:03,068 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.6662349999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:47:03,070 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.6662349999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:47:03,072 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.9035, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:47:03,073 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.9035, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:47:03,085 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURUSD.CEEM.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.1725299999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:47:03,086 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.1725299999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:47:04,033 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 98.241, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:47:04,035 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 98.241, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:47:04,036 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.241, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:47:04,037 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.241, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:47:05,041 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 98.24000000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:47:05,042 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 98.24000000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:47:05,044 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.449, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:47:05,044 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.449, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:47:05,062 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.24000000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:47:05,065 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.24000000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:47:05,068 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.449, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:47:05,070 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.449, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:47:09,045 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.9025, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:47:09,046 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.9025, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:47:09,074 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.9025, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:47:09,076 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.9025, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:47:10,041 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.9035, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:47:10,042 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.9035, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:47:10,044 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.9035, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:47:10,046 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.9035, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:47:10,048 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDCAD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.384245, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:47:10,049 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.384245, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:47:10,051 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDCHF.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.79645, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:47:10,052 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.79645, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:47:10,070 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDCAD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.384245, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:47:10,071 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.384245, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:47:10,072 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDCHF.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.79645, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:47:10,072 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.79645, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:47:11,038 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 98.241, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:47:11,040 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 98.241, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:47:11,042 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.241, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:47:11,043 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.241, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:47:11,044 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.66623, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:47:11,044 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.66623, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:47:11,045 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.66623, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:47:11,046 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.66623, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:47:12,039 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.24000000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:47:12,042 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.24000000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:47:12,043 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 98.24000000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:47:12,044 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 98.24000000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:47:12,046 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.451, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:47:12,047 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.451, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:47:12,076 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.451, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:47:12,077 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.451, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:47:14,036 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 98.238, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:47:14,037 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 98.238, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:47:14,039 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.238, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:47:14,041 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.238, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:47:14,043 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.666215, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:47:14,045 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.666215, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:47:14,046 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDCAD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.384265, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:47:14,047 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.384265, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:47:14,048 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.NZDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.59716, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:47:14,049 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.59716, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:47:14,050 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDCHF.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.79645, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:47:14,051 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.79645, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:47:14,072 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.666215, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:47:14,073 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.666215, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:47:14,075 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDCAD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.384265, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:47:14,075 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.384265, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:47:14,076 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.NZDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.59716, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:47:14,076 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.59716, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:47:14,077 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDCHF.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.79645, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:47:14,078 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.79645, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:47:16,040 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 98.237, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:47:16,041 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 98.237, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:47:16,045 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.9005, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:47:16,046 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.9005, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:47:16,049 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.9005, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:47:16,050 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.9005, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:47:16,052 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.448, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:47:16,053 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.448, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:47:16,055 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.448, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:47:16,056 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.448, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:47:16,071 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.237, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:47:16,072 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.237, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:47:17,033 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDCHF.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.79645, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:47:17,034 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.79645, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:47:17,035 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.USDCHF.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.79645, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:47:17,036 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.79645, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:47:19,624 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.EURUSD.CEEM.IP: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "ig_candles_pkey"
DETAIL:  Key (start_time, epic, timeframe)=(2025-09-12 03:00:00, CS.D.EURUSD.CEEM.IP, 60) already exists.

[SQL: INSERT INTO ig_candles (start_time, epic, timeframe, open, high, low, close, volume, ltv, cons_tick_count, data_source, created_at, updated_at, quality_score, validation_flags) VALUES (%(start_time)s, %(epic)s, %(timeframe)s, %(open)s, %(high)s, %(low)s, %(close)s, %(volume)s, %(ltv)s, %(cons_tick_count)s, %(data_source)s, %(created_at)s, %(updated_at)s, %(quality_score)s, %(validation_flags)s)]
[parameters: {'start_time': datetime.datetime(2025, 9, 12, 3, 0), 'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 60, 'open': 1.1726299999999998, 'high': 1.17271, 'low': 1.17231, 'close': 1.1725400000000001, 'volume': 0, 'ltv': 541, 'cons_tick_count': None, 'data_source': 'chart_streamer', 'created_at': datetime.datetime(2025, 9, 12, 3, 47, 19, 69720), 'updated_at': datetime.datetime(2025, 9, 12, 3, 47, 19, 69723), 'quality_score': 1.0, 'validation_flags': None}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-09-12 05:47:19,627 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "ig_candles_pkey"
DETAIL:  Key (start_time, epic, timeframe)=(2025-09-12 03:00:00, CS.D.EURUSD.CEEM.IP, 60) already exists.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 302, in _store_candle
    session.commit()
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2032, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1313, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1288, in _prepare_impl
    self.session.flush()
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4345, in flush
    self._flush(objects)
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4480, in _flush
    with util.safe_reraise():
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4441, in _flush
    flush_context.execute()
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 1048, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "ig_candles_pkey"
DETAIL:  Key (start_time, epic, timeframe)=(2025-09-12 03:00:00, CS.D.EURUSD.CEEM.IP, 60) already exists.

[SQL: INSERT INTO ig_candles (start_time, epic, timeframe, open, high, low, close, volume, ltv, cons_tick_count, data_source, created_at, updated_at, quality_score, validation_flags) VALUES (%(start_time)s, %(epic)s, %(timeframe)s, %(open)s, %(high)s, %(low)s, %(close)s, %(volume)s, %(ltv)s, %(cons_tick_count)s, %(data_source)s, %(created_at)s, %(updated_at)s, %(quality_score)s, %(validation_flags)s)]
[parameters: {'start_time': datetime.datetime(2025, 9, 12, 3, 0), 'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 60, 'open': 1.1726299999999998, 'high': 1.17271, 'low': 1.17231, 'close': 1.1725400000000001, 'volume': 0, 'ltv': 541, 'cons_tick_count': None, 'data_source': 'chart_streamer', 'created_at': datetime.datetime(2025, 9, 12, 3, 47, 19, 69720), 'updated_at': datetime.datetime(2025, 9, 12, 3, 47, 19, 69723), 'quality_score': 1.0, 'validation_flags': None}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2025-09-12 05:47:44,433 - INFO - igstream.sync_manager - 📊 Database stats: 36 candles in last 30min, latest: 2025-09-12 03:45:00
2025-09-12 05:47:50,204 - INFO - igstream.auto_backfill - Running automated gap detection and backfill...
2025-09-12 05:47:50,215 - WARNING - igstream.gap_detector - Gap detected in CS.D.GBPUSD.MINI.IP 5m: 2 candles missing from 2025-09-12 03:35:00+00:00 to 2025-09-12 03:40:00+00:00
2025-09-12 05:47:50,216 - INFO - igstream.gap_detector - Found 1 gaps for CS.D.GBPUSD.MINI.IP_5m
2025-09-12 05:47:50,230 - WARNING - igstream.gap_detector - Gap detected in CS.D.USDJPY.MINI.IP 5m: 2 candles missing from 2025-09-12 03:35:00+00:00 to 2025-09-12 03:40:00+00:00
2025-09-12 05:47:50,230 - INFO - igstream.gap_detector - Found 1 gaps for CS.D.USDJPY.MINI.IP_5m
2025-09-12 05:47:50,241 - WARNING - igstream.gap_detector - Gap detected in CS.D.AUDUSD.MINI.IP 5m: 2 candles missing from 2025-09-12 03:35:00+00:00 to 2025-09-12 03:40:00+00:00
2025-09-12 05:47:50,241 - INFO - igstream.gap_detector - Found 1 gaps for CS.D.AUDUSD.MINI.IP_5m
2025-09-12 05:47:50,249 - WARNING - igstream.gap_detector - Gap detected in CS.D.USDCAD.MINI.IP 5m: 2 candles missing from 2025-09-12 03:35:00+00:00 to 2025-09-12 03:40:00+00:00
2025-09-12 05:47:50,249 - INFO - igstream.gap_detector - Found 1 gaps for CS.D.USDCAD.MINI.IP_5m
2025-09-12 05:47:50,283 - WARNING - igstream.gap_detector - Gap detected in CS.D.EURJPY.MINI.IP 5m: 2 candles missing from 2025-09-12 03:35:00+00:00 to 2025-09-12 03:40:00+00:00
2025-09-12 05:47:50,283 - INFO - igstream.gap_detector - Found 1 gaps for CS.D.EURJPY.MINI.IP_5m
2025-09-12 05:47:50,291 - WARNING - igstream.gap_detector - Gap detected in CS.D.AUDJPY.MINI.IP 5m: 2 candles missing from 2025-09-12 03:35:00+00:00 to 2025-09-12 03:40:00+00:00
2025-09-12 05:47:50,292 - INFO - igstream.gap_detector - Found 1 gaps for CS.D.AUDJPY.MINI.IP_5m
2025-09-12 05:47:50,305 - WARNING - igstream.gap_detector - Gap detected in CS.D.NZDUSD.MINI.IP 5m: 2 candles missing from 2025-09-12 03:35:00+00:00 to 2025-09-12 03:40:00+00:00
2025-09-12 05:47:50,305 - INFO - igstream.gap_detector - Found 1 gaps for CS.D.NZDUSD.MINI.IP_5m
2025-09-12 05:47:50,315 - WARNING - igstream.gap_detector - Gap detected in CS.D.USDCHF.MINI.IP 5m: 2 candles missing from 2025-09-12 03:35:00+00:00 to 2025-09-12 03:40:00+00:00
2025-09-12 05:47:50,315 - INFO - igstream.gap_detector - Found 1 gaps for CS.D.USDCHF.MINI.IP_5m
2025-09-12 05:47:50,324 - WARNING - igstream.gap_detector - Gap detected in CS.D.EURUSD.CEEM.IP 5m: 2 candles missing from 2025-09-12 03:35:00+00:00 to 2025-09-12 03:40:00+00:00
2025-09-12 05:47:50,325 - INFO - igstream.gap_detector - Found 1 gaps for CS.D.EURUSD.CEEM.IP_5m
2025-09-12 05:47:50,327 - INFO - igstream.auto_backfill - Found 9 gaps to backfill
2025-09-12 05:47:50,328 - INFO - igstream.auto_backfill -   Gap: CS.D.GBPUSD.MINI.IP 5m at 2025-09-12 03:35:00+00:00 (2 candles)
2025-09-12 05:47:50,328 - INFO - igstream.auto_backfill -   Gap: CS.D.USDJPY.MINI.IP 5m at 2025-09-12 03:35:00+00:00 (2 candles)
2025-09-12 05:47:50,328 - INFO - igstream.auto_backfill -   Gap: CS.D.AUDUSD.MINI.IP 5m at 2025-09-12 03:35:00+00:00 (2 candles)
2025-09-12 05:47:50,328 - INFO - igstream.auto_backfill -   Gap: CS.D.USDCAD.MINI.IP 5m at 2025-09-12 03:35:00+00:00 (2 candles)
2025-09-12 05:47:50,328 - INFO - igstream.auto_backfill -   Gap: CS.D.EURJPY.MINI.IP 5m at 2025-09-12 03:35:00+00:00 (2 candles)
2025-09-12 05:47:52,329 - INFO - igstream.auto_backfill - Skipping recent gap for CS.D.GBPUSD.MINI.IP 5m (only 7.9 minutes old)
2025-09-12 05:47:54,330 - INFO - igstream.auto_backfill - Skipping recent gap for CS.D.USDJPY.MINI.IP 5m (only 7.9 minutes old)
2025-09-12 05:47:56,330 - INFO - igstream.auto_backfill - Skipping recent gap for CS.D.AUDUSD.MINI.IP 5m (only 7.9 minutes old)
2025-09-12 05:47:58,331 - INFO - igstream.auto_backfill - Skipping recent gap for CS.D.USDCAD.MINI.IP 5m (only 8.0 minutes old)
2025-09-12 05:48:00,332 - INFO - igstream.auto_backfill - Skipping recent gap for CS.D.EURJPY.MINI.IP 5m (only 8.0 minutes old)
2025-09-12 05:48:02,333 - INFO - igstream.auto_backfill - Skipping recent gap for CS.D.AUDJPY.MINI.IP 5m (only 8.0 minutes old)
2025-09-12 05:48:04,334 - INFO - igstream.auto_backfill - Skipping recent gap for CS.D.NZDUSD.MINI.IP 5m (only 8.1 minutes old)
2025-09-12 05:48:06,335 - INFO - igstream.auto_backfill - Skipping recent gap for CS.D.USDCHF.MINI.IP 5m (only 8.1 minutes old)
2025-09-12 05:48:08,337 - INFO - igstream.auto_backfill - Skipping recent gap for CS.D.EURUSD.CEEM.IP 5m (only 8.1 minutes old)
2025-09-12 05:48:08,337 - INFO - igstream.auto_backfill - Backfill run complete: 0/9 gaps filled
2025-09-12 05:48:08,338 - INFO - igstream.auto_backfill - Backfill stats: 0/9 gaps filled (0.0%), 0 candles recovered
2025-09-12 05:48:44,449 - INFO - igstream.sync_manager - 📊 Database stats: 36 candles in last 30min, latest: 2025-09-12 03:45:00
2025-09-12 05:48:44,471 - INFO - igstream.sync_manager - 🔍 Running gap detection check...
2025-09-12 05:48:44,480 - WARNING - igstream.gap_detector - Gap detected in CS.D.GBPUSD.MINI.IP 5m: 2 candles missing from 2025-09-12 03:35:00+00:00 to 2025-09-12 03:40:00+00:00
2025-09-12 05:48:44,481 - INFO - igstream.gap_detector - Found 1 gaps for CS.D.GBPUSD.MINI.IP_5m
2025-09-12 05:48:44,492 - WARNING - igstream.gap_detector - Gap detected in CS.D.USDJPY.MINI.IP 5m: 2 candles missing from 2025-09-12 03:35:00+00:00 to 2025-09-12 03:40:00+00:00
2025-09-12 05:48:44,493 - INFO - igstream.gap_detector - Found 1 gaps for CS.D.USDJPY.MINI.IP_5m
2025-09-12 05:48:44,507 - WARNING - igstream.gap_detector - Gap detected in CS.D.AUDUSD.MINI.IP 5m: 2 candles missing from 2025-09-12 03:35:00+00:00 to 2025-09-12 03:40:00+00:00
2025-09-12 05:48:44,508 - INFO - igstream.gap_detector - Found 1 gaps for CS.D.AUDUSD.MINI.IP_5m
2025-09-12 05:48:44,520 - WARNING - igstream.gap_detector - Gap detected in CS.D.USDCAD.MINI.IP 5m: 2 candles missing from 2025-09-12 03:35:00+00:00 to 2025-09-12 03:40:00+00:00
2025-09-12 05:48:44,521 - INFO - igstream.gap_detector - Found 1 gaps for CS.D.USDCAD.MINI.IP_5m
2025-09-12 05:48:44,536 - WARNING - igstream.gap_detector - Gap detected in CS.D.EURJPY.MINI.IP 5m: 2 candles missing from 2025-09-12 03:35:00+00:00 to 2025-09-12 03:40:00+00:00
2025-09-12 05:48:44,538 - INFO - igstream.gap_detector - Found 1 gaps for CS.D.EURJPY.MINI.IP_5m
2025-09-12 05:48:44,548 - WARNING - igstream.gap_detector - Gap detected in CS.D.AUDJPY.MINI.IP 5m: 2 candles missing from 2025-09-12 03:35:00+00:00 to 2025-09-12 03:40:00+00:00
2025-09-12 05:48:44,548 - INFO - igstream.gap_detector - Found 1 gaps for CS.D.AUDJPY.MINI.IP_5m
2025-09-12 05:48:44,563 - WARNING - igstream.gap_detector - Gap detected in CS.D.NZDUSD.MINI.IP 5m: 2 candles missing from 2025-09-12 03:35:00+00:00 to 2025-09-12 03:40:00+00:00
2025-09-12 05:48:44,564 - INFO - igstream.gap_detector - Found 1 gaps for CS.D.NZDUSD.MINI.IP_5m
2025-09-12 05:48:44,578 - WARNING - igstream.gap_detector - Gap detected in CS.D.USDCHF.MINI.IP 5m: 2 candles missing from 2025-09-12 03:35:00+00:00 to 2025-09-12 03:40:00+00:00
2025-09-12 05:48:44,578 - INFO - igstream.gap_detector - Found 1 gaps for CS.D.USDCHF.MINI.IP_5m
2025-09-12 05:48:44,589 - WARNING - igstream.gap_detector - Gap detected in CS.D.EURUSD.CEEM.IP 5m: 2 candles missing from 2025-09-12 03:35:00+00:00 to 2025-09-12 03:40:00+00:00
2025-09-12 05:48:44,590 - INFO - igstream.gap_detector - Found 1 gaps for CS.D.EURUSD.CEEM.IP_5m
2025-09-12 05:48:44,594 - WARNING - igstream.sync_manager - ⚠️ Gap Detection: Found 9 gaps (18 missing candles)
2025-09-12 05:48:44,595 - WARNING - igstream.sync_manager -    Recent gaps: 0, Largest gap: 10 minutes
2025-09-12 05:48:44,595 - ERROR - igstream.sync_manager - Error in gap detection check: '15m'
2025-09-12 05:49:44,600 - INFO - igstream.sync_manager - 📊 Database stats: 36 candles in last 30min, latest: 2025-09-12 03:45:00
2025-09-12 05:49:44,626 - INFO - igstream.sync_manager - 🔍 Running gap detection check...
2025-09-12 05:49:44,634 - WARNING - igstream.gap_detector - Gap detected in CS.D.GBPUSD.MINI.IP 5m: 2 candles missing from 2025-09-12 03:35:00+00:00 to 2025-09-12 03:40:00+00:00
2025-09-12 05:49:44,635 - INFO - igstream.gap_detector - Found 1 gaps for CS.D.GBPUSD.MINI.IP_5m
2025-09-12 05:49:44,647 - WARNING - igstream.gap_detector - Gap detected in CS.D.USDJPY.MINI.IP 5m: 2 candles missing from 2025-09-12 03:35:00+00:00 to 2025-09-12 03:40:00+00:00
2025-09-12 05:49:44,647 - INFO - igstream.gap_detector - Found 1 gaps for CS.D.USDJPY.MINI.IP_5m
2025-09-12 05:49:44,669 - WARNING - igstream.gap_detector - Gap detected in CS.D.AUDUSD.MINI.IP 5m: 2 candles missing from 2025-09-12 03:35:00+00:00 to 2025-09-12 03:40:00+00:00
2025-09-12 05:49:44,671 - INFO - igstream.gap_detector - Found 1 gaps for CS.D.AUDUSD.MINI.IP_5m
2025-09-12 05:49:44,685 - WARNING - igstream.gap_detector - Gap detected in CS.D.USDCAD.MINI.IP 5m: 2 candles missing from 2025-09-12 03:35:00+00:00 to 2025-09-12 03:40:00+00:00
2025-09-12 05:49:44,686 - INFO - igstream.gap_detector - Found 1 gaps for CS.D.USDCAD.MINI.IP_5m
2025-09-12 05:49:44,695 - WARNING - igstream.gap_detector - Gap detected in CS.D.EURJPY.MINI.IP 5m: 2 candles missing from 2025-09-12 03:35:00+00:00 to 2025-09-12 03:40:00+00:00
2025-09-12 05:49:44,695 - INFO - igstream.gap_detector - Found 1 gaps for CS.D.EURJPY.MINI.IP_5m
2025-09-12 05:49:44,706 - WARNING - igstream.gap_detector - Gap detected in CS.D.AUDJPY.MINI.IP 5m: 2 candles missing from 2025-09-12 03:35:00+00:00 to 2025-09-12 03:40:00+00:00
2025-09-12 05:49:44,707 - INFO - igstream.gap_detector - Found 1 gaps for CS.D.AUDJPY.MINI.IP_5m
2025-09-12 05:49:44,718 - WARNING - igstream.gap_detector - Gap detected in CS.D.NZDUSD.MINI.IP 5m: 2 candles missing from 2025-09-12 03:35:00+00:00 to 2025-09-12 03:40:00+00:00
2025-09-12 05:49:44,719 - INFO - igstream.gap_detector - Found 1 gaps for CS.D.NZDUSD.MINI.IP_5m
2025-09-12 05:49:44,735 - WARNING - igstream.gap_detector - Gap detected in CS.D.USDCHF.MINI.IP 5m: 2 candles missing from 2025-09-12 03:35:00+00:00 to 2025-09-12 03:40:00+00:00
2025-09-12 05:49:44,736 - INFO - igstream.gap_detector - Found 1 gaps for CS.D.USDCHF.MINI.IP_5m
2025-09-12 05:49:44,744 - WARNING - igstream.gap_detector - Gap detected in CS.D.EURUSD.CEEM.IP 5m: 2 candles missing from 2025-09-12 03:35:00+00:00 to 2025-09-12 03:40:00+00:00
2025-09-12 05:49:44,745 - INFO - igstream.gap_detector - Found 1 gaps for CS.D.EURUSD.CEEM.IP_5m
2025-09-12 05:49:44,747 - WARNING - igstream.sync_manager - ⚠️ Gap Detection: Found 9 gaps (18 missing candles)
2025-09-12 05:49:44,747 - WARNING - igstream.sync_manager -    Recent gaps: 0, Largest gap: 10 minutes
2025-09-12 05:49:44,747 - ERROR - igstream.sync_manager - Error in gap detection check: '15m'
2025-09-12 05:50:01,057 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 03:50:00 for CS.D.AUDJPY.MINI.IP - MID OHLC: 98.22800/98.22800/98.22800/98.22800 (Quality: 1.00)
2025-09-12 05:50:01,065 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 03:50:00 for CS.D.AUDUSD.MINI.IP - MID OHLC: 0.66615/0.66615/0.66615/0.66615 (Quality: 1.00)
2025-09-12 05:50:01,084 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 03:50:00 for CS.D.GBPUSD.MINI.IP - MID OHLC: 1.35562/1.35562/1.35562/1.35562 (Quality: 1.00)
2025-09-12 05:50:01,096 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 03:50:00 for CS.D.EURJPY.MINI.IP - MID OHLC: 172.90650/172.90650/172.90550/172.90550 (Quality: 1.00)
2025-09-12 05:50:01,120 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 03:50:00 for CS.D.USDJPY.MINI.IP - MID OHLC: 147.44900/147.44900/147.44800/147.44800 (Quality: 1.00)
2025-09-12 05:50:02,073 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 03:50:00 for CS.D.NZDUSD.MINI.IP - MID OHLC: 0.59716/0.59716/0.59716/0.59716 (Quality: 1.00)
2025-09-12 05:50:06,047 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 03:50:00 for CS.D.USDCHF.MINI.IP - MID OHLC: 0.79646/0.79646/0.79646/0.79646 (Quality: 1.00)
2025-09-12 05:50:07,055 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 03:50:00 for CS.D.EURUSD.CEEM.IP - MID OHLC: 1.17257/1.17257/1.17257/1.17257 (Quality: 1.00)
2025-09-12 05:50:25,078 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 03:50:00 for CS.D.USDCAD.MINI.IP - MID OHLC: 1.38434/1.38434/1.38434/1.38434 (Quality: 1.00)
2025-09-12 05:50:44,752 - INFO - igstream.sync_manager - 📊 Database stats: 36 candles in last 30min, latest: 2025-09-12 03:50:00
2025-09-12 05:50:44,778 - INFO - igstream.sync_manager - 🔍 Running gap detection check...
2025-09-12 05:50:44,847 - WARNING - igstream.gap_detector - Gap detected in CS.D.GBPUSD.MINI.IP 5m: 2 candles missing from 2025-09-12 03:35:00+00:00 to 2025-09-12 03:40:00+00:00
2025-09-12 05:50:44,848 - INFO - igstream.gap_detector - Found 1 gaps for CS.D.GBPUSD.MINI.IP_5m
2025-09-12 05:50:44,860 - WARNING - igstream.gap_detector - Gap detected in CS.D.USDJPY.MINI.IP 5m: 2 candles missing from 2025-09-12 03:35:00+00:00 to 2025-09-12 03:40:00+00:00
2025-09-12 05:50:44,861 - INFO - igstream.gap_detector - Found 1 gaps for CS.D.USDJPY.MINI.IP_5m
2025-09-12 05:50:44,870 - WARNING - igstream.gap_detector - Gap detected in CS.D.AUDUSD.MINI.IP 5m: 2 candles missing from 2025-09-12 03:35:00+00:00 to 2025-09-12 03:40:00+00:00
2025-09-12 05:50:44,870 - INFO - igstream.gap_detector - Found 1 gaps for CS.D.AUDUSD.MINI.IP_5m
2025-09-12 05:50:44,895 - WARNING - igstream.gap_detector - Gap detected in CS.D.USDCAD.MINI.IP 5m: 2 candles missing from 2025-09-12 03:35:00+00:00 to 2025-09-12 03:40:00+00:00
2025-09-12 05:50:44,897 - INFO - igstream.gap_detector - Found 1 gaps for CS.D.USDCAD.MINI.IP_5m
2025-09-12 05:50:44,911 - WARNING - igstream.gap_detector - Gap detected in CS.D.EURJPY.MINI.IP 5m: 2 candles missing from 2025-09-12 03:35:00+00:00 to 2025-09-12 03:40:00+00:00
2025-09-12 05:50:44,911 - INFO - igstream.gap_detector - Found 1 gaps for CS.D.EURJPY.MINI.IP_5m
2025-09-12 05:50:44,926 - WARNING - igstream.gap_detector - Gap detected in CS.D.AUDJPY.MINI.IP 5m: 2 candles missing from 2025-09-12 03:35:00+00:00 to 2025-09-12 03:40:00+00:00
2025-09-12 05:50:44,927 - INFO - igstream.gap_detector - Found 1 gaps for CS.D.AUDJPY.MINI.IP_5m
2025-09-12 05:50:44,941 - WARNING - igstream.gap_detector - Gap detected in CS.D.NZDUSD.MINI.IP 5m: 2 candles missing from 2025-09-12 03:35:00+00:00 to 2025-09-12 03:40:00+00:00
2025-09-12 05:50:44,943 - INFO - igstream.gap_detector - Found 1 gaps for CS.D.NZDUSD.MINI.IP_5m
2025-09-12 05:50:44,951 - WARNING - igstream.gap_detector - Gap detected in CS.D.USDCHF.MINI.IP 5m: 2 candles missing from 2025-09-12 03:35:00+00:00 to 2025-09-12 03:40:00+00:00
2025-09-12 05:50:44,952 - INFO - igstream.gap_detector - Found 1 gaps for CS.D.USDCHF.MINI.IP_5m
2025-09-12 05:50:44,965 - WARNING - igstream.gap_detector - Gap detected in CS.D.EURUSD.CEEM.IP 5m: 2 candles missing from 2025-09-12 03:35:00+00:00 to 2025-09-12 03:40:00+00:00
2025-09-12 05:50:44,966 - INFO - igstream.gap_detector - Found 1 gaps for CS.D.EURUSD.CEEM.IP_5m
2025-09-12 05:50:44,970 - WARNING - igstream.sync_manager - ⚠️ Gap Detection: Found 9 gaps (18 missing candles)
2025-09-12 05:50:44,970 - WARNING - igstream.sync_manager -    Recent gaps: 0, Largest gap: 10 minutes
2025-09-12 05:50:44,970 - ERROR - igstream.sync_manager - Error in gap detection check: '15m'
2025-09-12 05:51:44,976 - INFO - igstream.sync_manager - 📊 Database stats: 36 candles in last 30min, latest: 2025-09-12 03:50:00
2025-09-12 05:51:45,001 - INFO - igstream.sync_manager - 🔍 Running gap detection check...
2025-09-12 05:51:45,011 - WARNING - igstream.gap_detector - Gap detected in CS.D.GBPUSD.MINI.IP 5m: 2 candles missing from 2025-09-12 03:35:00+00:00 to 2025-09-12 03:40:00+00:00
2025-09-12 05:51:45,012 - INFO - igstream.gap_detector - Found 1 gaps for CS.D.GBPUSD.MINI.IP_5m
2025-09-12 05:51:45,036 - WARNING - igstream.gap_detector - Gap detected in CS.D.USDJPY.MINI.IP 5m: 2 candles missing from 2025-09-12 03:35:00+00:00 to 2025-09-12 03:40:00+00:00
2025-09-12 05:51:45,039 - INFO - igstream.gap_detector - Found 1 gaps for CS.D.USDJPY.MINI.IP_5m
2025-09-12 05:51:45,060 - WARNING - igstream.gap_detector - Gap detected in CS.D.AUDUSD.MINI.IP 5m: 2 candles missing from 2025-09-12 03:35:00+00:00 to 2025-09-12 03:40:00+00:00
2025-09-12 05:51:45,061 - INFO - igstream.gap_detector - Found 1 gaps for CS.D.AUDUSD.MINI.IP_5m
2025-09-12 05:51:45,074 - WARNING - igstream.gap_detector - Gap detected in CS.D.USDCAD.MINI.IP 5m: 2 candles missing from 2025-09-12 03:35:00+00:00 to 2025-09-12 03:40:00+00:00
2025-09-12 05:51:45,075 - INFO - igstream.gap_detector - Found 1 gaps for CS.D.USDCAD.MINI.IP_5m
2025-09-12 05:51:45,087 - WARNING - igstream.gap_detector - Gap detected in CS.D.EURJPY.MINI.IP 5m: 2 candles missing from 2025-09-12 03:35:00+00:00 to 2025-09-12 03:40:00+00:00
2025-09-12 05:51:45,087 - INFO - igstream.gap_detector - Found 1 gaps for CS.D.EURJPY.MINI.IP_5m
2025-09-12 05:51:45,098 - WARNING - igstream.gap_detector - Gap detected in CS.D.AUDJPY.MINI.IP 5m: 2 candles missing from 2025-09-12 03:35:00+00:00 to 2025-09-12 03:40:00+00:00
2025-09-12 05:51:45,099 - INFO - igstream.gap_detector - Found 1 gaps for CS.D.AUDJPY.MINI.IP_5m
2025-09-12 05:51:45,110 - WARNING - igstream.gap_detector - Gap detected in CS.D.NZDUSD.MINI.IP 5m: 2 candles missing from 2025-09-12 03:35:00+00:00 to 2025-09-12 03:40:00+00:00
2025-09-12 05:51:45,110 - INFO - igstream.gap_detector - Found 1 gaps for CS.D.NZDUSD.MINI.IP_5m
2025-09-12 05:51:45,121 - WARNING - igstream.gap_detector - Gap detected in CS.D.USDCHF.MINI.IP 5m: 2 candles missing from 2025-09-12 03:35:00+00:00 to 2025-09-12 03:40:00+00:00
2025-09-12 05:51:45,121 - INFO - igstream.gap_detector - Found 1 gaps for CS.D.USDCHF.MINI.IP_5m
2025-09-12 05:51:45,133 - WARNING - igstream.gap_detector - Gap detected in CS.D.EURUSD.CEEM.IP 5m: 2 candles missing from 2025-09-12 03:35:00+00:00 to 2025-09-12 03:40:00+00:00
2025-09-12 05:51:45,133 - INFO - igstream.gap_detector - Found 1 gaps for CS.D.EURUSD.CEEM.IP_5m
2025-09-12 05:51:45,136 - WARNING - igstream.sync_manager - ⚠️ Gap Detection: Found 9 gaps (18 missing candles)
2025-09-12 05:51:45,136 - WARNING - igstream.sync_manager -    Recent gaps: 0, Largest gap: 10 minutes
2025-09-12 05:51:45,137 - ERROR - igstream.sync_manager - Error in gap detection check: '15m'
2025-09-12 05:52:45,143 - INFO - igstream.sync_manager - 📊 Database stats: 36 candles in last 30min, latest: 2025-09-12 03:50:00
2025-09-12 05:52:45,167 - INFO - igstream.sync_manager - 🔍 Running gap detection check...
2025-09-12 05:52:45,178 - WARNING - igstream.gap_detector - Gap detected in CS.D.GBPUSD.MINI.IP 5m: 2 candles missing from 2025-09-12 03:35:00+00:00 to 2025-09-12 03:40:00+00:00
2025-09-12 05:52:45,178 - INFO - igstream.gap_detector - Found 1 gaps for CS.D.GBPUSD.MINI.IP_5m
2025-09-12 05:52:45,189 - WARNING - igstream.gap_detector - Gap detected in CS.D.USDJPY.MINI.IP 5m: 2 candles missing from 2025-09-12 03:35:00+00:00 to 2025-09-12 03:40:00+00:00
2025-09-12 05:52:45,190 - INFO - igstream.gap_detector - Found 1 gaps for CS.D.USDJPY.MINI.IP_5m
2025-09-12 05:52:45,210 - WARNING - igstream.gap_detector - Gap detected in CS.D.AUDUSD.MINI.IP 5m: 2 candles missing from 2025-09-12 03:35:00+00:00 to 2025-09-12 03:40:00+00:00
2025-09-12 05:52:45,212 - INFO - igstream.gap_detector - Found 1 gaps for CS.D.AUDUSD.MINI.IP_5m
2025-09-12 05:52:45,231 - WARNING - igstream.gap_detector - Gap detected in CS.D.USDCAD.MINI.IP 5m: 2 candles missing from 2025-09-12 03:35:00+00:00 to 2025-09-12 03:40:00+00:00
2025-09-12 05:52:45,232 - INFO - igstream.gap_detector - Found 1 gaps for CS.D.USDCAD.MINI.IP_5m
2025-09-12 05:52:45,245 - WARNING - igstream.gap_detector - Gap detected in CS.D.EURJPY.MINI.IP 5m: 2 candles missing from 2025-09-12 03:35:00+00:00 to 2025-09-12 03:40:00+00:00
2025-09-12 05:52:45,246 - INFO - igstream.gap_detector - Found 1 gaps for CS.D.EURJPY.MINI.IP_5m
2025-09-12 05:52:45,261 - WARNING - igstream.gap_detector - Gap detected in CS.D.AUDJPY.MINI.IP 5m: 2 candles missing from 2025-09-12 03:35:00+00:00 to 2025-09-12 03:40:00+00:00
2025-09-12 05:52:45,261 - INFO - igstream.gap_detector - Found 1 gaps for CS.D.AUDJPY.MINI.IP_5m
2025-09-12 05:52:45,274 - WARNING - igstream.gap_detector - Gap detected in CS.D.NZDUSD.MINI.IP 5m: 2 candles missing from 2025-09-12 03:35:00+00:00 to 2025-09-12 03:40:00+00:00
2025-09-12 05:52:45,275 - INFO - igstream.gap_detector - Found 1 gaps for CS.D.NZDUSD.MINI.IP_5m
2025-09-12 05:52:45,289 - WARNING - igstream.gap_detector - Gap detected in CS.D.USDCHF.MINI.IP 5m: 2 candles missing from 2025-09-12 03:35:00+00:00 to 2025-09-12 03:40:00+00:00
2025-09-12 05:52:45,290 - INFO - igstream.gap_detector - Found 1 gaps for CS.D.USDCHF.MINI.IP_5m
2025-09-12 05:52:45,303 - WARNING - igstream.gap_detector - Gap detected in CS.D.EURUSD.CEEM.IP 5m: 2 candles missing from 2025-09-12 03:35:00+00:00 to 2025-09-12 03:40:00+00:00
2025-09-12 05:52:45,304 - INFO - igstream.gap_detector - Found 1 gaps for CS.D.EURUSD.CEEM.IP_5m
2025-09-12 05:52:45,307 - WARNING - igstream.sync_manager - ⚠️ Gap Detection: Found 9 gaps (18 missing candles)
2025-09-12 05:52:45,307 - WARNING - igstream.sync_manager -    Recent gaps: 0, Largest gap: 10 minutes
2025-09-12 05:52:45,307 - ERROR - igstream.sync_manager - Error in gap detection check: '15m'
2025-09-12 05:53:08,339 - INFO - igstream.auto_backfill - Running automated gap detection and backfill...
2025-09-12 05:53:08,347 - WARNING - igstream.gap_detector - Gap detected in CS.D.GBPUSD.MINI.IP 5m: 2 candles missing from 2025-09-12 03:35:00+00:00 to 2025-09-12 03:40:00+00:00
2025-09-12 05:53:08,348 - INFO - igstream.gap_detector - Found 1 gaps for CS.D.GBPUSD.MINI.IP_5m
2025-09-12 05:53:08,359 - WARNING - igstream.gap_detector - Gap detected in CS.D.USDJPY.MINI.IP 5m: 2 candles missing from 2025-09-12 03:35:00+00:00 to 2025-09-12 03:40:00+00:00
2025-09-12 05:53:08,360 - INFO - igstream.gap_detector - Found 1 gaps for CS.D.USDJPY.MINI.IP_5m
2025-09-12 05:53:08,371 - WARNING - igstream.gap_detector - Gap detected in CS.D.AUDUSD.MINI.IP 5m: 2 candles missing from 2025-09-12 03:35:00+00:00 to 2025-09-12 03:40:00+00:00
2025-09-12 05:53:08,372 - INFO - igstream.gap_detector - Found 1 gaps for CS.D.AUDUSD.MINI.IP_5m
2025-09-12 05:53:08,381 - WARNING - igstream.gap_detector - Gap detected in CS.D.USDCAD.MINI.IP 5m: 2 candles missing from 2025-09-12 03:35:00+00:00 to 2025-09-12 03:40:00+00:00
2025-09-12 05:53:08,382 - INFO - igstream.gap_detector - Found 1 gaps for CS.D.USDCAD.MINI.IP_5m
2025-09-12 05:53:08,390 - WARNING - igstream.gap_detector - Gap detected in CS.D.EURJPY.MINI.IP 5m: 2 candles missing from 2025-09-12 03:35:00+00:00 to 2025-09-12 03:40:00+00:00
2025-09-12 05:53:08,391 - INFO - igstream.gap_detector - Found 1 gaps for CS.D.EURJPY.MINI.IP_5m
2025-09-12 05:53:08,402 - WARNING - igstream.gap_detector - Gap detected in CS.D.AUDJPY.MINI.IP 5m: 2 candles missing from 2025-09-12 03:35:00+00:00 to 2025-09-12 03:40:00+00:00
2025-09-12 05:53:08,403 - INFO - igstream.gap_detector - Found 1 gaps for CS.D.AUDJPY.MINI.IP_5m
2025-09-12 05:53:08,414 - WARNING - igstream.gap_detector - Gap detected in CS.D.NZDUSD.MINI.IP 5m: 2 candles missing from 2025-09-12 03:35:00+00:00 to 2025-09-12 03:40:00+00:00
2025-09-12 05:53:08,414 - INFO - igstream.gap_detector - Found 1 gaps for CS.D.NZDUSD.MINI.IP_5m
2025-09-12 05:53:08,423 - WARNING - igstream.gap_detector - Gap detected in CS.D.USDCHF.MINI.IP 5m: 2 candles missing from 2025-09-12 03:35:00+00:00 to 2025-09-12 03:40:00+00:00
2025-09-12 05:53:08,425 - INFO - igstream.gap_detector - Found 1 gaps for CS.D.USDCHF.MINI.IP_5m
2025-09-12 05:53:08,479 - WARNING - igstream.gap_detector - Gap detected in CS.D.EURUSD.CEEM.IP 5m: 2 candles missing from 2025-09-12 03:35:00+00:00 to 2025-09-12 03:40:00+00:00
2025-09-12 05:53:08,480 - INFO - igstream.gap_detector - Found 1 gaps for CS.D.EURUSD.CEEM.IP_5m
2025-09-12 05:53:08,483 - INFO - igstream.auto_backfill - Found 9 gaps to backfill
2025-09-12 05:53:08,483 - INFO - igstream.auto_backfill -   Gap: CS.D.GBPUSD.MINI.IP 5m at 2025-09-12 03:35:00+00:00 (2 candles)
2025-09-12 05:53:08,483 - INFO - igstream.auto_backfill -   Gap: CS.D.USDJPY.MINI.IP 5m at 2025-09-12 03:35:00+00:00 (2 candles)
2025-09-12 05:53:08,483 - INFO - igstream.auto_backfill -   Gap: CS.D.AUDUSD.MINI.IP 5m at 2025-09-12 03:35:00+00:00 (2 candles)
2025-09-12 05:53:08,483 - INFO - igstream.auto_backfill -   Gap: CS.D.USDCAD.MINI.IP 5m at 2025-09-12 03:35:00+00:00 (2 candles)
2025-09-12 05:53:08,483 - INFO - igstream.auto_backfill -   Gap: CS.D.EURJPY.MINI.IP 5m at 2025-09-12 03:35:00+00:00 (2 candles)
2025-09-12 05:53:10,485 - INFO - igstream.auto_backfill - Backfilling gap for CS.D.GBPUSD.MINI.IP 5m: 2025-09-12 03:35:00+00:00 to 2025-09-12 03:40:00+00:00 (2 candles)
2025-09-12 05:53:10,662 - INFO - httpx - HTTP Request: GET https://api.ig.com/gateway/deal/prices/CS.D.GBPUSD.MINI.IP?resolution=MINUTE_5&from=2025-09-12T03%3A30%3A00&to=2025-09-12T03%3A45%3A00&max=4 "HTTP/1.1 200 OK"
2025-09-12 05:53:10,676 - INFO - igstream.auto_backfill - Successfully backfilled 2 candles for CS.D.GBPUSD.MINI.IP 5m
2025-09-12 05:53:12,678 - INFO - igstream.auto_backfill - Backfilling gap for CS.D.USDJPY.MINI.IP 5m: 2025-09-12 03:35:00+00:00 to 2025-09-12 03:40:00+00:00 (2 candles)
2025-09-12 05:53:12,799 - INFO - httpx - HTTP Request: GET https://api.ig.com/gateway/deal/prices/CS.D.USDJPY.MINI.IP?resolution=MINUTE_5&from=2025-09-12T03%3A30%3A00&to=2025-09-12T03%3A45%3A00&max=4 "HTTP/1.1 200 OK"
2025-09-12 05:53:12,807 - INFO - igstream.auto_backfill - Successfully backfilled 2 candles for CS.D.USDJPY.MINI.IP 5m
2025-09-12 05:53:14,809 - INFO - igstream.auto_backfill - Backfilling gap for CS.D.AUDUSD.MINI.IP 5m: 2025-09-12 03:35:00+00:00 to 2025-09-12 03:40:00+00:00 (2 candles)
2025-09-12 05:53:14,927 - INFO - httpx - HTTP Request: GET https://api.ig.com/gateway/deal/prices/CS.D.AUDUSD.MINI.IP?resolution=MINUTE_5&from=2025-09-12T03%3A30%3A00&to=2025-09-12T03%3A45%3A00&max=4 "HTTP/1.1 200 OK"
2025-09-12 05:53:14,935 - INFO - igstream.auto_backfill - Successfully backfilled 2 candles for CS.D.AUDUSD.MINI.IP 5m
2025-09-12 05:53:16,937 - INFO - igstream.auto_backfill - Backfilling gap for CS.D.USDCAD.MINI.IP 5m: 2025-09-12 03:35:00+00:00 to 2025-09-12 03:40:00+00:00 (2 candles)
2025-09-12 05:53:17,092 - INFO - httpx - HTTP Request: GET https://api.ig.com/gateway/deal/prices/CS.D.USDCAD.MINI.IP?resolution=MINUTE_5&from=2025-09-12T03%3A30%3A00&to=2025-09-12T03%3A45%3A00&max=4 "HTTP/1.1 200 OK"
2025-09-12 05:53:17,100 - INFO - igstream.auto_backfill - Successfully backfilled 2 candles for CS.D.USDCAD.MINI.IP 5m
2025-09-12 05:53:19,101 - INFO - igstream.auto_backfill - Backfilling gap for CS.D.EURJPY.MINI.IP 5m: 2025-09-12 03:35:00+00:00 to 2025-09-12 03:40:00+00:00 (2 candles)
2025-09-12 05:53:19,238 - INFO - httpx - HTTP Request: GET https://api.ig.com/gateway/deal/prices/CS.D.EURJPY.MINI.IP?resolution=MINUTE_5&from=2025-09-12T03%3A30%3A00&to=2025-09-12T03%3A45%3A00&max=4 "HTTP/1.1 200 OK"
2025-09-12 05:53:19,250 - INFO - igstream.auto_backfill - Successfully backfilled 2 candles for CS.D.EURJPY.MINI.IP 5m
2025-09-12 05:53:21,252 - INFO - igstream.auto_backfill - Backfilling gap for CS.D.AUDJPY.MINI.IP 5m: 2025-09-12 03:35:00+00:00 to 2025-09-12 03:40:00+00:00 (2 candles)
2025-09-12 05:53:21,387 - INFO - httpx - HTTP Request: GET https://api.ig.com/gateway/deal/prices/CS.D.AUDJPY.MINI.IP?resolution=MINUTE_5&from=2025-09-12T03%3A30%3A00&to=2025-09-12T03%3A45%3A00&max=4 "HTTP/1.1 200 OK"
2025-09-12 05:53:21,397 - INFO - igstream.auto_backfill - Successfully backfilled 2 candles for CS.D.AUDJPY.MINI.IP 5m
2025-09-12 05:53:23,399 - INFO - igstream.auto_backfill - Backfilling gap for CS.D.NZDUSD.MINI.IP 5m: 2025-09-12 03:35:00+00:00 to 2025-09-12 03:40:00+00:00 (2 candles)
2025-09-12 05:53:23,532 - INFO - httpx - HTTP Request: GET https://api.ig.com/gateway/deal/prices/CS.D.NZDUSD.MINI.IP?resolution=MINUTE_5&from=2025-09-12T03%3A30%3A00&to=2025-09-12T03%3A45%3A00&max=4 "HTTP/1.1 200 OK"
2025-09-12 05:53:23,540 - INFO - igstream.auto_backfill - Successfully backfilled 2 candles for CS.D.NZDUSD.MINI.IP 5m
2025-09-12 05:53:25,542 - INFO - igstream.auto_backfill - Backfilling gap for CS.D.USDCHF.MINI.IP 5m: 2025-09-12 03:35:00+00:00 to 2025-09-12 03:40:00+00:00 (2 candles)
2025-09-12 05:53:25,654 - INFO - httpx - HTTP Request: GET https://api.ig.com/gateway/deal/prices/CS.D.USDCHF.MINI.IP?resolution=MINUTE_5&from=2025-09-12T03%3A30%3A00&to=2025-09-12T03%3A45%3A00&max=4 "HTTP/1.1 200 OK"
2025-09-12 05:53:25,662 - INFO - igstream.auto_backfill - Successfully backfilled 2 candles for CS.D.USDCHF.MINI.IP 5m
2025-09-12 05:53:27,664 - INFO - igstream.auto_backfill - Backfilling gap for CS.D.EURUSD.CEEM.IP 5m: 2025-09-12 03:35:00+00:00 to 2025-09-12 03:40:00+00:00 (2 candles)
2025-09-12 05:53:27,784 - INFO - httpx - HTTP Request: GET https://api.ig.com/gateway/deal/prices/CS.D.EURUSD.CEEM.IP?resolution=MINUTE_5&from=2025-09-12T03%3A30%3A00&to=2025-09-12T03%3A45%3A00&max=4 "HTTP/1.1 200 OK"
2025-09-12 05:53:27,790 - INFO - igstream.auto_backfill - Successfully backfilled 2 candles for CS.D.EURUSD.CEEM.IP 5m
2025-09-12 05:53:27,790 - INFO - igstream.auto_backfill - Backfill run complete: 9/9 gaps filled
2025-09-12 05:53:27,790 - INFO - igstream.auto_backfill - Backfill stats: 9/9 gaps filled (100.0%), 18 candles recovered
2025-09-12 05:53:45,315 - INFO - igstream.sync_manager - 📊 Database stats: 54 candles in last 30min, latest: 2025-09-12 03:50:00
2025-09-12 05:53:45,345 - INFO - igstream.sync_manager - 🔍 Running gap detection check...
2025-09-12 05:53:45,470 - INFO - igstream.sync_manager - ✅ No gaps detected in candle data
2025-09-12 05:54:45,476 - INFO - igstream.sync_manager - 📊 Database stats: 54 candles in last 30min, latest: 2025-09-12 03:50:00
2025-09-12 05:55:01,076 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 03:55:00 for CS.D.AUDJPY.MINI.IP - MID OHLC: 98.21500/98.21500/98.21400/98.21400 (Quality: 1.00)
2025-09-12 05:55:02,048 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 03:55:00 for CS.D.EURUSD.CEEM.IP - MID OHLC: 1.17251/1.17251/1.17251/1.17251 (Quality: 1.00)
2025-09-12 05:55:03,076 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 03:55:00 for CS.D.AUDUSD.MINI.IP - MID OHLC: 0.66604/0.66604/0.66604/0.66604 (Quality: 1.00)
2025-09-12 05:55:03,083 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 03:55:00 for CS.D.EURJPY.MINI.IP - MID OHLC: 172.90250/172.90250/172.89950/172.89950 (Quality: 1.00)
2025-09-12 05:55:03,086 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 03:55:00 for CS.D.USDCAD.MINI.IP - MID OHLC: 1.38438/1.38438/1.38438/1.38438 (Quality: 1.00)
2025-09-12 05:55:03,090 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 03:55:00 for CS.D.NZDUSD.MINI.IP - MID OHLC: 0.59703/0.59704/0.59703/0.59704 (Quality: 1.00)
2025-09-12 05:55:04,079 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 03:55:00 for CS.D.USDCHF.MINI.IP - MID OHLC: 0.79649/0.79651/0.79649/0.79651 (Quality: 1.00)
2025-09-12 05:55:04,085 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 03:55:00 for CS.D.USDJPY.MINI.IP - MID OHLC: 147.44900/147.45300/147.44900/147.45300 (Quality: 1.00)
2025-09-12 05:55:04,110 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 03:55:00 for CS.D.GBPUSD.MINI.IP - MID OHLC: 1.35547/1.35547/1.35547/1.35547 (Quality: 1.00)
2025-09-12 05:55:45,507 - INFO - igstream.sync_manager - 📊 Database stats: 54 candles in last 30min, latest: 2025-09-12 03:55:00
2025-09-12 05:56:45,535 - INFO - igstream.sync_manager - 📊 Database stats: 54 candles in last 30min, latest: 2025-09-12 03:55:00
2025-09-12 05:57:45,551 - INFO - igstream.sync_manager - 📊 Database stats: 54 candles in last 30min, latest: 2025-09-12 03:55:00
2025-09-12 05:58:27,791 - INFO - igstream.auto_backfill - Running automated gap detection and backfill...
2025-09-12 05:58:27,896 - INFO - igstream.auto_backfill - Backfill stats: 9/9 gaps filled (100.0%), 18 candles recovered
2025-09-12 05:58:45,576 - INFO - igstream.sync_manager - 📊 Database stats: 54 candles in last 30min, latest: 2025-09-12 03:55:00
2025-09-12 05:58:45,596 - INFO - igstream.sync_manager - 🔍 Running gap detection check...
2025-09-12 05:58:45,675 - INFO - igstream.sync_manager - ✅ No gaps detected in candle data
2025-09-12 05:59:45,679 - INFO - igstream.sync_manager - 📊 Database stats: 54 candles in last 30min, latest: 2025-09-12 03:55:00
2025-09-12 06:00:00,986 - INFO - httpx - HTTP Request: GET https://api.ig.com/gateway/deal/prices/CS.D.USDCAD.MINI.IP?resolution=MINUTE_5&from=2025-09-12T03%3A50%3A00&to=2025-09-12T03%3A55%3A00&max=2 "HTTP/1.1 404 Not Found"
2025-09-12 06:00:00,988 - ERROR - igstream.stream_validator - ❌ API validation error for CS.D.USDCAD.MINI.IP: Client error '404 Not Found' for url 'https://api.ig.com/gateway/deal/prices/CS.D.USDCAD.MINI.IP?resolution=MINUTE_5&from=2025-09-12T03%3A50%3A00&to=2025-09-12T03%3A55%3A00&max=2'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404
2025-09-12 06:00:00,995 - INFO - httpx - HTTP Request: GET https://api.ig.com/gateway/deal/prices/CS.D.GBPUSD.MINI.IP?resolution=MINUTE_5&from=2025-09-12T03%3A50%3A00&to=2025-09-12T03%3A55%3A00&max=2 "HTTP/1.1 404 Not Found"
2025-09-12 06:00:00,996 - INFO - httpx - HTTP Request: GET https://api.ig.com/gateway/deal/prices/CS.D.EURUSD.CEEM.IP?resolution=MINUTE_5&from=2025-09-12T03%3A50%3A00&to=2025-09-12T03%3A55%3A00&max=2 "HTTP/1.1 404 Not Found"
2025-09-12 06:00:00,997 - INFO - httpx - HTTP Request: GET https://api.ig.com/gateway/deal/prices/CS.D.AUDJPY.MINI.IP?resolution=MINUTE_5&from=2025-09-12T03%3A50%3A00&to=2025-09-12T03%3A55%3A00&max=2 "HTTP/1.1 404 Not Found"
2025-09-12 06:00:00,997 - INFO - httpx - HTTP Request: GET https://api.ig.com/gateway/deal/prices/CS.D.AUDUSD.MINI.IP?resolution=MINUTE_5&from=2025-09-12T03%3A50%3A00&to=2025-09-12T03%3A55%3A00&max=2 "HTTP/1.1 404 Not Found"
2025-09-12 06:00:00,998 - ERROR - igstream.stream_validator - ❌ API validation error for CS.D.GBPUSD.MINI.IP: Client error '404 Not Found' for url 'https://api.ig.com/gateway/deal/prices/CS.D.GBPUSD.MINI.IP?resolution=MINUTE_5&from=2025-09-12T03%3A50%3A00&to=2025-09-12T03%3A55%3A00&max=2'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404
2025-09-12 06:00:01,001 - ERROR - igstream.stream_validator - ❌ API validation error for CS.D.EURUSD.CEEM.IP: Client error '404 Not Found' for url 'https://api.ig.com/gateway/deal/prices/CS.D.EURUSD.CEEM.IP?resolution=MINUTE_5&from=2025-09-12T03%3A50%3A00&to=2025-09-12T03%3A55%3A00&max=2'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404
2025-09-12 06:00:01,004 - ERROR - igstream.stream_validator - ❌ API validation error for CS.D.AUDJPY.MINI.IP: Client error '404 Not Found' for url 'https://api.ig.com/gateway/deal/prices/CS.D.AUDJPY.MINI.IP?resolution=MINUTE_5&from=2025-09-12T03%3A50%3A00&to=2025-09-12T03%3A55%3A00&max=2'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404
2025-09-12 06:00:01,007 - ERROR - igstream.stream_validator - ❌ API validation error for CS.D.AUDUSD.MINI.IP: Client error '404 Not Found' for url 'https://api.ig.com/gateway/deal/prices/CS.D.AUDUSD.MINI.IP?resolution=MINUTE_5&from=2025-09-12T03%3A50%3A00&to=2025-09-12T03%3A55%3A00&max=2'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404
2025-09-12 06:00:01,010 - INFO - httpx - HTTP Request: GET https://api.ig.com/gateway/deal/prices/CS.D.USDJPY.MINI.IP?resolution=MINUTE_5&from=2025-09-12T03%3A50%3A00&to=2025-09-12T03%3A55%3A00&max=2 "HTTP/1.1 404 Not Found"
2025-09-12 06:00:01,011 - ERROR - igstream.stream_validator - ❌ API validation error for CS.D.USDJPY.MINI.IP: Client error '404 Not Found' for url 'https://api.ig.com/gateway/deal/prices/CS.D.USDJPY.MINI.IP?resolution=MINUTE_5&from=2025-09-12T03%3A50%3A00&to=2025-09-12T03%3A55%3A00&max=2'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404
2025-09-12 06:00:01,040 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 04:00:00 for CS.D.AUDJPY.MINI.IP - MID OHLC: 98.23300/98.23400/98.23300/98.23300 (Quality: 1.00)
2025-09-12 06:00:01,048 - INFO - igstream.chart_streamer - 🟢 🆕 60m candle completed at 2025-09-12 04:00:00 for CS.D.EURJPY.MINI.IP - MID OHLC: 172.90550/172.90650/172.90450/172.90650 (Quality: 1.00)
2025-09-12 06:00:01,049 - INFO - httpx - HTTP Request: GET https://api.ig.com/gateway/deal/prices/CS.D.EURJPY.MINI.IP?resolution=MINUTE_5&from=2025-09-12T03%3A50%3A00&to=2025-09-12T03%3A55%3A00&max=2 "HTTP/1.1 404 Not Found"
2025-09-12 06:00:01,050 - ERROR - igstream.stream_validator - ❌ API validation error for CS.D.EURJPY.MINI.IP: Client error '404 Not Found' for url 'https://api.ig.com/gateway/deal/prices/CS.D.EURJPY.MINI.IP?resolution=MINUTE_5&from=2025-09-12T03%3A50%3A00&to=2025-09-12T03%3A55%3A00&max=2'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404
2025-09-12 06:00:01,064 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 04:00:00 for CS.D.GBPUSD.MINI.IP - MID OHLC: 1.35555/1.35555/1.35555/1.35555 (Quality: 1.00)
2025-09-12 06:00:01,067 - INFO - httpx - HTTP Request: GET https://api.ig.com/gateway/deal/prices/CS.D.USDCHF.MINI.IP?resolution=MINUTE_5&from=2025-09-12T03%3A50%3A00&to=2025-09-12T03%3A55%3A00&max=2 "HTTP/1.1 404 Not Found"
2025-09-12 06:00:01,068 - ERROR - igstream.stream_validator - ❌ API validation error for CS.D.USDCHF.MINI.IP: Client error '404 Not Found' for url 'https://api.ig.com/gateway/deal/prices/CS.D.USDCHF.MINI.IP?resolution=MINUTE_5&from=2025-09-12T03%3A50%3A00&to=2025-09-12T03%3A55%3A00&max=2'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404
2025-09-12 06:00:01,072 - INFO - httpx - HTTP Request: GET https://api.ig.com/gateway/deal/prices/CS.D.NZDUSD.MINI.IP?resolution=MINUTE_5&from=2025-09-12T03%3A50%3A00&to=2025-09-12T03%3A55%3A00&max=2 "HTTP/1.1 404 Not Found"
2025-09-12 06:00:01,073 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 04:00:00 for CS.D.NZDUSD.MINI.IP - MID OHLC: 0.59705/0.59705/0.59705/0.59705 (Quality: 1.00)
2025-09-12 06:00:01,074 - ERROR - igstream.stream_validator - ❌ API validation error for CS.D.NZDUSD.MINI.IP: Client error '404 Not Found' for url 'https://api.ig.com/gateway/deal/prices/CS.D.NZDUSD.MINI.IP?resolution=MINUTE_5&from=2025-09-12T03%3A50%3A00&to=2025-09-12T03%3A55%3A00&max=2'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404
2025-09-12 06:00:01,079 - INFO - igstream.chart_streamer - 🟢 🆕 60m candle completed at 2025-09-12 04:00:00 for CS.D.USDJPY.MINI.IP - MID OHLC: 147.44650/147.44650/147.44650/147.44650 (Quality: 1.00)
2025-09-12 06:00:01,088 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 04:00:00 for CS.D.EURUSD.CEEM.IP - MID OHLC: 1.17256/1.17257/1.17254/1.17254 (Quality: 1.00)
2025-09-12 06:00:01,092 - INFO - igstream.chart_streamer - 🟢 🆕 60m candle completed at 2025-09-12 04:00:00 for CS.D.AUDJPY.MINI.IP - MID OHLC: 98.23300/98.23400/98.23300/98.23300 (Quality: 1.00)
2025-09-12 06:00:01,097 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 04:00:00 for CS.D.EURJPY.MINI.IP - MID OHLC: 172.90550/172.90650/172.90450/172.90650 (Quality: 1.00)
2025-09-12 06:00:01,100 - INFO - igstream.chart_streamer - 🟢 🆕 60m candle completed at 2025-09-12 04:00:00 for CS.D.GBPUSD.MINI.IP - MID OHLC: 1.35555/1.35555/1.35555/1.35555 (Quality: 1.00)
2025-09-12 06:00:01,105 - INFO - igstream.chart_streamer - 🟢 🆕 60m candle completed at 2025-09-12 04:00:00 for CS.D.NZDUSD.MINI.IP - MID OHLC: 0.59705/0.59705/0.59705/0.59705 (Quality: 1.00)
2025-09-12 06:00:01,112 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 04:00:00 for CS.D.USDJPY.MINI.IP - MID OHLC: 147.44650/147.44650/147.44650/147.44650 (Quality: 1.00)
2025-09-12 06:00:01,118 - INFO - igstream.chart_streamer - 🟢 🆕 60m candle completed at 2025-09-12 04:00:00 for CS.D.EURUSD.CEEM.IP - MID OHLC: 1.17256/1.17257/1.17254/1.17254 (Quality: 1.00)
2025-09-12 06:00:02,070 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 04:00:00 for CS.D.AUDUSD.MINI.IP - MID OHLC: 0.66619/0.66619/0.66619/0.66619 (Quality: 1.00)
2025-09-12 06:00:02,098 - INFO - igstream.chart_streamer - 🟢 🆕 60m candle completed at 2025-09-12 04:00:00 for CS.D.AUDUSD.MINI.IP - MID OHLC: 0.66619/0.66619/0.66619/0.66619 (Quality: 1.00)
2025-09-12 06:00:09,048 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 04:00:00 for CS.D.USDCHF.MINI.IP - MID OHLC: 0.79648/0.79648/0.79648/0.79648 (Quality: 1.00)
2025-09-12 06:00:09,077 - INFO - igstream.chart_streamer - 🟢 🆕 60m candle completed at 2025-09-12 04:00:00 for CS.D.USDCHF.MINI.IP - MID OHLC: 0.79648/0.79648/0.79648/0.79648 (Quality: 1.00)
2025-09-12 06:00:16,060 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 04:00:00 for CS.D.USDCAD.MINI.IP - MID OHLC: 1.38434/1.38435/1.38430/1.38431 (Quality: 1.00)
2025-09-12 06:00:16,098 - INFO - igstream.chart_streamer - 🟢 🆕 60m candle completed at 2025-09-12 04:00:00 for CS.D.USDCAD.MINI.IP - MID OHLC: 1.38434/1.38435/1.38430/1.38431 (Quality: 1.00)
2025-09-12 06:00:45,694 - INFO - igstream.sync_manager - 📊 Database stats: 63 candles in last 30min, latest: 2025-09-12 04:00:00
2025-09-12 06:01:45,707 - INFO - igstream.sync_manager - 📊 Database stats: 63 candles in last 30min, latest: 2025-09-12 04:00:00
2025-09-12 06:02:45,727 - INFO - igstream.sync_manager - 📊 Database stats: 63 candles in last 30min, latest: 2025-09-12 04:00:00
2025-09-12 06:03:27,897 - INFO - igstream.auto_backfill - Running automated gap detection and backfill...
2025-09-12 06:03:27,974 - INFO - igstream.auto_backfill - Backfill stats: 9/9 gaps filled (100.0%), 18 candles recovered
2025-09-12 06:03:45,744 - INFO - igstream.sync_manager - 📊 Database stats: 63 candles in last 30min, latest: 2025-09-12 04:00:00
2025-09-12 06:03:45,757 - INFO - igstream.sync_manager - 🔍 Running gap detection check...
2025-09-12 06:03:45,891 - INFO - igstream.sync_manager - ✅ No gaps detected in candle data
2025-09-12 06:04:45,897 - INFO - igstream.sync_manager - 📊 Database stats: 63 candles in last 30min, latest: 2025-09-12 04:00:00
2025-09-12 06:05:00,412 - INFO - httpx - HTTP Request: GET https://api.ig.com/gateway/deal/prices/CS.D.GBPUSD.MINI.IP?resolution=MINUTE_5&from=2025-09-12T03%3A55%3A00&to=2025-09-12T04%3A00%3A00&max=2 "HTTP/1.1 404 Not Found"
2025-09-12 06:05:00,413 - ERROR - igstream.stream_validator - ❌ API validation error for CS.D.GBPUSD.MINI.IP: Client error '404 Not Found' for url 'https://api.ig.com/gateway/deal/prices/CS.D.GBPUSD.MINI.IP?resolution=MINUTE_5&from=2025-09-12T03%3A55%3A00&to=2025-09-12T04%3A00%3A00&max=2'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404
2025-09-12 06:05:00,421 - INFO - httpx - HTTP Request: GET https://api.ig.com/gateway/deal/prices/CS.D.EURJPY.MINI.IP?resolution=MINUTE_5&from=2025-09-12T03%3A55%3A00&to=2025-09-12T04%3A00%3A00&max=2 "HTTP/1.1 404 Not Found"
2025-09-12 06:05:00,422 - ERROR - igstream.stream_validator - ❌ API validation error for CS.D.EURJPY.MINI.IP: Client error '404 Not Found' for url 'https://api.ig.com/gateway/deal/prices/CS.D.EURJPY.MINI.IP?resolution=MINUTE_5&from=2025-09-12T03%3A55%3A00&to=2025-09-12T04%3A00%3A00&max=2'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404
2025-09-12 06:05:00,426 - INFO - httpx - HTTP Request: GET https://api.ig.com/gateway/deal/prices/CS.D.USDJPY.MINI.IP?resolution=MINUTE_5&from=2025-09-12T03%3A55%3A00&to=2025-09-12T04%3A00%3A00&max=2 "HTTP/1.1 404 Not Found"
2025-09-12 06:05:00,427 - ERROR - igstream.stream_validator - ❌ API validation error for CS.D.USDJPY.MINI.IP: Client error '404 Not Found' for url 'https://api.ig.com/gateway/deal/prices/CS.D.USDJPY.MINI.IP?resolution=MINUTE_5&from=2025-09-12T03%3A55%3A00&to=2025-09-12T04%3A00%3A00&max=2'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404
2025-09-12 06:05:00,431 - INFO - httpx - HTTP Request: GET https://api.ig.com/gateway/deal/prices/CS.D.AUDJPY.MINI.IP?resolution=MINUTE_5&from=2025-09-12T03%3A55%3A00&to=2025-09-12T04%3A00%3A00&max=2 "HTTP/1.1 404 Not Found"
2025-09-12 06:05:00,432 - ERROR - igstream.stream_validator - ❌ API validation error for CS.D.AUDJPY.MINI.IP: Client error '404 Not Found' for url 'https://api.ig.com/gateway/deal/prices/CS.D.AUDJPY.MINI.IP?resolution=MINUTE_5&from=2025-09-12T03%3A55%3A00&to=2025-09-12T04%3A00%3A00&max=2'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404
2025-09-12 06:05:00,473 - INFO - httpx - HTTP Request: GET https://api.ig.com/gateway/deal/prices/CS.D.USDCAD.MINI.IP?resolution=MINUTE_5&from=2025-09-12T03%3A55%3A00&to=2025-09-12T04%3A00%3A00&max=2 "HTTP/1.1 404 Not Found"
2025-09-12 06:05:00,473 - INFO - httpx - HTTP Request: GET https://api.ig.com/gateway/deal/prices/CS.D.NZDUSD.MINI.IP?resolution=MINUTE_5&from=2025-09-12T03%3A55%3A00&to=2025-09-12T04%3A00%3A00&max=2 "HTTP/1.1 404 Not Found"
2025-09-12 06:05:00,474 - ERROR - igstream.stream_validator - ❌ API validation error for CS.D.USDCAD.MINI.IP: Client error '404 Not Found' for url 'https://api.ig.com/gateway/deal/prices/CS.D.USDCAD.MINI.IP?resolution=MINUTE_5&from=2025-09-12T03%3A55%3A00&to=2025-09-12T04%3A00%3A00&max=2'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404
2025-09-12 06:05:00,476 - ERROR - igstream.stream_validator - ❌ API validation error for CS.D.NZDUSD.MINI.IP: Client error '404 Not Found' for url 'https://api.ig.com/gateway/deal/prices/CS.D.NZDUSD.MINI.IP?resolution=MINUTE_5&from=2025-09-12T03%3A55%3A00&to=2025-09-12T04%3A00%3A00&max=2'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404
2025-09-12 06:05:00,478 - INFO - httpx - HTTP Request: GET https://api.ig.com/gateway/deal/prices/CS.D.AUDUSD.MINI.IP?resolution=MINUTE_5&from=2025-09-12T03%3A55%3A00&to=2025-09-12T04%3A00%3A00&max=2 "HTTP/1.1 404 Not Found"
2025-09-12 06:05:00,479 - ERROR - igstream.stream_validator - ❌ API validation error for CS.D.AUDUSD.MINI.IP: Client error '404 Not Found' for url 'https://api.ig.com/gateway/deal/prices/CS.D.AUDUSD.MINI.IP?resolution=MINUTE_5&from=2025-09-12T03%3A55%3A00&to=2025-09-12T04%3A00%3A00&max=2'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404
2025-09-12 06:05:00,492 - INFO - httpx - HTTP Request: GET https://api.ig.com/gateway/deal/prices/CS.D.EURUSD.CEEM.IP?resolution=MINUTE_5&from=2025-09-12T03%3A55%3A00&to=2025-09-12T04%3A00%3A00&max=2 "HTTP/1.1 404 Not Found"
2025-09-12 06:05:00,492 - ERROR - igstream.stream_validator - ❌ API validation error for CS.D.EURUSD.CEEM.IP: Client error '404 Not Found' for url 'https://api.ig.com/gateway/deal/prices/CS.D.EURUSD.CEEM.IP?resolution=MINUTE_5&from=2025-09-12T03%3A55%3A00&to=2025-09-12T04%3A00%3A00&max=2'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404
2025-09-12 06:05:00,495 - INFO - httpx - HTTP Request: GET https://api.ig.com/gateway/deal/prices/CS.D.USDCHF.MINI.IP?resolution=MINUTE_5&from=2025-09-12T03%3A55%3A00&to=2025-09-12T04%3A00%3A00&max=2 "HTTP/1.1 404 Not Found"
2025-09-12 06:05:00,495 - ERROR - igstream.stream_validator - ❌ API validation error for CS.D.USDCHF.MINI.IP: Client error '404 Not Found' for url 'https://api.ig.com/gateway/deal/prices/CS.D.USDCHF.MINI.IP?resolution=MINUTE_5&from=2025-09-12T03%3A55%3A00&to=2025-09-12T04%3A00%3A00&max=2'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404
2025-09-12 06:05:01,039 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 04:05:00 for CS.D.AUDJPY.MINI.IP - MID OHLC: 98.22850/98.22850/98.22850/98.22850 (Quality: 1.00)
2025-09-12 06:05:01,043 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 04:05:00 for CS.D.AUDUSD.MINI.IP - MID OHLC: 0.66612/0.66612/0.66612/0.66612 (Quality: 1.00)
2025-09-12 06:05:01,074 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 04:05:00 for CS.D.EURJPY.MINI.IP - MID OHLC: 172.89450/172.89450/172.89350/172.89350 (Quality: 1.00)
2025-09-12 06:05:01,080 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 04:05:00 for CS.D.NZDUSD.MINI.IP - MID OHLC: 0.59703/0.59703/0.59703/0.59703 (Quality: 1.00)
2025-09-12 06:05:05,074 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 04:05:00 for CS.D.GBPUSD.MINI.IP - MID OHLC: 1.35550/1.35552/1.35550/1.35552 (Quality: 1.00)
2025-09-12 06:05:05,092 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 04:05:00 for CS.D.USDCHF.MINI.IP - MID OHLC: 0.79658/0.79659/0.79658/0.79659 (Quality: 1.00)
2025-09-12 06:05:05,099 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 04:05:00 for CS.D.EURUSD.CEEM.IP - MID OHLC: 1.17229/1.17229/1.17229/1.17229 (Quality: 1.00)
2025-09-12 06:05:11,101 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 04:05:00 for CS.D.USDCAD.MINI.IP - MID OHLC: 1.38440/1.38440/1.38438/1.38440 (Quality: 1.00)
2025-09-12 06:05:15,078 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 04:05:00 for CS.D.USDJPY.MINI.IP - MID OHLC: 147.45650/147.45750/147.45650/147.45750 (Quality: 1.00)
2025-09-12 06:05:45,935 - INFO - igstream.sync_manager - 📊 Database stats: 63 candles in last 30min, latest: 2025-09-12 04:05:00
2025-09-12 06:06:02,254 - INFO - igstream.auto_backfill - Stopping auto-backfill service...
2025-09-12 06:06:02,254 - INFO - root - ✅ Auto-backfill service stopped
2025-09-12 06:06:02,254 - INFO - igstream.sync_manager - 🛑 Stopping all streams...
2025-09-12 06:06:02,254 - INFO - igstream.chart_streamer - Chart streaming cancelled for CS.D.GBPUSD.MINI.IP
2025-09-12 06:06:02,254 - INFO - igstream.stream_validator - 🛑 Stopping stream validation service...
2025-09-12 06:06:02,254 - INFO - igstream.chart_streamer - 📊 Validation stats for CS.D.GBPUSD.MINI.IP: {'total_validations': 2, 'successful_validations': 0, 'discrepancies_found': 0, 'api_errors': 0, 'corrections_made': 0, 'queue_size': 0, 'success_rate_pct': 0.0, 'processing': False}
2025-09-12 06:06:02,254 - INFO - igstream.chart_streamer - 🔌 Disconnecting Lightstreamer for CS.D.GBPUSD.MINI.IP...
2025-09-12 06:06:02,255 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.GBPUSD.MINI.IP: DISCONNECTED
2025-09-12 06:06:02,255 - INFO - igstream.chart_streamer - ✅ Cleanup complete for CS.D.GBPUSD.MINI.IP
2025-09-12 06:06:02,256 - INFO - igstream.chart_streamer - Chart streaming cancelled for CS.D.USDJPY.MINI.IP
2025-09-12 06:06:02,256 - INFO - igstream.stream_validator - 🛑 Stopping stream validation service...
2025-09-12 06:06:02,256 - INFO - igstream.chart_streamer - 📊 Validation stats for CS.D.USDJPY.MINI.IP: {'total_validations': 2, 'successful_validations': 0, 'discrepancies_found': 0, 'api_errors': 0, 'corrections_made': 0, 'queue_size': 0, 'success_rate_pct': 0.0, 'processing': False}
2025-09-12 06:06:02,256 - INFO - igstream.chart_streamer - 🔌 Disconnecting Lightstreamer for CS.D.USDJPY.MINI.IP...
2025-09-12 06:06:02,256 - INFO - igstream.chart_streamer - ✅ Cleanup complete for CS.D.USDJPY.MINI.IP
2025-09-12 06:06:02,256 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.USDJPY.MINI.IP: DISCONNECTED
2025-09-12 06:06:02,257 - INFO - igstream.chart_streamer - Chart streaming cancelled for CS.D.AUDUSD.MINI.IP
2025-09-12 06:06:02,257 - INFO - igstream.stream_validator - 🛑 Stopping stream validation service...
2025-09-12 06:06:02,257 - INFO - igstream.chart_streamer - 📊 Validation stats for CS.D.AUDUSD.MINI.IP: {'total_validations': 2, 'successful_validations': 0, 'discrepancies_found': 0, 'api_errors': 0, 'corrections_made': 0, 'queue_size': 0, 'success_rate_pct': 0.0, 'processing': False}
2025-09-12 06:06:02,257 - INFO - igstream.chart_streamer - 🔌 Disconnecting Lightstreamer for CS.D.AUDUSD.MINI.IP...
2025-09-12 06:06:02,258 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.AUDUSD.MINI.IP: DISCONNECTED
2025-09-12 06:06:02,258 - INFO - igstream.chart_streamer - ✅ Cleanup complete for CS.D.AUDUSD.MINI.IP
2025-09-12 06:06:02,258 - INFO - igstream.chart_streamer - Chart streaming cancelled for CS.D.USDCAD.MINI.IP
2025-09-12 06:06:02,258 - INFO - igstream.stream_validator - 🛑 Stopping stream validation service...
2025-09-12 06:06:02,258 - INFO - igstream.chart_streamer - 📊 Validation stats for CS.D.USDCAD.MINI.IP: {'total_validations': 2, 'successful_validations': 0, 'discrepancies_found': 0, 'api_errors': 0, 'corrections_made': 0, 'queue_size': 0, 'success_rate_pct': 0.0, 'processing': False}
2025-09-12 06:06:02,258 - INFO - igstream.chart_streamer - 🔌 Disconnecting Lightstreamer for CS.D.USDCAD.MINI.IP...
2025-09-12 06:06:02,259 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.USDCAD.MINI.IP: DISCONNECTED
2025-09-12 06:06:02,260 - INFO - igstream.chart_streamer - ✅ Cleanup complete for CS.D.USDCAD.MINI.IP
2025-09-12 06:06:02,261 - INFO - igstream.chart_streamer - Chart streaming cancelled for CS.D.EURJPY.MINI.IP
2025-09-12 06:06:02,261 - INFO - igstream.stream_validator - 🛑 Stopping stream validation service...
2025-09-12 06:06:02,261 - INFO - igstream.chart_streamer - 📊 Validation stats for CS.D.EURJPY.MINI.IP: {'total_validations': 2, 'successful_validations': 0, 'discrepancies_found': 0, 'api_errors': 0, 'corrections_made': 0, 'queue_size': 1, 'success_rate_pct': 0.0, 'processing': False}
2025-09-12 06:06:02,261 - INFO - igstream.chart_streamer - 🔌 Disconnecting Lightstreamer for CS.D.EURJPY.MINI.IP...
2025-09-12 06:06:02,262 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.EURJPY.MINI.IP: DISCONNECTED
2025-09-12 06:06:02,263 - INFO - igstream.chart_streamer - ✅ Cleanup complete for CS.D.EURJPY.MINI.IP
2025-09-12 06:06:02,263 - INFO - igstream.chart_streamer - Chart streaming cancelled for CS.D.AUDJPY.MINI.IP
2025-09-12 06:06:02,264 - INFO - igstream.stream_validator - 🛑 Stopping stream validation service...
2025-09-12 06:06:02,264 - INFO - igstream.chart_streamer - 📊 Validation stats for CS.D.AUDJPY.MINI.IP: {'total_validations': 2, 'successful_validations': 0, 'discrepancies_found': 0, 'api_errors': 0, 'corrections_made': 0, 'queue_size': 0, 'success_rate_pct': 0.0, 'processing': False}
2025-09-12 06:06:02,264 - INFO - igstream.chart_streamer - 🔌 Disconnecting Lightstreamer for CS.D.AUDJPY.MINI.IP...
2025-09-12 06:06:02,265 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.AUDJPY.MINI.IP: DISCONNECTED
2025-09-12 06:06:02,265 - INFO - igstream.chart_streamer - ✅ Cleanup complete for CS.D.AUDJPY.MINI.IP
2025-09-12 06:06:02,265 - INFO - igstream.chart_streamer - Chart streaming cancelled for CS.D.NZDUSD.MINI.IP
2025-09-12 06:06:02,266 - INFO - igstream.stream_validator - 🛑 Stopping stream validation service...
2025-09-12 06:06:02,266 - INFO - igstream.chart_streamer - 📊 Validation stats for CS.D.NZDUSD.MINI.IP: {'total_validations': 2, 'successful_validations': 0, 'discrepancies_found': 0, 'api_errors': 0, 'corrections_made': 0, 'queue_size': 1, 'success_rate_pct': 0.0, 'processing': False}
2025-09-12 06:06:02,266 - INFO - igstream.chart_streamer - 🔌 Disconnecting Lightstreamer for CS.D.NZDUSD.MINI.IP...
2025-09-12 06:06:02,266 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.NZDUSD.MINI.IP: DISCONNECTED
2025-09-12 06:06:02,266 - INFO - igstream.chart_streamer - ✅ Cleanup complete for CS.D.NZDUSD.MINI.IP
2025-09-12 06:06:02,267 - INFO - igstream.chart_streamer - Chart streaming cancelled for CS.D.USDCHF.MINI.IP
2025-09-12 06:06:02,267 - INFO - igstream.stream_validator - 🛑 Stopping stream validation service...
2025-09-12 06:06:02,267 - INFO - igstream.chart_streamer - 📊 Validation stats for CS.D.USDCHF.MINI.IP: {'total_validations': 2, 'successful_validations': 0, 'discrepancies_found': 0, 'api_errors': 0, 'corrections_made': 0, 'queue_size': 0, 'success_rate_pct': 0.0, 'processing': False}
2025-09-12 06:06:02,268 - INFO - igstream.chart_streamer - 🔌 Disconnecting Lightstreamer for CS.D.USDCHF.MINI.IP...
2025-09-12 06:06:02,268 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.USDCHF.MINI.IP: DISCONNECTED
2025-09-12 06:06:02,268 - INFO - igstream.chart_streamer - ✅ Cleanup complete for CS.D.USDCHF.MINI.IP
2025-09-12 06:06:02,268 - INFO - igstream.chart_streamer - Chart streaming cancelled for CS.D.EURUSD.CEEM.IP
2025-09-12 06:06:02,268 - INFO - igstream.stream_validator - 🛑 Stopping stream validation service...
2025-09-12 06:06:02,269 - INFO - igstream.chart_streamer - 📊 Validation stats for CS.D.EURUSD.CEEM.IP: {'total_validations': 2, 'successful_validations': 0, 'discrepancies_found': 0, 'api_errors': 0, 'corrections_made': 0, 'queue_size': 0, 'success_rate_pct': 0.0, 'processing': False}
2025-09-12 06:06:02,269 - INFO - igstream.chart_streamer - 🔌 Disconnecting Lightstreamer for CS.D.EURUSD.CEEM.IP...
2025-09-12 06:06:02,269 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.EURUSD.CEEM.IP: DISCONNECTED
2025-09-12 06:06:02,270 - INFO - igstream.chart_streamer - ✅ Cleanup complete for CS.D.EURUSD.CEEM.IP
2025-09-12 06:06:02,471 - INFO - igstream.sync_manager - ✅ All streams shut down.
2025-09-12 06:08:51,943 - INFO - igstream.sync_manager - 🚀 Starting all forex streams...
2025-09-12 06:08:51,943 - INFO - igstream.sync_manager - 🔑 Refreshing IG session...
2025-09-12 06:08:52,178 - INFO - httpx - HTTP Request: POST https://api.ig.com/gateway/deal/session "HTTP/1.1 200 OK"
2025-09-12 06:08:52,179 - INFO - igstream.ig_auth_prod - IG Login successful
2025-09-12 06:08:52,179 - INFO - igstream.sync_manager - ✅ Auth refreshed successfully
2025-09-12 06:08:52,179 - INFO - igstream.sync_manager - 🚀 Starting chart stream for CS.D.GBPUSD.MINI.IP
2025-09-12 06:08:52,179 - INFO - igstream.chart_streamer - 🚀 Starting enhanced chart stream for CS.D.GBPUSD.MINI.IP
2025-09-12 06:08:52,180 - INFO - igstream.chart_streamer - 🔌 Connecting to Lightstreamer for CS.D.GBPUSD.MINI.IP...
2025-09-12 06:08:52,186 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.GBPUSD.MINI.IP: CONNECTING
2025-09-12 06:08:52,436 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.GBPUSD.MINI.IP: CONNECTED:WS-STREAMING
2025-09-12 06:08:53,181 - INFO - igstream.sync_manager - 🚀 Starting chart stream for CS.D.USDJPY.MINI.IP
2025-09-12 06:08:53,181 - INFO - igstream.chart_streamer - 🚀 Starting enhanced chart stream for CS.D.USDJPY.MINI.IP
2025-09-12 06:08:53,182 - INFO - igstream.chart_streamer - 🔌 Connecting to Lightstreamer for CS.D.USDJPY.MINI.IP...
2025-09-12 06:08:53,182 - INFO - igstream.chart_streamer - ✅ Connected to Lightstreamer for CS.D.GBPUSD.MINI.IP
2025-09-12 06:08:53,182 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.USDJPY.MINI.IP: CONNECTING
2025-09-12 06:08:53,183 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.GBPUSD.MINI.IP:5MINUTE
2025-09-12 06:08:53,184 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.GBPUSD.MINI.IP:HOUR
2025-09-12 06:08:53,184 - INFO - igstream.chart_streamer - 📡 All subscriptions active for CS.D.GBPUSD.MINI.IP
2025-09-12 06:08:53,184 - INFO - igstream.chart_streamer - 🔍 Stream validation service started for CS.D.GBPUSD.MINI.IP
2025-09-12 06:08:53,184 - INFO - igstream.stream_validator - 🚀 Starting stream validation service...
2025-09-12 06:08:53,185 - INFO - igstream.stream_validator -    Validation delay: 300s
2025-09-12 06:08:53,185 - INFO - igstream.stream_validator -    Validation frequency: every 3 candles
2025-09-12 06:08:53,185 - INFO - igstream.stream_validator -    Rate limit: 80 requests/minute
2025-09-12 06:08:53,220 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 5m for CS.D.GBPUSD.MINI.IP
2025-09-12 06:08:53,251 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 60m for CS.D.GBPUSD.MINI.IP
2025-09-12 06:08:53,268 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 04:05:00 for CS.D.GBPUSD.MINI.IP - MID OHLC: 1.35550/1.35566/1.35550/1.35557 (Quality: 1.00)
2025-09-12 06:08:53,272 - INFO - igstream.chart_streamer - 🟢 🆕 60m candle completed at 2025-09-12 04:00:00 for CS.D.GBPUSD.MINI.IP - MID OHLC: 1.35555/1.35566/1.35540/1.35557 (Quality: 1.00)
2025-09-12 06:08:53,441 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.USDJPY.MINI.IP: CONNECTED:WS-STREAMING
2025-09-12 06:08:54,182 - INFO - igstream.sync_manager - 🚀 Starting chart stream for CS.D.AUDUSD.MINI.IP
2025-09-12 06:08:54,182 - INFO - igstream.chart_streamer - 🚀 Starting enhanced chart stream for CS.D.AUDUSD.MINI.IP
2025-09-12 06:08:54,183 - INFO - igstream.chart_streamer - 🔌 Connecting to Lightstreamer for CS.D.AUDUSD.MINI.IP...
2025-09-12 06:08:54,183 - INFO - igstream.chart_streamer - ✅ Connected to Lightstreamer for CS.D.USDJPY.MINI.IP
2025-09-12 06:08:54,183 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.AUDUSD.MINI.IP: CONNECTING
2025-09-12 06:08:54,184 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.USDJPY.MINI.IP:5MINUTE
2025-09-12 06:08:54,185 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.USDJPY.MINI.IP:HOUR
2025-09-12 06:08:54,185 - INFO - igstream.chart_streamer - 📡 All subscriptions active for CS.D.USDJPY.MINI.IP
2025-09-12 06:08:54,185 - INFO - igstream.chart_streamer - 🔍 Stream validation service started for CS.D.USDJPY.MINI.IP
2025-09-12 06:08:54,185 - INFO - igstream.stream_validator - 🚀 Starting stream validation service...
2025-09-12 06:08:54,185 - INFO - igstream.stream_validator -    Validation delay: 300s
2025-09-12 06:08:54,185 - INFO - igstream.stream_validator -    Validation frequency: every 3 candles
2025-09-12 06:08:54,185 - INFO - igstream.stream_validator -    Rate limit: 80 requests/minute
2025-09-12 06:08:54,225 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 5m for CS.D.USDJPY.MINI.IP
2025-09-12 06:08:54,256 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 60m for CS.D.USDJPY.MINI.IP
2025-09-12 06:08:54,264 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 04:05:00 for CS.D.USDJPY.MINI.IP - MID OHLC: 147.45650/147.47200/147.45450/147.46400 (Quality: 1.00)
2025-09-12 06:08:54,269 - INFO - igstream.chart_streamer - 🟢 🆕 60m candle completed at 2025-09-12 04:00:00 for CS.D.USDJPY.MINI.IP - MID OHLC: 147.44650/147.47250/147.44650/147.46400 (Quality: 1.00)
2025-09-12 06:08:54,476 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.AUDUSD.MINI.IP: CONNECTED:WS-STREAMING
2025-09-12 06:08:55,183 - INFO - igstream.sync_manager - 🚀 Starting chart stream for CS.D.USDCAD.MINI.IP
2025-09-12 06:08:55,183 - INFO - igstream.chart_streamer - 🚀 Starting enhanced chart stream for CS.D.USDCAD.MINI.IP
2025-09-12 06:08:55,184 - INFO - igstream.chart_streamer - 🔌 Connecting to Lightstreamer for CS.D.USDCAD.MINI.IP...
2025-09-12 06:08:55,184 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.USDCAD.MINI.IP: CONNECTING
2025-09-12 06:08:55,185 - INFO - igstream.chart_streamer - ✅ Connected to Lightstreamer for CS.D.AUDUSD.MINI.IP
2025-09-12 06:08:55,185 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.AUDUSD.MINI.IP:5MINUTE
2025-09-12 06:08:55,185 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.AUDUSD.MINI.IP:HOUR
2025-09-12 06:08:55,186 - INFO - igstream.chart_streamer - 📡 All subscriptions active for CS.D.AUDUSD.MINI.IP
2025-09-12 06:08:55,186 - INFO - igstream.chart_streamer - 🔍 Stream validation service started for CS.D.AUDUSD.MINI.IP
2025-09-12 06:08:55,186 - INFO - igstream.stream_validator - 🚀 Starting stream validation service...
2025-09-12 06:08:55,186 - INFO - igstream.stream_validator -    Validation delay: 300s
2025-09-12 06:08:55,186 - INFO - igstream.stream_validator -    Validation frequency: every 3 candles
2025-09-12 06:08:55,186 - INFO - igstream.stream_validator -    Rate limit: 80 requests/minute
2025-09-12 06:08:55,222 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 5m for CS.D.AUDUSD.MINI.IP
2025-09-12 06:08:55,252 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 60m for CS.D.AUDUSD.MINI.IP
2025-09-12 06:08:55,261 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 04:05:00 for CS.D.AUDUSD.MINI.IP - MID OHLC: 0.66612/0.66622/0.66612/0.66615 (Quality: 1.00)
2025-09-12 06:08:55,267 - INFO - igstream.chart_streamer - 🟢 🆕 60m candle completed at 2025-09-12 04:00:00 for CS.D.AUDUSD.MINI.IP - MID OHLC: 0.66619/0.66629/0.66611/0.66615 (Quality: 1.00)
2025-09-12 06:08:55,477 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.USDCAD.MINI.IP: CONNECTED:WS-STREAMING
2025-09-12 06:08:56,185 - INFO - igstream.sync_manager - 🚀 Starting chart stream for CS.D.EURJPY.MINI.IP
2025-09-12 06:08:56,185 - INFO - igstream.chart_streamer - ✅ Connected to Lightstreamer for CS.D.USDCAD.MINI.IP
2025-09-12 06:08:56,186 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.USDCAD.MINI.IP:5MINUTE
2025-09-12 06:08:56,186 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.USDCAD.MINI.IP:HOUR
2025-09-12 06:08:56,186 - INFO - igstream.chart_streamer - 📡 All subscriptions active for CS.D.USDCAD.MINI.IP
2025-09-12 06:08:56,187 - INFO - igstream.chart_streamer - 🔍 Stream validation service started for CS.D.USDCAD.MINI.IP
2025-09-12 06:08:56,187 - INFO - igstream.chart_streamer - 🚀 Starting enhanced chart stream for CS.D.EURJPY.MINI.IP
2025-09-12 06:08:56,187 - INFO - igstream.chart_streamer - 🔌 Connecting to Lightstreamer for CS.D.EURJPY.MINI.IP...
2025-09-12 06:08:56,188 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.EURJPY.MINI.IP: CONNECTING
2025-09-12 06:08:56,188 - INFO - igstream.stream_validator - 🚀 Starting stream validation service...
2025-09-12 06:08:56,189 - INFO - igstream.stream_validator -    Validation delay: 300s
2025-09-12 06:08:56,189 - INFO - igstream.stream_validator -    Validation frequency: every 3 candles
2025-09-12 06:08:56,189 - INFO - igstream.stream_validator -    Rate limit: 80 requests/minute
2025-09-12 06:08:56,223 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 5m for CS.D.USDCAD.MINI.IP
2025-09-12 06:08:56,223 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 60m for CS.D.USDCAD.MINI.IP
2025-09-12 06:08:56,266 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 04:05:00 for CS.D.USDCAD.MINI.IP - MID OHLC: 1.38440/1.38443/1.38432/1.38437 (Quality: 1.00)
2025-09-12 06:08:56,270 - INFO - igstream.chart_streamer - 🟢 🆕 60m candle completed at 2025-09-12 04:00:00 for CS.D.USDCAD.MINI.IP - MID OHLC: 1.38434/1.38443/1.38430/1.38437 (Quality: 1.00)
2025-09-12 06:08:56,398 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.EURJPY.MINI.IP: CONNECTED:WS-STREAMING
2025-09-12 06:08:57,187 - INFO - igstream.sync_manager - 🚀 Starting chart stream for CS.D.AUDJPY.MINI.IP
2025-09-12 06:08:57,188 - INFO - igstream.chart_streamer - 🚀 Starting enhanced chart stream for CS.D.AUDJPY.MINI.IP
2025-09-12 06:08:57,188 - INFO - igstream.chart_streamer - 🔌 Connecting to Lightstreamer for CS.D.AUDJPY.MINI.IP...
2025-09-12 06:08:57,189 - INFO - igstream.chart_streamer - ✅ Connected to Lightstreamer for CS.D.EURJPY.MINI.IP
2025-09-12 06:08:57,189 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.AUDJPY.MINI.IP: CONNECTING
2025-09-12 06:08:57,189 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.EURJPY.MINI.IP:5MINUTE
2025-09-12 06:08:57,190 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.EURJPY.MINI.IP:HOUR
2025-09-12 06:08:57,190 - INFO - igstream.chart_streamer - 📡 All subscriptions active for CS.D.EURJPY.MINI.IP
2025-09-12 06:08:57,190 - INFO - igstream.chart_streamer - 🔍 Stream validation service started for CS.D.EURJPY.MINI.IP
2025-09-12 06:08:57,190 - INFO - igstream.stream_validator - 🚀 Starting stream validation service...
2025-09-12 06:08:57,190 - INFO - igstream.stream_validator -    Validation delay: 300s
2025-09-12 06:08:57,190 - INFO - igstream.stream_validator -    Validation frequency: every 3 candles
2025-09-12 06:08:57,190 - INFO - igstream.stream_validator -    Rate limit: 80 requests/minute
2025-09-12 06:08:57,224 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 5m for CS.D.EURJPY.MINI.IP
2025-09-12 06:08:57,255 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 60m for CS.D.EURJPY.MINI.IP
2025-09-12 06:08:57,264 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 04:05:00 for CS.D.EURJPY.MINI.IP - MID OHLC: 172.89450/172.91150/172.89050/172.90150 (Quality: 1.00)
2025-09-12 06:08:57,269 - INFO - igstream.chart_streamer - 🟢 🆕 60m candle completed at 2025-09-12 04:00:00 for CS.D.EURJPY.MINI.IP - MID OHLC: 172.90550/172.91400/172.89050/172.90150 (Quality: 1.00)
2025-09-12 06:08:57,419 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.AUDJPY.MINI.IP: CONNECTED:WS-STREAMING
2025-09-12 06:08:58,190 - INFO - igstream.sync_manager - 🚀 Starting chart stream for CS.D.NZDUSD.MINI.IP
2025-09-12 06:08:58,190 - INFO - igstream.chart_streamer - ✅ Connected to Lightstreamer for CS.D.AUDJPY.MINI.IP
2025-09-12 06:08:58,190 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.AUDJPY.MINI.IP:5MINUTE
2025-09-12 06:08:58,191 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.AUDJPY.MINI.IP:HOUR
2025-09-12 06:08:58,191 - INFO - igstream.chart_streamer - 📡 All subscriptions active for CS.D.AUDJPY.MINI.IP
2025-09-12 06:08:58,191 - INFO - igstream.chart_streamer - 🔍 Stream validation service started for CS.D.AUDJPY.MINI.IP
2025-09-12 06:08:58,192 - INFO - igstream.chart_streamer - 🚀 Starting enhanced chart stream for CS.D.NZDUSD.MINI.IP
2025-09-12 06:08:58,192 - INFO - igstream.chart_streamer - 🔌 Connecting to Lightstreamer for CS.D.NZDUSD.MINI.IP...
2025-09-12 06:08:58,192 - INFO - igstream.stream_validator - 🚀 Starting stream validation service...
2025-09-12 06:08:58,192 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.NZDUSD.MINI.IP: CONNECTING
2025-09-12 06:08:58,192 - INFO - igstream.stream_validator -    Validation delay: 300s
2025-09-12 06:08:58,192 - INFO - igstream.stream_validator -    Validation frequency: every 3 candles
2025-09-12 06:08:58,193 - INFO - igstream.stream_validator -    Rate limit: 80 requests/minute
2025-09-12 06:08:58,230 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 60m for CS.D.AUDJPY.MINI.IP
2025-09-12 06:08:58,231 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 5m for CS.D.AUDJPY.MINI.IP
2025-09-12 06:08:58,269 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 04:05:00 for CS.D.AUDJPY.MINI.IP - MID OHLC: 98.22850/98.25200/98.22750/98.24000 (Quality: 1.00)
2025-09-12 06:08:58,275 - INFO - igstream.chart_streamer - 🟢 🆕 60m candle completed at 2025-09-12 04:00:00 for CS.D.AUDJPY.MINI.IP - MID OHLC: 98.23300/98.25200/98.22700/98.24000 (Quality: 1.00)
2025-09-12 06:08:58,454 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.NZDUSD.MINI.IP: CONNECTED:WS-STREAMING
2025-09-12 06:08:59,191 - INFO - igstream.sync_manager - 🚀 Starting chart stream for CS.D.USDCHF.MINI.IP
2025-09-12 06:08:59,191 - INFO - igstream.chart_streamer - 🚀 Starting enhanced chart stream for CS.D.USDCHF.MINI.IP
2025-09-12 06:08:59,191 - INFO - igstream.chart_streamer - 🔌 Connecting to Lightstreamer for CS.D.USDCHF.MINI.IP...
2025-09-12 06:08:59,192 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.USDCHF.MINI.IP: CONNECTING
2025-09-12 06:08:59,192 - INFO - igstream.chart_streamer - ✅ Connected to Lightstreamer for CS.D.NZDUSD.MINI.IP
2025-09-12 06:08:59,193 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.NZDUSD.MINI.IP:5MINUTE
2025-09-12 06:08:59,193 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.NZDUSD.MINI.IP:HOUR
2025-09-12 06:08:59,193 - INFO - igstream.chart_streamer - 📡 All subscriptions active for CS.D.NZDUSD.MINI.IP
2025-09-12 06:08:59,193 - INFO - igstream.chart_streamer - 🔍 Stream validation service started for CS.D.NZDUSD.MINI.IP
2025-09-12 06:08:59,193 - INFO - igstream.stream_validator - 🚀 Starting stream validation service...
2025-09-12 06:08:59,194 - INFO - igstream.stream_validator -    Validation delay: 300s
2025-09-12 06:08:59,194 - INFO - igstream.stream_validator -    Validation frequency: every 3 candles
2025-09-12 06:08:59,194 - INFO - igstream.stream_validator -    Rate limit: 80 requests/minute
2025-09-12 06:08:59,230 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 5m for CS.D.NZDUSD.MINI.IP
2025-09-12 06:08:59,261 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 60m for CS.D.NZDUSD.MINI.IP
2025-09-12 06:08:59,269 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 04:05:00 for CS.D.NZDUSD.MINI.IP - MID OHLC: 0.59703/0.59709/0.59694/0.59696 (Quality: 1.00)
2025-09-12 06:08:59,274 - INFO - igstream.chart_streamer - 🟢 🆕 60m candle completed at 2025-09-12 04:00:00 for CS.D.NZDUSD.MINI.IP - MID OHLC: 0.59705/0.59717/0.59694/0.59696 (Quality: 1.00)
2025-09-12 06:08:59,423 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.USDCHF.MINI.IP: CONNECTED:WS-STREAMING
2025-09-12 06:09:00,192 - INFO - igstream.sync_manager - 🚀 Starting chart stream for CS.D.EURUSD.CEEM.IP
2025-09-12 06:09:00,193 - INFO - igstream.chart_streamer - ✅ Connected to Lightstreamer for CS.D.USDCHF.MINI.IP
2025-09-12 06:09:00,193 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.USDCHF.MINI.IP:5MINUTE
2025-09-12 06:09:00,193 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.USDCHF.MINI.IP:HOUR
2025-09-12 06:09:00,193 - INFO - igstream.chart_streamer - 📡 All subscriptions active for CS.D.USDCHF.MINI.IP
2025-09-12 06:09:00,194 - INFO - igstream.chart_streamer - 🔍 Stream validation service started for CS.D.USDCHF.MINI.IP
2025-09-12 06:09:00,194 - INFO - igstream.chart_streamer - 🚀 Starting enhanced chart stream for CS.D.EURUSD.CEEM.IP
2025-09-12 06:09:00,194 - INFO - igstream.chart_streamer - 🔌 Connecting to Lightstreamer for CS.D.EURUSD.CEEM.IP...
2025-09-12 06:09:00,194 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.EURUSD.CEEM.IP: CONNECTING
2025-09-12 06:09:00,194 - INFO - igstream.stream_validator - 🚀 Starting stream validation service...
2025-09-12 06:09:00,194 - INFO - igstream.stream_validator -    Validation delay: 300s
2025-09-12 06:09:00,194 - INFO - igstream.stream_validator -    Validation frequency: every 3 candles
2025-09-12 06:09:00,194 - INFO - igstream.stream_validator -    Rate limit: 80 requests/minute
2025-09-12 06:09:00,230 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 60m for CS.D.USDCHF.MINI.IP
2025-09-12 06:09:00,230 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 5m for CS.D.USDCHF.MINI.IP
2025-09-12 06:09:00,269 - INFO - igstream.chart_streamer - 🟢 🆕 60m candle completed at 2025-09-12 04:00:00 for CS.D.USDCHF.MINI.IP - MID OHLC: 0.79648/0.79668/0.79648/0.79661 (Quality: 1.00)
2025-09-12 06:09:00,274 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 04:05:00 for CS.D.USDCHF.MINI.IP - MID OHLC: 0.79658/0.79668/0.79658/0.79661 (Quality: 1.00)
2025-09-12 06:09:00,483 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.EURUSD.CEEM.IP: CONNECTED:WS-STREAMING
2025-09-12 06:09:01,194 - INFO - igstream.sync_manager - ✅ All streams started.
2025-09-12 06:09:01,194 - INFO - igstream.sync_manager - 🔄 Watchdog and auth refresher started.
2025-09-12 06:09:01,203 - INFO - root - ⚠️ Auto-backfill service DISABLED to preserve API rate limits
2025-09-12 06:09:01,203 - INFO - root - ✅ Auto-backfill service started (checking every 5 minutes)
2025-09-12 06:09:01,203 - INFO - igstream.sync_manager - ⏱️ Enhanced watchdog loop with gap detection started...
2025-09-12 06:09:01,213 - INFO - igstream.sync_manager - 📊 Database stats: 63 candles in last 30min, latest: 2025-09-12 04:05:00
2025-09-12 06:09:01,227 - INFO - igstream.sync_manager - 🔍 Running gap detection check...
2025-09-12 06:09:01,346 - INFO - igstream.sync_manager - ✅ No gaps detected in candle data
2025-09-12 06:09:01,346 - INFO - igstream.sync_manager - 🔑 Refreshing IG session...
2025-09-12 06:09:01,346 - INFO - igstream.sync_manager - ✅ Auth refreshed successfully
2025-09-12 06:09:01,346 - INFO - igstream.auto_backfill - Starting continuous auto-backfill service (checking every 5 minutes)
2025-09-12 06:09:01,346 - INFO - igstream.auto_backfill - Auto-backfill service authenticated successfully
2025-09-12 06:09:01,346 - INFO - igstream.auto_backfill - Running automated gap detection and backfill...
2025-09-12 06:09:01,427 - INFO - igstream.chart_streamer - ✅ Connected to Lightstreamer for CS.D.EURUSD.CEEM.IP
2025-09-12 06:09:01,427 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.EURUSD.CEEM.IP:5MINUTE
2025-09-12 06:09:01,428 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.EURUSD.CEEM.IP:HOUR
2025-09-12 06:09:01,428 - INFO - igstream.chart_streamer - 📡 All subscriptions active for CS.D.EURUSD.CEEM.IP
2025-09-12 06:09:01,428 - INFO - igstream.chart_streamer - 🔍 Stream validation service started for CS.D.EURUSD.CEEM.IP
2025-09-12 06:09:01,428 - INFO - igstream.stream_validator - 🚀 Starting stream validation service...
2025-09-12 06:09:01,428 - INFO - igstream.stream_validator -    Validation delay: 300s
2025-09-12 06:09:01,428 - INFO - igstream.stream_validator -    Validation frequency: every 3 candles
2025-09-12 06:09:01,428 - INFO - igstream.stream_validator -    Rate limit: 80 requests/minute
2025-09-12 06:09:01,467 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 5m for CS.D.EURUSD.CEEM.IP
2025-09-12 06:09:01,498 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 60m for CS.D.EURUSD.CEEM.IP
2025-09-12 06:09:01,504 - INFO - igstream.chart_streamer - 🟢 🆕 60m candle completed at 2025-09-12 04:00:00 for CS.D.EURUSD.CEEM.IP - MID OHLC: 1.17256/1.17257/1.17226/1.17228 (Quality: 1.00)
2025-09-12 06:09:01,509 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 04:05:00 for CS.D.EURUSD.CEEM.IP - MID OHLC: 1.17229/1.17237/1.17226/1.17228 (Quality: 1.00)
2025-09-12 06:10:01,051 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 04:10:00 for CS.D.EURJPY.MINI.IP - MID OHLC: 172.90850/172.91150/172.90850/172.91150 (Quality: 1.00)
2025-09-12 06:10:01,058 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 04:10:00 for CS.D.NZDUSD.MINI.IP - MID OHLC: 0.59698/0.59699/0.59698/0.59699 (Quality: 1.00)
2025-09-12 06:10:01,069 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 04:10:00 for CS.D.AUDJPY.MINI.IP - MID OHLC: 98.24750/98.24750/98.24750/98.24750 (Quality: 1.00)
2025-09-12 06:10:01,353 - INFO - igstream.sync_manager - 📊 Database stats: 57 candles in last 30min, latest: 2025-09-12 04:10:00
2025-09-12 06:10:01,355 - WARNING - igstream.sync_manager - Data for CS.D.GBPUSD.MINI.IP 5m is stale. Last update: 2025-09-12 04:05:00+00:00 (301 seconds ago, threshold: 300s)
2025-09-12 06:10:01,358 - WARNING - igstream.sync_manager - Data for CS.D.USDJPY.MINI.IP 5m is stale. Last update: 2025-09-12 04:05:00+00:00 (301 seconds ago, threshold: 300s)
2025-09-12 06:10:01,360 - WARNING - igstream.sync_manager - Data for CS.D.AUDUSD.MINI.IP 5m is stale. Last update: 2025-09-12 04:05:00+00:00 (301 seconds ago, threshold: 300s)
2025-09-12 06:10:01,362 - WARNING - igstream.sync_manager - Data for CS.D.USDCAD.MINI.IP 5m is stale. Last update: 2025-09-12 04:05:00+00:00 (301 seconds ago, threshold: 300s)
2025-09-12 06:10:01,369 - WARNING - igstream.sync_manager - Data for CS.D.USDCHF.MINI.IP 5m is stale. Last update: 2025-09-12 04:05:00+00:00 (301 seconds ago, threshold: 300s)
2025-09-12 06:10:01,371 - WARNING - igstream.sync_manager - Data for CS.D.EURUSD.CEEM.IP 5m is stale. Last update: 2025-09-12 04:05:00+00:00 (301 seconds ago, threshold: 300s)
2025-09-12 06:10:01,372 - WARNING - igstream.sync_manager - ⚠️ Stream CS.D.GBPUSD.MINI.IP needs restart (stale_data). Reconnecting...
2025-09-12 06:10:01,372 - INFO - igstream.chart_streamer - Chart streaming cancelled for CS.D.GBPUSD.MINI.IP
2025-09-12 06:10:01,372 - INFO - igstream.stream_validator - 🛑 Stopping stream validation service...
2025-09-12 06:10:01,372 - INFO - igstream.chart_streamer - 📊 Validation stats for CS.D.GBPUSD.MINI.IP: {'total_validations': 0, 'successful_validations': 0, 'discrepancies_found': 0, 'api_errors': 0, 'corrections_made': 0, 'queue_size': 2, 'success_rate_pct': 0.0, 'processing': False}
2025-09-12 06:10:01,373 - INFO - igstream.chart_streamer - 🔌 Disconnecting Lightstreamer for CS.D.GBPUSD.MINI.IP...
2025-09-12 06:10:01,373 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.GBPUSD.MINI.IP: DISCONNECTED
2025-09-12 06:10:01,373 - INFO - igstream.chart_streamer - ✅ Cleanup complete for CS.D.GBPUSD.MINI.IP
2025-09-12 06:10:01,373 - INFO - igstream.sync_manager - Stopped stream for CS.D.GBPUSD.MINI.IP
2025-09-12 06:10:02,045 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 04:10:00 for CS.D.USDCAD.MINI.IP - MID OHLC: 1.38434/1.38434/1.38434/1.38434 (Quality: 1.00)
2025-09-12 06:10:03,056 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 04:10:00 for CS.D.EURUSD.CEEM.IP - MID OHLC: 1.17230/1.17230/1.17228/1.17228 (Quality: 1.00)
2025-09-12 06:10:03,375 - INFO - igstream.sync_manager - 🚀 Starting chart stream for CS.D.GBPUSD.MINI.IP
2025-09-12 06:10:03,376 - INFO - igstream.sync_manager - ✅ Stream CS.D.GBPUSD.MINI.IP restart triggered due to: stale_data
2025-09-12 06:10:03,376 - WARNING - igstream.sync_manager - ⚠️ Stream CS.D.USDJPY.MINI.IP needs restart (stale_data). Reconnecting...
2025-09-12 06:10:03,376 - INFO - igstream.chart_streamer - 🚀 Starting enhanced chart stream for CS.D.GBPUSD.MINI.IP
2025-09-12 06:10:03,376 - INFO - igstream.chart_streamer - 🔌 Connecting to Lightstreamer for CS.D.GBPUSD.MINI.IP...
2025-09-12 06:10:03,376 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.GBPUSD.MINI.IP: CONNECTING
2025-09-12 06:10:03,376 - INFO - igstream.chart_streamer - Chart streaming cancelled for CS.D.USDJPY.MINI.IP
2025-09-12 06:10:03,376 - INFO - igstream.stream_validator - 🛑 Stopping stream validation service...
2025-09-12 06:10:03,377 - INFO - igstream.chart_streamer - 📊 Validation stats for CS.D.USDJPY.MINI.IP: {'total_validations': 0, 'successful_validations': 0, 'discrepancies_found': 0, 'api_errors': 0, 'corrections_made': 0, 'queue_size': 2, 'success_rate_pct': 0.0, 'processing': False}
2025-09-12 06:10:03,377 - INFO - igstream.chart_streamer - 🔌 Disconnecting Lightstreamer for CS.D.USDJPY.MINI.IP...
2025-09-12 06:10:03,377 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.USDJPY.MINI.IP: DISCONNECTED
2025-09-12 06:10:03,377 - INFO - igstream.chart_streamer - ✅ Cleanup complete for CS.D.USDJPY.MINI.IP
2025-09-12 06:10:03,378 - INFO - igstream.sync_manager - Stopped stream for CS.D.USDJPY.MINI.IP
2025-09-12 06:10:03,588 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.GBPUSD.MINI.IP: CONNECTED:WS-STREAMING
2025-09-12 06:10:04,044 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 04:10:00 for CS.D.AUDUSD.MINI.IP - MID OHLC: 0.66615/0.66615/0.66615/0.66615 (Quality: 1.00)
2025-09-12 06:10:04,073 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 04:10:00 for CS.D.USDCHF.MINI.IP - MID OHLC: 0.79664/0.79664/0.79663/0.79663 (Quality: 1.00)
2025-09-12 06:10:04,377 - INFO - igstream.chart_streamer - ✅ Connected to Lightstreamer for CS.D.GBPUSD.MINI.IP
2025-09-12 06:10:04,377 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.GBPUSD.MINI.IP:5MINUTE
2025-09-12 06:10:04,378 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.GBPUSD.MINI.IP:HOUR
2025-09-12 06:10:04,378 - INFO - igstream.chart_streamer - 📡 All subscriptions active for CS.D.GBPUSD.MINI.IP
2025-09-12 06:10:04,379 - INFO - igstream.chart_streamer - 🔍 Stream validation service started for CS.D.GBPUSD.MINI.IP
2025-09-12 06:10:04,379 - INFO - igstream.stream_validator - 🚀 Starting stream validation service...
2025-09-12 06:10:04,379 - INFO - igstream.stream_validator -    Validation delay: 300s
2025-09-12 06:10:04,379 - INFO - igstream.stream_validator -    Validation frequency: every 3 candles
2025-09-12 06:10:04,379 - INFO - igstream.stream_validator -    Rate limit: 80 requests/minute
2025-09-12 06:10:04,413 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 60m for CS.D.GBPUSD.MINI.IP
2025-09-12 06:10:04,443 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 5m for CS.D.GBPUSD.MINI.IP
2025-09-12 06:10:04,453 - INFO - igstream.chart_streamer - 🟢 🆕 60m candle completed at 2025-09-12 04:00:00 for CS.D.GBPUSD.MINI.IP - MID OHLC: 1.35555/1.35566/1.35540/1.35554 (Quality: 1.00)
2025-09-12 06:10:04,459 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 04:10:00 for CS.D.GBPUSD.MINI.IP - MID OHLC: 1.35555/1.35555/1.35554/1.35554 (Quality: 1.00)
2025-09-12 06:10:05,380 - INFO - igstream.sync_manager - 🚀 Starting chart stream for CS.D.USDJPY.MINI.IP
2025-09-12 06:10:05,380 - INFO - igstream.sync_manager - ✅ Stream CS.D.USDJPY.MINI.IP restart triggered due to: stale_data
2025-09-12 06:10:05,380 - WARNING - igstream.sync_manager - ⚠️ Stream CS.D.AUDUSD.MINI.IP needs restart (stale_data). Reconnecting...
2025-09-12 06:10:05,380 - INFO - igstream.chart_streamer - 🚀 Starting enhanced chart stream for CS.D.USDJPY.MINI.IP
2025-09-12 06:10:05,380 - INFO - igstream.chart_streamer - 🔌 Connecting to Lightstreamer for CS.D.USDJPY.MINI.IP...
2025-09-12 06:10:05,380 - INFO - igstream.chart_streamer - Chart streaming cancelled for CS.D.AUDUSD.MINI.IP
2025-09-12 06:10:05,380 - INFO - igstream.stream_validator - 🛑 Stopping stream validation service...
2025-09-12 06:10:05,380 - INFO - igstream.chart_streamer - 📊 Validation stats for CS.D.AUDUSD.MINI.IP: {'total_validations': 0, 'successful_validations': 0, 'discrepancies_found': 0, 'api_errors': 0, 'corrections_made': 0, 'queue_size': 3, 'success_rate_pct': 0.0, 'processing': False}
2025-09-12 06:10:05,381 - INFO - igstream.chart_streamer - 🔌 Disconnecting Lightstreamer for CS.D.AUDUSD.MINI.IP...
2025-09-12 06:10:05,381 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.USDJPY.MINI.IP: CONNECTING
2025-09-12 06:10:05,382 - INFO - igstream.chart_streamer - ✅ Cleanup complete for CS.D.AUDUSD.MINI.IP
2025-09-12 06:10:05,382 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.AUDUSD.MINI.IP: DISCONNECTED
2025-09-12 06:10:05,382 - INFO - igstream.sync_manager - Stopped stream for CS.D.AUDUSD.MINI.IP
2025-09-12 06:10:05,610 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.USDJPY.MINI.IP: CONNECTED:WS-STREAMING
2025-09-12 06:10:06,380 - INFO - igstream.chart_streamer - ✅ Connected to Lightstreamer for CS.D.USDJPY.MINI.IP
2025-09-12 06:10:06,381 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.USDJPY.MINI.IP:5MINUTE
2025-09-12 06:10:06,381 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.USDJPY.MINI.IP:HOUR
2025-09-12 06:10:06,381 - INFO - igstream.chart_streamer - 📡 All subscriptions active for CS.D.USDJPY.MINI.IP
2025-09-12 06:10:06,381 - INFO - igstream.chart_streamer - 🔍 Stream validation service started for CS.D.USDJPY.MINI.IP
2025-09-12 06:10:06,381 - INFO - igstream.stream_validator - 🚀 Starting stream validation service...
2025-09-12 06:10:06,381 - INFO - igstream.stream_validator -    Validation delay: 300s
2025-09-12 06:10:06,381 - INFO - igstream.stream_validator -    Validation frequency: every 3 candles
2025-09-12 06:10:06,381 - INFO - igstream.stream_validator -    Rate limit: 80 requests/minute
2025-09-12 06:10:06,418 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 5m for CS.D.USDJPY.MINI.IP
2025-09-12 06:10:06,449 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 60m for CS.D.USDJPY.MINI.IP
2025-09-12 06:10:06,465 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 04:05:00 for CS.D.USDJPY.MINI.IP - MID OHLC: 147.45650/147.47550/147.45450/147.47550 (Quality: 1.00)
2025-09-12 06:10:06,474 - INFO - igstream.chart_streamer - 🟢 🆕 60m candle completed at 2025-09-12 04:00:00 for CS.D.USDJPY.MINI.IP - MID OHLC: 147.44650/147.47550/147.44650/147.47550 (Quality: 1.00)
2025-09-12 06:10:07,382 - INFO - igstream.sync_manager - 🚀 Starting chart stream for CS.D.AUDUSD.MINI.IP
2025-09-12 06:10:07,383 - INFO - igstream.sync_manager - ✅ Stream CS.D.AUDUSD.MINI.IP restart triggered due to: stale_data
2025-09-12 06:10:07,383 - WARNING - igstream.sync_manager - ⚠️ Stream CS.D.USDCAD.MINI.IP needs restart (stale_data). Reconnecting...
2025-09-12 06:10:07,383 - INFO - igstream.chart_streamer - 🚀 Starting enhanced chart stream for CS.D.AUDUSD.MINI.IP
2025-09-12 06:10:07,383 - INFO - igstream.chart_streamer - 🔌 Connecting to Lightstreamer for CS.D.AUDUSD.MINI.IP...
2025-09-12 06:10:07,383 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.AUDUSD.MINI.IP: CONNECTING
2025-09-12 06:10:07,383 - INFO - igstream.chart_streamer - Chart streaming cancelled for CS.D.USDCAD.MINI.IP
2025-09-12 06:10:07,384 - INFO - igstream.stream_validator - 🛑 Stopping stream validation service...
2025-09-12 06:10:07,384 - INFO - igstream.chart_streamer - 📊 Validation stats for CS.D.USDCAD.MINI.IP: {'total_validations': 0, 'successful_validations': 0, 'discrepancies_found': 0, 'api_errors': 0, 'corrections_made': 0, 'queue_size': 3, 'success_rate_pct': 0.0, 'processing': False}
2025-09-12 06:10:07,384 - INFO - igstream.chart_streamer - 🔌 Disconnecting Lightstreamer for CS.D.USDCAD.MINI.IP...
2025-09-12 06:10:07,385 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.USDCAD.MINI.IP: DISCONNECTED
2025-09-12 06:10:07,385 - INFO - igstream.chart_streamer - ✅ Cleanup complete for CS.D.USDCAD.MINI.IP
2025-09-12 06:10:07,385 - INFO - igstream.sync_manager - Stopped stream for CS.D.USDCAD.MINI.IP
2025-09-12 06:10:07,609 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.AUDUSD.MINI.IP: CONNECTED:WS-STREAMING
2025-09-12 06:10:08,384 - INFO - igstream.chart_streamer - ✅ Connected to Lightstreamer for CS.D.AUDUSD.MINI.IP
2025-09-12 06:10:08,384 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.AUDUSD.MINI.IP:5MINUTE
2025-09-12 06:10:08,384 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.AUDUSD.MINI.IP:HOUR
2025-09-12 06:10:08,385 - INFO - igstream.chart_streamer - 📡 All subscriptions active for CS.D.AUDUSD.MINI.IP
2025-09-12 06:10:08,385 - INFO - igstream.chart_streamer - 🔍 Stream validation service started for CS.D.AUDUSD.MINI.IP
2025-09-12 06:10:08,385 - INFO - igstream.stream_validator - 🚀 Starting stream validation service...
2025-09-12 06:10:08,385 - INFO - igstream.stream_validator -    Validation delay: 300s
2025-09-12 06:10:08,385 - INFO - igstream.stream_validator -    Validation frequency: every 3 candles
2025-09-12 06:10:08,385 - INFO - igstream.stream_validator -    Rate limit: 80 requests/minute
2025-09-12 06:10:08,422 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 5m for CS.D.AUDUSD.MINI.IP
2025-09-12 06:10:08,453 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 60m for CS.D.AUDUSD.MINI.IP
2025-09-12 06:10:08,464 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 04:10:00 for CS.D.AUDUSD.MINI.IP - MID OHLC: 0.66615/0.66615/0.66615/0.66615 (Quality: 1.00)
2025-09-12 06:10:08,471 - INFO - igstream.chart_streamer - 🟢 🆕 60m candle completed at 2025-09-12 04:00:00 for CS.D.AUDUSD.MINI.IP - MID OHLC: 0.66619/0.66629/0.66611/0.66615 (Quality: 1.00)
2025-09-12 06:10:09,386 - INFO - igstream.sync_manager - 🚀 Starting chart stream for CS.D.USDCAD.MINI.IP
2025-09-12 06:10:09,387 - INFO - igstream.sync_manager - ✅ Stream CS.D.USDCAD.MINI.IP restart triggered due to: stale_data
2025-09-12 06:10:09,387 - WARNING - igstream.sync_manager - ⚠️ Stream CS.D.USDCHF.MINI.IP needs restart (stale_data). Reconnecting...
2025-09-12 06:10:09,387 - INFO - igstream.chart_streamer - 🚀 Starting enhanced chart stream for CS.D.USDCAD.MINI.IP
2025-09-12 06:10:09,387 - INFO - igstream.chart_streamer - 🔌 Connecting to Lightstreamer for CS.D.USDCAD.MINI.IP...
2025-09-12 06:10:09,388 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.USDCAD.MINI.IP: CONNECTING
2025-09-12 06:10:09,388 - INFO - igstream.chart_streamer - Chart streaming cancelled for CS.D.USDCHF.MINI.IP
2025-09-12 06:10:09,389 - INFO - igstream.stream_validator - 🛑 Stopping stream validation service...
2025-09-12 06:10:09,389 - INFO - igstream.chart_streamer - 📊 Validation stats for CS.D.USDCHF.MINI.IP: {'total_validations': 0, 'successful_validations': 0, 'discrepancies_found': 0, 'api_errors': 0, 'corrections_made': 0, 'queue_size': 3, 'success_rate_pct': 0.0, 'processing': False}
2025-09-12 06:10:09,389 - INFO - igstream.chart_streamer - 🔌 Disconnecting Lightstreamer for CS.D.USDCHF.MINI.IP...
2025-09-12 06:10:09,390 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.USDCHF.MINI.IP: DISCONNECTED
2025-09-12 06:10:09,391 - INFO - igstream.chart_streamer - ✅ Cleanup complete for CS.D.USDCHF.MINI.IP
2025-09-12 06:10:09,391 - INFO - igstream.sync_manager - Stopped stream for CS.D.USDCHF.MINI.IP
2025-09-12 06:10:09,613 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.USDCAD.MINI.IP: CONNECTED:WS-STREAMING
2025-09-12 06:10:10,389 - INFO - igstream.chart_streamer - ✅ Connected to Lightstreamer for CS.D.USDCAD.MINI.IP
2025-09-12 06:10:10,390 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.USDCAD.MINI.IP:5MINUTE
2025-09-12 06:10:10,390 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.USDCAD.MINI.IP:HOUR
2025-09-12 06:10:10,390 - INFO - igstream.chart_streamer - 📡 All subscriptions active for CS.D.USDCAD.MINI.IP
2025-09-12 06:10:10,390 - INFO - igstream.chart_streamer - 🔍 Stream validation service started for CS.D.USDCAD.MINI.IP
2025-09-12 06:10:10,390 - INFO - igstream.stream_validator - 🚀 Starting stream validation service...
2025-09-12 06:10:10,390 - INFO - igstream.stream_validator -    Validation delay: 300s
2025-09-12 06:10:10,390 - INFO - igstream.stream_validator -    Validation frequency: every 3 candles
2025-09-12 06:10:10,390 - INFO - igstream.stream_validator -    Rate limit: 80 requests/minute
2025-09-12 06:10:10,426 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 5m for CS.D.USDCAD.MINI.IP
2025-09-12 06:10:10,426 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 60m for CS.D.USDCAD.MINI.IP
2025-09-12 06:10:10,466 - INFO - igstream.chart_streamer - 🟢 🆕 60m candle completed at 2025-09-12 04:00:00 for CS.D.USDCAD.MINI.IP - MID OHLC: 1.38434/1.38443/1.38430/1.38437 (Quality: 1.00)
2025-09-12 06:10:10,471 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 04:10:00 for CS.D.USDCAD.MINI.IP - MID OHLC: 1.38434/1.38437/1.38434/1.38437 (Quality: 1.00)
2025-09-12 06:10:11,391 - INFO - igstream.sync_manager - 🚀 Starting chart stream for CS.D.USDCHF.MINI.IP
2025-09-12 06:10:11,391 - INFO - igstream.sync_manager - ✅ Stream CS.D.USDCHF.MINI.IP restart triggered due to: stale_data
2025-09-12 06:10:11,391 - WARNING - igstream.sync_manager - ⚠️ Stream CS.D.EURUSD.CEEM.IP needs restart (stale_data). Reconnecting...
2025-09-12 06:10:11,392 - INFO - igstream.chart_streamer - 🚀 Starting enhanced chart stream for CS.D.USDCHF.MINI.IP
2025-09-12 06:10:11,392 - INFO - igstream.chart_streamer - 🔌 Connecting to Lightstreamer for CS.D.USDCHF.MINI.IP...
2025-09-12 06:10:11,392 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.USDCHF.MINI.IP: CONNECTING
2025-09-12 06:10:11,392 - INFO - igstream.chart_streamer - Chart streaming cancelled for CS.D.EURUSD.CEEM.IP
2025-09-12 06:10:11,392 - INFO - igstream.stream_validator - 🛑 Stopping stream validation service...
2025-09-12 06:10:11,393 - INFO - igstream.chart_streamer - 📊 Validation stats for CS.D.EURUSD.CEEM.IP: {'total_validations': 0, 'successful_validations': 0, 'discrepancies_found': 0, 'api_errors': 0, 'corrections_made': 0, 'queue_size': 3, 'success_rate_pct': 0.0, 'processing': False}
2025-09-12 06:10:11,393 - INFO - igstream.chart_streamer - 🔌 Disconnecting Lightstreamer for CS.D.EURUSD.CEEM.IP...
2025-09-12 06:10:11,393 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.EURUSD.CEEM.IP: DISCONNECTED
2025-09-12 06:10:11,394 - INFO - igstream.chart_streamer - ✅ Cleanup complete for CS.D.EURUSD.CEEM.IP
2025-09-12 06:10:11,394 - INFO - igstream.sync_manager - Stopped stream for CS.D.EURUSD.CEEM.IP
2025-09-12 06:10:11,671 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.USDCHF.MINI.IP: CONNECTED:WS-STREAMING
2025-09-12 06:10:12,393 - INFO - igstream.chart_streamer - ✅ Connected to Lightstreamer for CS.D.USDCHF.MINI.IP
2025-09-12 06:10:12,393 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.USDCHF.MINI.IP:5MINUTE
2025-09-12 06:10:12,393 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.USDCHF.MINI.IP:HOUR
2025-09-12 06:10:12,393 - INFO - igstream.chart_streamer - 📡 All subscriptions active for CS.D.USDCHF.MINI.IP
2025-09-12 06:10:12,394 - INFO - igstream.chart_streamer - 🔍 Stream validation service started for CS.D.USDCHF.MINI.IP
2025-09-12 06:10:12,394 - INFO - igstream.stream_validator - 🚀 Starting stream validation service...
2025-09-12 06:10:12,394 - INFO - igstream.stream_validator -    Validation delay: 300s
2025-09-12 06:10:12,394 - INFO - igstream.stream_validator -    Validation frequency: every 3 candles
2025-09-12 06:10:12,394 - INFO - igstream.stream_validator -    Rate limit: 80 requests/minute
2025-09-12 06:10:12,431 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 5m for CS.D.USDCHF.MINI.IP
2025-09-12 06:10:12,431 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 60m for CS.D.USDCHF.MINI.IP
2025-09-12 06:10:12,471 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 04:10:00 for CS.D.USDCHF.MINI.IP - MID OHLC: 0.79664/0.79664/0.79663/0.79664 (Quality: 1.00)
2025-09-12 06:10:12,476 - INFO - igstream.chart_streamer - 🟢 🆕 60m candle completed at 2025-09-12 04:00:00 for CS.D.USDCHF.MINI.IP - MID OHLC: 0.79648/0.79668/0.79648/0.79664 (Quality: 1.00)
2025-09-12 06:10:13,394 - INFO - igstream.sync_manager - 🚀 Starting chart stream for CS.D.EURUSD.CEEM.IP
2025-09-12 06:10:13,395 - INFO - igstream.sync_manager - ✅ Stream CS.D.EURUSD.CEEM.IP restart triggered due to: stale_data
2025-09-12 06:10:13,395 - INFO - igstream.chart_streamer - 🚀 Starting enhanced chart stream for CS.D.EURUSD.CEEM.IP
2025-09-12 06:10:13,395 - INFO - igstream.chart_streamer - 🔌 Connecting to Lightstreamer for CS.D.EURUSD.CEEM.IP...
2025-09-12 06:10:13,395 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.EURUSD.CEEM.IP: CONNECTING
2025-09-12 06:10:13,622 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.EURUSD.CEEM.IP: CONNECTED:WS-STREAMING
2025-09-12 06:10:14,397 - INFO - igstream.chart_streamer - ✅ Connected to Lightstreamer for CS.D.EURUSD.CEEM.IP
2025-09-12 06:10:14,398 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.EURUSD.CEEM.IP:5MINUTE
2025-09-12 06:10:14,399 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.EURUSD.CEEM.IP:HOUR
2025-09-12 06:10:14,400 - INFO - igstream.chart_streamer - 📡 All subscriptions active for CS.D.EURUSD.CEEM.IP
2025-09-12 06:10:14,400 - INFO - igstream.chart_streamer - 🔍 Stream validation service started for CS.D.EURUSD.CEEM.IP
2025-09-12 06:10:14,401 - INFO - igstream.stream_validator - 🚀 Starting stream validation service...
2025-09-12 06:10:14,401 - INFO - igstream.stream_validator -    Validation delay: 300s
2025-09-12 06:10:14,402 - INFO - igstream.stream_validator -    Validation frequency: every 3 candles
2025-09-12 06:10:14,402 - INFO - igstream.stream_validator -    Rate limit: 80 requests/minute
2025-09-12 06:10:14,437 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 5m for CS.D.EURUSD.CEEM.IP
2025-09-12 06:10:14,467 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 60m for CS.D.EURUSD.CEEM.IP
2025-09-12 06:10:14,483 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 04:10:00 for CS.D.EURUSD.CEEM.IP - MID OHLC: 1.17230/1.17230/1.17228/1.17228 (Quality: 1.00)
2025-09-12 06:10:14,491 - INFO - igstream.chart_streamer - 🟢 🆕 60m candle completed at 2025-09-12 04:00:00 for CS.D.EURUSD.CEEM.IP - MID OHLC: 1.17256/1.17257/1.17226/1.17228 (Quality: 1.00)
2025-09-12 06:10:24,074 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 04:10:00 for CS.D.USDJPY.MINI.IP - MID OHLC: 147.47600/147.47600/147.47600/147.47600 (Quality: 1.00)
2025-09-12 06:11:13,401 - INFO - igstream.sync_manager - 📊 Database stats: 63 candles in last 30min, latest: 2025-09-12 04:10:00
2025-09-12 06:12:13,428 - INFO - igstream.sync_manager - 📊 Database stats: 63 candles in last 30min, latest: 2025-09-12 04:10:00
2025-09-12 06:13:13,453 - INFO - igstream.sync_manager - 📊 Database stats: 63 candles in last 30min, latest: 2025-09-12 04:10:00
2025-09-12 06:14:01,428 - INFO - igstream.auto_backfill - Running automated gap detection and backfill...
2025-09-12 06:14:13,478 - INFO - igstream.sync_manager - 📊 Database stats: 63 candles in last 30min, latest: 2025-09-12 04:10:00
2025-09-12 06:14:13,492 - INFO - igstream.sync_manager - 🔍 Running gap detection check...
2025-09-12 06:14:13,614 - INFO - igstream.sync_manager - ✅ No gaps detected in candle data
2025-09-12 06:15:00,884 - INFO - httpx - HTTP Request: GET https://api.ig.com/gateway/deal/prices/CS.D.AUDJPY.MINI.IP?resolution=MINUTE_5&from=2025-09-12T04%3A05%3A00&to=2025-09-12T04%3A10%3A00&max=2 "HTTP/1.1 404 Not Found"
2025-09-12 06:15:00,885 - ERROR - igstream.stream_validator - ❌ API validation error for CS.D.AUDJPY.MINI.IP: Client error '404 Not Found' for url 'https://api.ig.com/gateway/deal/prices/CS.D.AUDJPY.MINI.IP?resolution=MINUTE_5&from=2025-09-12T04%3A05%3A00&to=2025-09-12T04%3A10%3A00&max=2'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404
2025-09-12 06:15:00,892 - INFO - httpx - HTTP Request: GET https://api.ig.com/gateway/deal/prices/CS.D.NZDUSD.MINI.IP?resolution=MINUTE_5&from=2025-09-12T04%3A05%3A00&to=2025-09-12T04%3A10%3A00&max=2 "HTTP/1.1 404 Not Found"
2025-09-12 06:15:00,892 - INFO - httpx - HTTP Request: GET https://api.ig.com/gateway/deal/prices/CS.D.EURJPY.MINI.IP?resolution=MINUTE_5&from=2025-09-12T04%3A05%3A00&to=2025-09-12T04%3A10%3A00&max=2 "HTTP/1.1 404 Not Found"
2025-09-12 06:15:00,893 - ERROR - igstream.stream_validator - ❌ API validation error for CS.D.NZDUSD.MINI.IP: Client error '404 Not Found' for url 'https://api.ig.com/gateway/deal/prices/CS.D.NZDUSD.MINI.IP?resolution=MINUTE_5&from=2025-09-12T04%3A05%3A00&to=2025-09-12T04%3A10%3A00&max=2'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404
2025-09-12 06:15:00,897 - ERROR - igstream.stream_validator - ❌ API validation error for CS.D.EURJPY.MINI.IP: Client error '404 Not Found' for url 'https://api.ig.com/gateway/deal/prices/CS.D.EURJPY.MINI.IP?resolution=MINUTE_5&from=2025-09-12T04%3A05%3A00&to=2025-09-12T04%3A10%3A00&max=2'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404
2025-09-12 06:15:01,051 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 04:15:00 for CS.D.AUDUSD.MINI.IP - MID OHLC: 0.66616/0.66616/0.66614/0.66614 (Quality: 1.00)
2025-09-12 06:15:01,057 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 04:15:00 for CS.D.EURJPY.MINI.IP - MID OHLC: 172.94750/172.94750/172.94750/172.94750 (Quality: 1.00)
2025-09-12 06:15:01,071 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 04:15:00 for CS.D.USDJPY.MINI.IP - MID OHLC: 147.52250/147.52350/147.52250/147.52350 (Quality: 1.00)
2025-09-12 06:15:01,082 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 04:15:00 for CS.D.EURUSD.CEEM.IP - MID OHLC: 1.17227/1.17227/1.17226/1.17226 (Quality: 1.00)
2025-09-12 06:15:01,092 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 04:15:00 for CS.D.AUDJPY.MINI.IP - MID OHLC: 98.28100/98.28100/98.28100/98.28100 (Quality: 1.00)
2025-09-12 06:15:01,105 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 04:15:00 for CS.D.USDCAD.MINI.IP - MID OHLC: 1.38431/1.38431/1.38431/1.38431 (Quality: 1.00)
2025-09-12 06:15:04,060 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 04:15:00 for CS.D.GBPUSD.MINI.IP - MID OHLC: 1.35542/1.35542/1.35542/1.35542 (Quality: 1.00)
2025-09-12 06:15:04,119 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 04:15:00 for CS.D.USDCHF.MINI.IP - MID OHLC: 0.79680/0.79682/0.79680/0.79682 (Quality: 1.00)
2025-09-12 06:15:06,055 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 04:15:00 for CS.D.NZDUSD.MINI.IP - MID OHLC: 0.59698/0.59699/0.59698/0.59698 (Quality: 1.00)
2025-09-12 06:15:06,743 - INFO - httpx - HTTP Request: GET https://api.ig.com/gateway/deal/prices/CS.D.USDJPY.MINI.IP?resolution=MINUTE_5&from=2025-09-12T04%3A05%3A00&to=2025-09-12T04%3A10%3A00&max=2 "HTTP/1.1 404 Not Found"
2025-09-12 06:15:06,744 - ERROR - igstream.stream_validator - ❌ API validation error for CS.D.USDJPY.MINI.IP: Client error '404 Not Found' for url 'https://api.ig.com/gateway/deal/prices/CS.D.USDJPY.MINI.IP?resolution=MINUTE_5&from=2025-09-12T04%3A05%3A00&to=2025-09-12T04%3A10%3A00&max=2'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404
2025-09-12 06:15:13,620 - INFO - igstream.sync_manager - 📊 Database stats: 63 candles in last 30min, latest: 2025-09-12 04:15:00
2025-09-12 06:16:13,646 - INFO - igstream.sync_manager - 📊 Database stats: 63 candles in last 30min, latest: 2025-09-12 04:15:00
2025-09-12 06:17:13,676 - INFO - igstream.sync_manager - 📊 Database stats: 63 candles in last 30min, latest: 2025-09-12 04:15:00
2025-09-12 06:17:41,030 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.OperationalError) connection to server at "postgres" (172.18.0.3), port 5432 failed: FATAL:  the database system is shutting down

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-09-12 06:17:41,044 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 1311, in _checkout
    raise exc.InvalidatePoolError()
sqlalchemy.exc.InvalidatePoolError: ()

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 143, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3301, in raw_connection
    return self.pool.connect()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 447, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 1345, in _checkout
    with util.safe_reraise():
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 1342, in _checkout
    fairy._connection_record.get_connection()
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 836, in get_connection
    self.__connect()
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 899, in __connect
    with util.safe_reraise():
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 895, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 661, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 629, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.OperationalError: connection to server at "postgres" (172.18.0.3), port 5432 failed: FATAL:  the database system is shutting down


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2241, in _execute_internal
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2110, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
           ^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3277, in connect
    return self._connection_cls(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    Connection._handle_dbapi_exception_noconnection(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2440, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 143, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3301, in raw_connection
    return self.pool.connect()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 447, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 1345, in _checkout
    with util.safe_reraise():
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 1342, in _checkout
    fairy._connection_record.get_connection()
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 836, in get_connection
    self.__connect()
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 899, in __connect
    with util.safe_reraise():
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 895, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 661, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 629, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "postgres" (172.18.0.3), port 5432 failed: FATAL:  the database system is shutting down

(Background on this error at: https://sqlalche.me/e/20/e3q8)

2025-09-12 06:17:41,058 - ERROR - igstream.chart_streamer - ❌ Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.OperationalError) connection to server at "postgres" (172.18.0.3), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-09-12 06:17:41,059 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 143, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3301, in raw_connection
    return self.pool.connect()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 447, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    with util.safe_reraise():
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 714, in checkout
    dbapi_connection = rec.get_connection()
                       ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 836, in get_connection
    self.__connect()
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 899, in __connect
    with util.safe_reraise():
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 895, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 661, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 629, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.OperationalError: connection to server at "postgres" (172.18.0.3), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2241, in _execute_internal
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2110, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
           ^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3277, in connect
    return self._connection_cls(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    Connection._handle_dbapi_exception_noconnection(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2440, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 143, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3301, in raw_connection
    return self.pool.connect()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 447, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    with util.safe_reraise():
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 714, in checkout
    dbapi_connection = rec.get_connection()
                       ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 836, in get_connection
    self.__connect()
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 899, in __connect
    with util.safe_reraise():
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 895, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 661, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 629, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "postgres" (172.18.0.3), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/20/e3q8)

2025-09-12 06:17:41,180 - INFO - igstream.auto_backfill - Stopping auto-backfill service...
2025-09-12 06:17:41,180 - INFO - root - ✅ Auto-backfill service stopped
2025-09-12 06:17:41,180 - INFO - igstream.sync_manager - 🛑 Stopping all streams...
2025-09-12 06:17:41,180 - INFO - igstream.chart_streamer - Chart streaming cancelled for CS.D.EURJPY.MINI.IP
2025-09-12 06:17:41,180 - INFO - igstream.stream_validator - 🛑 Stopping stream validation service...
2025-09-12 06:17:41,180 - INFO - igstream.chart_streamer - 📊 Validation stats for CS.D.EURJPY.MINI.IP: {'total_validations': 1, 'successful_validations': 0, 'discrepancies_found': 0, 'api_errors': 0, 'corrections_made': 0, 'queue_size': 2, 'success_rate_pct': 0.0, 'processing': False}
2025-09-12 06:17:41,180 - INFO - igstream.chart_streamer - 🔌 Disconnecting Lightstreamer for CS.D.EURJPY.MINI.IP...
2025-09-12 06:17:41,181 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.EURJPY.MINI.IP: DISCONNECTED
2025-09-12 06:17:41,181 - INFO - igstream.chart_streamer - ✅ Cleanup complete for CS.D.EURJPY.MINI.IP
2025-09-12 06:17:41,182 - INFO - igstream.chart_streamer - Chart streaming cancelled for CS.D.AUDJPY.MINI.IP
2025-09-12 06:17:41,182 - INFO - igstream.stream_validator - 🛑 Stopping stream validation service...
2025-09-12 06:17:41,182 - INFO - igstream.chart_streamer - 📊 Validation stats for CS.D.AUDJPY.MINI.IP: {'total_validations': 1, 'successful_validations': 0, 'discrepancies_found': 0, 'api_errors': 0, 'corrections_made': 0, 'queue_size': 2, 'success_rate_pct': 0.0, 'processing': False}
2025-09-12 06:17:41,182 - INFO - igstream.chart_streamer - 🔌 Disconnecting Lightstreamer for CS.D.AUDJPY.MINI.IP...
2025-09-12 06:17:41,182 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.AUDJPY.MINI.IP: DISCONNECTED
2025-09-12 06:17:41,182 - INFO - igstream.chart_streamer - ✅ Cleanup complete for CS.D.AUDJPY.MINI.IP
2025-09-12 06:17:41,183 - INFO - igstream.chart_streamer - Chart streaming cancelled for CS.D.NZDUSD.MINI.IP
2025-09-12 06:17:41,183 - INFO - igstream.stream_validator - 🛑 Stopping stream validation service...
2025-09-12 06:17:41,183 - INFO - igstream.chart_streamer - 📊 Validation stats for CS.D.NZDUSD.MINI.IP: {'total_validations': 1, 'successful_validations': 0, 'discrepancies_found': 0, 'api_errors': 0, 'corrections_made': 0, 'queue_size': 2, 'success_rate_pct': 0.0, 'processing': False}
2025-09-12 06:17:41,183 - INFO - igstream.chart_streamer - 🔌 Disconnecting Lightstreamer for CS.D.NZDUSD.MINI.IP...
2025-09-12 06:17:41,183 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.NZDUSD.MINI.IP: DISCONNECTED
2025-09-12 06:17:41,184 - INFO - igstream.chart_streamer - ✅ Cleanup complete for CS.D.NZDUSD.MINI.IP
2025-09-12 06:17:41,184 - INFO - igstream.chart_streamer - Chart streaming cancelled for CS.D.GBPUSD.MINI.IP
2025-09-12 06:17:41,184 - INFO - igstream.stream_validator - 🛑 Stopping stream validation service...
2025-09-12 06:17:41,184 - INFO - igstream.chart_streamer - 📊 Validation stats for CS.D.GBPUSD.MINI.IP: {'total_validations': 0, 'successful_validations': 0, 'discrepancies_found': 0, 'api_errors': 0, 'corrections_made': 0, 'queue_size': 3, 'success_rate_pct': 0.0, 'processing': False}
2025-09-12 06:17:41,184 - INFO - igstream.chart_streamer - 🔌 Disconnecting Lightstreamer for CS.D.GBPUSD.MINI.IP...
2025-09-12 06:17:41,184 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.GBPUSD.MINI.IP: DISCONNECTED
2025-09-12 06:17:41,184 - INFO - igstream.chart_streamer - ✅ Cleanup complete for CS.D.GBPUSD.MINI.IP
2025-09-12 06:17:41,185 - INFO - igstream.chart_streamer - Chart streaming cancelled for CS.D.USDJPY.MINI.IP
2025-09-12 06:17:41,185 - INFO - igstream.stream_validator - 🛑 Stopping stream validation service...
2025-09-12 06:17:41,185 - INFO - igstream.chart_streamer - 📊 Validation stats for CS.D.USDJPY.MINI.IP: {'total_validations': 1, 'successful_validations': 0, 'discrepancies_found': 0, 'api_errors': 0, 'corrections_made': 0, 'queue_size': 3, 'success_rate_pct': 0.0, 'processing': False}
2025-09-12 06:17:41,185 - INFO - igstream.chart_streamer - 🔌 Disconnecting Lightstreamer for CS.D.USDJPY.MINI.IP...
2025-09-12 06:17:41,185 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.USDJPY.MINI.IP: DISCONNECTED
2025-09-12 06:17:41,186 - INFO - igstream.chart_streamer - ✅ Cleanup complete for CS.D.USDJPY.MINI.IP
2025-09-12 06:17:41,186 - INFO - igstream.chart_streamer - Chart streaming cancelled for CS.D.AUDUSD.MINI.IP
2025-09-12 06:17:41,186 - INFO - igstream.stream_validator - 🛑 Stopping stream validation service...
2025-09-12 06:17:41,186 - INFO - igstream.chart_streamer - 📊 Validation stats for CS.D.AUDUSD.MINI.IP: {'total_validations': 0, 'successful_validations': 0, 'discrepancies_found': 0, 'api_errors': 0, 'corrections_made': 0, 'queue_size': 3, 'success_rate_pct': 0.0, 'processing': False}
2025-09-12 06:17:41,186 - INFO - igstream.chart_streamer - 🔌 Disconnecting Lightstreamer for CS.D.AUDUSD.MINI.IP...
2025-09-12 06:17:41,186 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.AUDUSD.MINI.IP: DISCONNECTED
2025-09-12 06:17:41,187 - INFO - igstream.chart_streamer - ✅ Cleanup complete for CS.D.AUDUSD.MINI.IP
2025-09-12 06:17:41,187 - INFO - igstream.chart_streamer - Chart streaming cancelled for CS.D.USDCAD.MINI.IP
2025-09-12 06:17:41,187 - INFO - igstream.stream_validator - 🛑 Stopping stream validation service...
2025-09-12 06:17:41,187 - INFO - igstream.chart_streamer - 📊 Validation stats for CS.D.USDCAD.MINI.IP: {'total_validations': 0, 'successful_validations': 0, 'discrepancies_found': 0, 'api_errors': 0, 'corrections_made': 0, 'queue_size': 3, 'success_rate_pct': 0.0, 'processing': False}
2025-09-12 06:17:41,187 - INFO - igstream.chart_streamer - 🔌 Disconnecting Lightstreamer for CS.D.USDCAD.MINI.IP...
2025-09-12 06:17:41,187 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.USDCAD.MINI.IP: DISCONNECTED
2025-09-12 06:17:41,187 - INFO - igstream.chart_streamer - ✅ Cleanup complete for CS.D.USDCAD.MINI.IP
2025-09-12 06:17:41,188 - INFO - igstream.chart_streamer - Chart streaming cancelled for CS.D.USDCHF.MINI.IP
2025-09-12 06:17:41,188 - INFO - igstream.stream_validator - 🛑 Stopping stream validation service...
2025-09-12 06:17:41,188 - INFO - igstream.chart_streamer - 📊 Validation stats for CS.D.USDCHF.MINI.IP: {'total_validations': 0, 'successful_validations': 0, 'discrepancies_found': 0, 'api_errors': 0, 'corrections_made': 0, 'queue_size': 3, 'success_rate_pct': 0.0, 'processing': False}
2025-09-12 06:17:41,188 - INFO - igstream.chart_streamer - 🔌 Disconnecting Lightstreamer for CS.D.USDCHF.MINI.IP...
2025-09-12 06:17:41,188 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.USDCHF.MINI.IP: DISCONNECTED
2025-09-12 06:17:41,189 - INFO - igstream.chart_streamer - ✅ Cleanup complete for CS.D.USDCHF.MINI.IP
2025-09-12 06:17:41,189 - INFO - igstream.chart_streamer - Chart streaming cancelled for CS.D.EURUSD.CEEM.IP
2025-09-12 06:17:41,189 - INFO - igstream.stream_validator - 🛑 Stopping stream validation service...
2025-09-12 06:17:41,189 - INFO - igstream.chart_streamer - 📊 Validation stats for CS.D.EURUSD.CEEM.IP: {'total_validations': 0, 'successful_validations': 0, 'discrepancies_found': 0, 'api_errors': 0, 'corrections_made': 0, 'queue_size': 3, 'success_rate_pct': 0.0, 'processing': False}
2025-09-12 06:17:41,189 - INFO - igstream.chart_streamer - 🔌 Disconnecting Lightstreamer for CS.D.EURUSD.CEEM.IP...
2025-09-12 06:17:41,189 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.EURUSD.CEEM.IP: DISCONNECTED
2025-09-12 06:17:41,190 - INFO - igstream.chart_streamer - ✅ Cleanup complete for CS.D.EURUSD.CEEM.IP
2025-09-12 06:17:41,390 - INFO - igstream.sync_manager - ✅ All streams shut down.
2025-09-12 06:19:57,919 - INFO - igstream.sync_manager - 🚀 Starting all forex streams...
2025-09-12 06:19:57,919 - INFO - igstream.sync_manager - 🔑 Refreshing IG session...
2025-09-12 06:19:58,110 - INFO - httpx - HTTP Request: POST https://api.ig.com/gateway/deal/session "HTTP/1.1 200 OK"
2025-09-12 06:19:58,111 - INFO - igstream.ig_auth_prod - IG Login successful
2025-09-12 06:19:58,111 - INFO - igstream.sync_manager - ✅ Auth refreshed successfully
2025-09-12 06:19:58,111 - INFO - igstream.sync_manager - 🚀 Starting chart stream for CS.D.GBPUSD.MINI.IP
2025-09-12 06:19:58,111 - INFO - igstream.chart_streamer - 🚀 Starting enhanced chart stream for CS.D.GBPUSD.MINI.IP
2025-09-12 06:19:58,111 - INFO - igstream.chart_streamer - 🔌 Connecting to Lightstreamer for CS.D.GBPUSD.MINI.IP...
2025-09-12 06:19:58,116 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.GBPUSD.MINI.IP: CONNECTING
2025-09-12 06:19:58,418 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.GBPUSD.MINI.IP: CONNECTED:WS-STREAMING
2025-09-12 06:19:59,113 - INFO - igstream.sync_manager - 🚀 Starting chart stream for CS.D.USDJPY.MINI.IP
2025-09-12 06:19:59,113 - INFO - igstream.chart_streamer - ✅ Connected to Lightstreamer for CS.D.GBPUSD.MINI.IP
2025-09-12 06:19:59,114 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.GBPUSD.MINI.IP:5MINUTE
2025-09-12 06:19:59,114 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.GBPUSD.MINI.IP:HOUR
2025-09-12 06:19:59,114 - INFO - igstream.chart_streamer - 📡 All subscriptions active for CS.D.GBPUSD.MINI.IP
2025-09-12 06:19:59,114 - INFO - igstream.chart_streamer - 🔍 Stream validation service started for CS.D.GBPUSD.MINI.IP
2025-09-12 06:19:59,114 - INFO - igstream.chart_streamer - 🚀 Starting enhanced chart stream for CS.D.USDJPY.MINI.IP
2025-09-12 06:19:59,115 - INFO - igstream.chart_streamer - 🔌 Connecting to Lightstreamer for CS.D.USDJPY.MINI.IP...
2025-09-12 06:19:59,115 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.USDJPY.MINI.IP: CONNECTING
2025-09-12 06:19:59,115 - INFO - igstream.stream_validator - 🚀 Starting stream validation service...
2025-09-12 06:19:59,115 - INFO - igstream.stream_validator -    Validation delay: 300s
2025-09-12 06:19:59,115 - INFO - igstream.stream_validator -    Validation frequency: every 3 candles
2025-09-12 06:19:59,115 - INFO - igstream.stream_validator -    Rate limit: 80 requests/minute
2025-09-12 06:19:59,154 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 5m for CS.D.GBPUSD.MINI.IP
2025-09-12 06:19:59,154 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 60m for CS.D.GBPUSD.MINI.IP
2025-09-12 06:19:59,197 - INFO - igstream.chart_streamer - 🟢 🆕 60m candle completed at 2025-09-12 04:00:00 for CS.D.GBPUSD.MINI.IP - MID OHLC: 1.35555/1.35566/1.35528/1.35537 (Quality: 1.00)
2025-09-12 06:19:59,200 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 04:15:00 for CS.D.GBPUSD.MINI.IP - MID OHLC: 1.35542/1.35554/1.35528/1.35537 (Quality: 1.00)
2025-09-12 06:19:59,369 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.USDJPY.MINI.IP: CONNECTED:WS-STREAMING
2025-09-12 06:20:00,115 - INFO - igstream.sync_manager - 🚀 Starting chart stream for CS.D.AUDUSD.MINI.IP
2025-09-12 06:20:00,115 - INFO - igstream.chart_streamer - 🚀 Starting enhanced chart stream for CS.D.AUDUSD.MINI.IP
2025-09-12 06:20:00,115 - INFO - igstream.chart_streamer - 🔌 Connecting to Lightstreamer for CS.D.AUDUSD.MINI.IP...
2025-09-12 06:20:00,116 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.AUDUSD.MINI.IP: CONNECTING
2025-09-12 06:20:00,116 - INFO - igstream.chart_streamer - ✅ Connected to Lightstreamer for CS.D.USDJPY.MINI.IP
2025-09-12 06:20:00,117 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.USDJPY.MINI.IP:5MINUTE
2025-09-12 06:20:00,117 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.USDJPY.MINI.IP:HOUR
2025-09-12 06:20:00,117 - INFO - igstream.chart_streamer - 📡 All subscriptions active for CS.D.USDJPY.MINI.IP
2025-09-12 06:20:00,117 - INFO - igstream.chart_streamer - 🔍 Stream validation service started for CS.D.USDJPY.MINI.IP
2025-09-12 06:20:00,118 - INFO - igstream.stream_validator - 🚀 Starting stream validation service...
2025-09-12 06:20:00,118 - INFO - igstream.stream_validator -    Validation delay: 300s
2025-09-12 06:20:00,118 - INFO - igstream.stream_validator -    Validation frequency: every 3 candles
2025-09-12 06:20:00,118 - INFO - igstream.stream_validator -    Rate limit: 80 requests/minute
2025-09-12 06:20:00,153 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 5m for CS.D.USDJPY.MINI.IP
2025-09-12 06:20:00,154 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 60m for CS.D.USDJPY.MINI.IP
2025-09-12 06:20:00,191 - INFO - igstream.chart_streamer - 🟡 🆕 60m candle completed at 2025-09-12 04:00:00 for CS.D.USDJPY.MINI.IP - MID OHLC: 147.44650/147.53950/147.44650/147.52600 (Quality: 0.70)
2025-09-12 06:20:00,195 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 04:15:00 for CS.D.USDJPY.MINI.IP - MID OHLC: 147.52250/147.53000/147.51100/147.52600 (Quality: 1.00)
2025-09-12 06:20:00,406 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.AUDUSD.MINI.IP: CONNECTED:WS-STREAMING
2025-09-12 06:20:01,076 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 04:20:00 for CS.D.USDJPY.MINI.IP - MID OHLC: 147.52500/147.52500/147.52500/147.52500 (Quality: 1.00)
2025-09-12 06:20:01,116 - INFO - igstream.sync_manager - 🚀 Starting chart stream for CS.D.USDCAD.MINI.IP
2025-09-12 06:20:01,116 - INFO - igstream.chart_streamer - ✅ Connected to Lightstreamer for CS.D.AUDUSD.MINI.IP
2025-09-12 06:20:01,117 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.AUDUSD.MINI.IP:5MINUTE
2025-09-12 06:20:01,117 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.AUDUSD.MINI.IP:HOUR
2025-09-12 06:20:01,117 - INFO - igstream.chart_streamer - 📡 All subscriptions active for CS.D.AUDUSD.MINI.IP
2025-09-12 06:20:01,118 - INFO - igstream.chart_streamer - 🔍 Stream validation service started for CS.D.AUDUSD.MINI.IP
2025-09-12 06:20:01,118 - INFO - igstream.chart_streamer - 🚀 Starting enhanced chart stream for CS.D.USDCAD.MINI.IP
2025-09-12 06:20:01,118 - INFO - igstream.chart_streamer - 🔌 Connecting to Lightstreamer for CS.D.USDCAD.MINI.IP...
2025-09-12 06:20:01,118 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.USDCAD.MINI.IP: CONNECTING
2025-09-12 06:20:01,119 - INFO - igstream.stream_validator - 🚀 Starting stream validation service...
2025-09-12 06:20:01,119 - INFO - igstream.stream_validator -    Validation delay: 300s
2025-09-12 06:20:01,119 - INFO - igstream.stream_validator -    Validation frequency: every 3 candles
2025-09-12 06:20:01,119 - INFO - igstream.stream_validator -    Rate limit: 80 requests/minute
2025-09-12 06:20:01,156 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 5m for CS.D.AUDUSD.MINI.IP
2025-09-12 06:20:01,156 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 60m for CS.D.AUDUSD.MINI.IP
2025-09-12 06:20:01,190 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 04:15:00 for CS.D.AUDUSD.MINI.IP - MID OHLC: 0.66616/0.66621/0.66594/0.66606 (Quality: 1.00)
2025-09-12 06:20:01,195 - INFO - igstream.chart_streamer - 🟢 🆕 60m candle completed at 2025-09-12 04:00:00 for CS.D.AUDUSD.MINI.IP - MID OHLC: 0.66619/0.66629/0.66594/0.66606 (Quality: 1.00)
2025-09-12 06:20:01,372 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.USDCAD.MINI.IP: CONNECTED:WS-STREAMING
2025-09-12 06:20:02,117 - INFO - igstream.sync_manager - 🚀 Starting chart stream for CS.D.EURJPY.MINI.IP
2025-09-12 06:20:02,117 - INFO - igstream.chart_streamer - 🚀 Starting enhanced chart stream for CS.D.EURJPY.MINI.IP
2025-09-12 06:20:02,118 - INFO - igstream.chart_streamer - 🔌 Connecting to Lightstreamer for CS.D.EURJPY.MINI.IP...
2025-09-12 06:20:02,119 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.EURJPY.MINI.IP: CONNECTING
2025-09-12 06:20:02,119 - INFO - igstream.chart_streamer - ✅ Connected to Lightstreamer for CS.D.USDCAD.MINI.IP
2025-09-12 06:20:02,120 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.USDCAD.MINI.IP:5MINUTE
2025-09-12 06:20:02,120 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.USDCAD.MINI.IP:HOUR
2025-09-12 06:20:02,121 - INFO - igstream.chart_streamer - 📡 All subscriptions active for CS.D.USDCAD.MINI.IP
2025-09-12 06:20:02,123 - INFO - igstream.chart_streamer - 🔍 Stream validation service started for CS.D.USDCAD.MINI.IP
2025-09-12 06:20:02,123 - INFO - igstream.stream_validator - 🚀 Starting stream validation service...
2025-09-12 06:20:02,123 - INFO - igstream.stream_validator -    Validation delay: 300s
2025-09-12 06:20:02,123 - INFO - igstream.stream_validator -    Validation frequency: every 3 candles
2025-09-12 06:20:02,123 - INFO - igstream.stream_validator -    Rate limit: 80 requests/minute
2025-09-12 06:20:02,155 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 60m for CS.D.USDCAD.MINI.IP
2025-09-12 06:20:02,155 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 5m for CS.D.USDCAD.MINI.IP
2025-09-12 06:20:02,194 - INFO - igstream.chart_streamer - 🟢 🆕 60m candle completed at 2025-09-12 04:00:00 for CS.D.USDCAD.MINI.IP - MID OHLC: 1.38434/1.38445/1.38416/1.38427 (Quality: 1.00)
2025-09-12 06:20:02,200 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 04:15:00 for CS.D.USDCAD.MINI.IP - MID OHLC: 1.38431/1.38433/1.38416/1.38427 (Quality: 1.00)
2025-09-12 06:20:02,348 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.EURJPY.MINI.IP: CONNECTED:WS-STREAMING
2025-09-12 06:20:03,118 - INFO - igstream.sync_manager - 🚀 Starting chart stream for CS.D.AUDJPY.MINI.IP
2025-09-12 06:20:03,118 - INFO - igstream.chart_streamer - 🚀 Starting enhanced chart stream for CS.D.AUDJPY.MINI.IP
2025-09-12 06:20:03,118 - INFO - igstream.chart_streamer - 🔌 Connecting to Lightstreamer for CS.D.AUDJPY.MINI.IP...
2025-09-12 06:20:03,119 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.AUDJPY.MINI.IP: CONNECTING
2025-09-12 06:20:03,120 - INFO - igstream.chart_streamer - ✅ Connected to Lightstreamer for CS.D.EURJPY.MINI.IP
2025-09-12 06:20:03,120 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.EURJPY.MINI.IP:5MINUTE
2025-09-12 06:20:03,120 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.EURJPY.MINI.IP:HOUR
2025-09-12 06:20:03,120 - INFO - igstream.chart_streamer - 📡 All subscriptions active for CS.D.EURJPY.MINI.IP
2025-09-12 06:20:03,120 - INFO - igstream.chart_streamer - 🔍 Stream validation service started for CS.D.EURJPY.MINI.IP
2025-09-12 06:20:03,120 - INFO - igstream.stream_validator - 🚀 Starting stream validation service...
2025-09-12 06:20:03,121 - INFO - igstream.stream_validator -    Validation delay: 300s
2025-09-12 06:20:03,121 - INFO - igstream.stream_validator -    Validation frequency: every 3 candles
2025-09-12 06:20:03,121 - INFO - igstream.stream_validator -    Rate limit: 80 requests/minute
2025-09-12 06:20:03,158 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 60m for CS.D.EURJPY.MINI.IP
2025-09-12 06:20:03,158 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 5m for CS.D.EURJPY.MINI.IP
2025-09-12 06:20:03,198 - INFO - igstream.chart_streamer - 🟢 🆕 60m candle completed at 2025-09-12 04:00:00 for CS.D.EURJPY.MINI.IP - MID OHLC: 172.90550/172.95950/172.89050/172.94750 (Quality: 1.00)
2025-09-12 06:20:03,204 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 04:20:00 for CS.D.EURJPY.MINI.IP - MID OHLC: 172.94750/172.94750/172.94550/172.94750 (Quality: 1.00)
2025-09-12 06:20:03,370 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.AUDJPY.MINI.IP: CONNECTED:WS-STREAMING
2025-09-12 06:20:04,119 - INFO - igstream.sync_manager - 🚀 Starting chart stream for CS.D.NZDUSD.MINI.IP
2025-09-12 06:20:04,120 - INFO - igstream.chart_streamer - ✅ Connected to Lightstreamer for CS.D.AUDJPY.MINI.IP
2025-09-12 06:20:04,120 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.AUDJPY.MINI.IP:5MINUTE
2025-09-12 06:20:04,121 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.AUDJPY.MINI.IP:HOUR
2025-09-12 06:20:04,123 - INFO - igstream.chart_streamer - 📡 All subscriptions active for CS.D.AUDJPY.MINI.IP
2025-09-12 06:20:04,123 - INFO - igstream.chart_streamer - 🔍 Stream validation service started for CS.D.AUDJPY.MINI.IP
2025-09-12 06:20:04,123 - INFO - igstream.chart_streamer - 🚀 Starting enhanced chart stream for CS.D.NZDUSD.MINI.IP
2025-09-12 06:20:04,124 - INFO - igstream.chart_streamer - 🔌 Connecting to Lightstreamer for CS.D.NZDUSD.MINI.IP...
2025-09-12 06:20:04,125 - INFO - igstream.stream_validator - 🚀 Starting stream validation service...
2025-09-12 06:20:04,125 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.NZDUSD.MINI.IP: CONNECTING
2025-09-12 06:20:04,126 - INFO - igstream.stream_validator -    Validation delay: 300s
2025-09-12 06:20:04,126 - INFO - igstream.stream_validator -    Validation frequency: every 3 candles
2025-09-12 06:20:04,127 - INFO - igstream.stream_validator -    Rate limit: 80 requests/minute
2025-09-12 06:20:04,159 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 5m for CS.D.AUDJPY.MINI.IP
2025-09-12 06:20:04,190 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 60m for CS.D.AUDJPY.MINI.IP
2025-09-12 06:20:04,203 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 04:20:00 for CS.D.AUDJPY.MINI.IP - MID OHLC: 98.26600/98.26600/98.26600/98.26600 (Quality: 1.00)
2025-09-12 06:20:04,211 - INFO - igstream.chart_streamer - 🟢 🆕 60m candle completed at 2025-09-12 04:00:00 for CS.D.AUDJPY.MINI.IP - MID OHLC: 98.23300/98.28800/98.22700/98.26600 (Quality: 1.00)
2025-09-12 06:20:04,404 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.NZDUSD.MINI.IP: CONNECTED:WS-STREAMING
2025-09-12 06:20:05,077 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 04:20:00 for CS.D.GBPUSD.MINI.IP - MID OHLC: 1.35537/1.35537/1.35537/1.35537 (Quality: 1.00)
2025-09-12 06:20:05,121 - INFO - igstream.sync_manager - 🚀 Starting chart stream for CS.D.USDCHF.MINI.IP
2025-09-12 06:20:05,121 - INFO - igstream.chart_streamer - 🚀 Starting enhanced chart stream for CS.D.USDCHF.MINI.IP
2025-09-12 06:20:05,122 - INFO - igstream.chart_streamer - 🔌 Connecting to Lightstreamer for CS.D.USDCHF.MINI.IP...
2025-09-12 06:20:05,122 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.USDCHF.MINI.IP: CONNECTING
2025-09-12 06:20:05,125 - INFO - igstream.chart_streamer - ✅ Connected to Lightstreamer for CS.D.NZDUSD.MINI.IP
2025-09-12 06:20:05,126 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.NZDUSD.MINI.IP:5MINUTE
2025-09-12 06:20:05,126 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.NZDUSD.MINI.IP:HOUR
2025-09-12 06:20:05,126 - INFO - igstream.chart_streamer - 📡 All subscriptions active for CS.D.NZDUSD.MINI.IP
2025-09-12 06:20:05,126 - INFO - igstream.chart_streamer - 🔍 Stream validation service started for CS.D.NZDUSD.MINI.IP
2025-09-12 06:20:05,126 - INFO - igstream.stream_validator - 🚀 Starting stream validation service...
2025-09-12 06:20:05,127 - INFO - igstream.stream_validator -    Validation delay: 300s
2025-09-12 06:20:05,127 - INFO - igstream.stream_validator -    Validation frequency: every 3 candles
2025-09-12 06:20:05,127 - INFO - igstream.stream_validator -    Rate limit: 80 requests/minute
2025-09-12 06:20:05,163 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 5m for CS.D.NZDUSD.MINI.IP
2025-09-12 06:20:05,163 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 60m for CS.D.NZDUSD.MINI.IP
2025-09-12 06:20:05,201 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 04:15:00 for CS.D.NZDUSD.MINI.IP - MID OHLC: 0.59698/0.59706/0.59693/0.59699 (Quality: 1.00)
2025-09-12 06:20:05,205 - INFO - igstream.chart_streamer - 🟢 🆕 60m candle completed at 2025-09-12 04:00:00 for CS.D.NZDUSD.MINI.IP - MID OHLC: 0.59705/0.59717/0.59693/0.59699 (Quality: 1.00)
2025-09-12 06:20:05,349 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.USDCHF.MINI.IP: CONNECTED:WS-STREAMING
2025-09-12 06:20:06,122 - INFO - igstream.sync_manager - 🚀 Starting chart stream for CS.D.EURUSD.CEEM.IP
2025-09-12 06:20:06,122 - INFO - igstream.chart_streamer - 🚀 Starting enhanced chart stream for CS.D.EURUSD.CEEM.IP
2025-09-12 06:20:06,123 - INFO - igstream.chart_streamer - 🔌 Connecting to Lightstreamer for CS.D.EURUSD.CEEM.IP...
2025-09-12 06:20:06,123 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.EURUSD.CEEM.IP: CONNECTING
2025-09-12 06:20:06,123 - INFO - igstream.chart_streamer - ✅ Connected to Lightstreamer for CS.D.USDCHF.MINI.IP
2025-09-12 06:20:06,124 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.USDCHF.MINI.IP:5MINUTE
2025-09-12 06:20:06,124 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.USDCHF.MINI.IP:HOUR
2025-09-12 06:20:06,124 - INFO - igstream.chart_streamer - 📡 All subscriptions active for CS.D.USDCHF.MINI.IP
2025-09-12 06:20:06,125 - INFO - igstream.chart_streamer - 🔍 Stream validation service started for CS.D.USDCHF.MINI.IP
2025-09-12 06:20:06,125 - INFO - igstream.stream_validator - 🚀 Starting stream validation service...
2025-09-12 06:20:06,125 - INFO - igstream.stream_validator -    Validation delay: 300s
2025-09-12 06:20:06,125 - INFO - igstream.stream_validator -    Validation frequency: every 3 candles
2025-09-12 06:20:06,125 - INFO - igstream.stream_validator -    Rate limit: 80 requests/minute
2025-09-12 06:20:06,161 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 5m for CS.D.USDCHF.MINI.IP
2025-09-12 06:20:06,190 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 60m for CS.D.USDCHF.MINI.IP
2025-09-12 06:20:06,200 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 04:20:00 for CS.D.USDCHF.MINI.IP - MID OHLC: 0.79689/0.79689/0.79689/0.79689 (Quality: 1.00)
2025-09-12 06:20:06,209 - INFO - igstream.chart_streamer - 🟢 🆕 60m candle completed at 2025-09-12 04:00:00 for CS.D.USDCHF.MINI.IP - MID OHLC: 0.79648/0.79693/0.79648/0.79689 (Quality: 1.00)
2025-09-12 06:20:06,350 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.EURUSD.CEEM.IP: CONNECTED:WS-STREAMING
2025-09-12 06:20:07,123 - INFO - igstream.sync_manager - ✅ All streams started.
2025-09-12 06:20:07,123 - INFO - igstream.sync_manager - 🔄 Watchdog and auth refresher started.
2025-09-12 06:20:07,129 - INFO - root - ⚠️ Auto-backfill service DISABLED to preserve API rate limits
2025-09-12 06:20:07,129 - INFO - root - ✅ Auto-backfill service started (checking every 5 minutes)
2025-09-12 06:20:07,129 - INFO - igstream.chart_streamer - ✅ Connected to Lightstreamer for CS.D.EURUSD.CEEM.IP
2025-09-12 06:20:07,130 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.EURUSD.CEEM.IP:5MINUTE
2025-09-12 06:20:07,130 - INFO - igstream.chart_streamer - 📊 Setting up subscription: CHART:CS.D.EURUSD.CEEM.IP:HOUR
2025-09-12 06:20:07,130 - INFO - igstream.chart_streamer - 📡 All subscriptions active for CS.D.EURUSD.CEEM.IP
2025-09-12 06:20:07,131 - INFO - igstream.chart_streamer - 🔍 Stream validation service started for CS.D.EURUSD.CEEM.IP
2025-09-12 06:20:07,131 - INFO - igstream.sync_manager - ⏱️ Enhanced watchdog loop with gap detection started...
2025-09-12 06:20:07,139 - INFO - igstream.sync_manager - 📊 Database stats: 59 candles in last 30min, latest: 2025-09-12 04:20:00
2025-09-12 06:20:07,146 - WARNING - igstream.sync_manager - Data for CS.D.AUDUSD.MINI.IP 5m is stale. Last update: 2025-09-12 04:15:00+00:00 (307 seconds ago, threshold: 300s)
2025-09-12 06:20:07,148 - WARNING - igstream.sync_manager - Data for CS.D.USDCAD.MINI.IP 5m is stale. Last update: 2025-09-12 04:15:00+00:00 (307 seconds ago, threshold: 300s)
2025-09-12 06:20:07,153 - WARNING - igstream.sync_manager - Data for CS.D.NZDUSD.MINI.IP 5m is stale. Last update: 2025-09-12 04:15:00+00:00 (307 seconds ago, threshold: 300s)
2025-09-12 06:20:07,157 - WARNING - igstream.sync_manager - Data for CS.D.EURUSD.CEEM.IP 5m is stale. Last update: 2025-09-12 04:15:00+00:00 (307 seconds ago, threshold: 300s)
2025-09-12 06:20:07,159 - INFO - igstream.sync_manager - 🔍 Running gap detection check...
2025-09-12 06:20:07,206 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 60m for CS.D.EURUSD.CEEM.IP
2025-09-12 06:20:07,207 - INFO - igstream.chart_streamer - ✅ Successfully subscribed to 5m for CS.D.EURUSD.CEEM.IP
2025-09-12 06:20:07,229 - INFO - igstream.chart_streamer - 🟢 🆕 60m candle completed at 2025-09-12 04:00:00 for CS.D.EURUSD.CEEM.IP - MID OHLC: 1.17256/1.17257/1.17207/1.17218 (Quality: 1.00)
2025-09-12 06:20:07,240 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 04:15:00 for CS.D.EURUSD.CEEM.IP - MID OHLC: 1.17227/1.17233/1.17207/1.17218 (Quality: 1.00)
2025-09-12 06:20:07,293 - INFO - igstream.sync_manager - ✅ No gaps detected in candle data
2025-09-12 06:20:07,294 - INFO - igstream.sync_manager - 🔑 Refreshing IG session...
2025-09-12 06:20:07,294 - INFO - igstream.sync_manager - ✅ Auth refreshed successfully
2025-09-12 06:20:07,294 - INFO - igstream.auto_backfill - Starting continuous auto-backfill service (checking every 5 minutes)
2025-09-12 06:20:07,294 - INFO - igstream.auto_backfill - Auto-backfill service authenticated successfully
2025-09-12 06:20:07,294 - INFO - igstream.auto_backfill - Running automated gap detection and backfill...
2025-09-12 06:20:07,401 - INFO - igstream.stream_validator - 🚀 Starting stream validation service...
2025-09-12 06:20:07,401 - INFO - igstream.stream_validator -    Validation delay: 300s
2025-09-12 06:20:07,401 - INFO - igstream.stream_validator -    Validation frequency: every 3 candles
2025-09-12 06:20:07,402 - INFO - igstream.stream_validator -    Rate limit: 80 requests/minute
2025-09-12 06:20:09,086 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 04:20:00 for CS.D.AUDUSD.MINI.IP - MID OHLC: 0.66604/0.66604/0.66604/0.66604 (Quality: 1.00)
2025-09-12 06:20:16,067 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 04:20:00 for CS.D.USDCAD.MINI.IP - MID OHLC: 1.38426/1.38426/1.38426/1.38426 (Quality: 1.00)
2025-09-12 06:20:23,087 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 04:20:00 for CS.D.EURUSD.CEEM.IP - MID OHLC: 1.17219/1.17221/1.17219/1.17221 (Quality: 1.00)
2025-09-12 06:20:26,058 - INFO - igstream.chart_streamer - 🟢 🆕 5m candle completed at 2025-09-12 04:20:00 for CS.D.NZDUSD.MINI.IP - MID OHLC: 0.59701/0.59701/0.59700/0.59700 (Quality: 1.00)
2025-09-12 06:21:07,301 - INFO - igstream.sync_manager - 📊 Database stats: 63 candles in last 30min, latest: 2025-09-12 04:20:00
2025-09-12 06:22:07,330 - INFO - igstream.sync_manager - 📊 Database stats: 63 candles in last 30min, latest: 2025-09-12 04:20:00
2025-09-12 06:22:14,728 - INFO - igstream.auto_backfill - Stopping auto-backfill service...
2025-09-12 06:22:14,728 - INFO - root - ✅ Auto-backfill service stopped
2025-09-12 06:22:14,728 - INFO - igstream.sync_manager - 🛑 Stopping all streams...
2025-09-12 06:22:14,729 - INFO - igstream.chart_streamer - Chart streaming cancelled for CS.D.GBPUSD.MINI.IP
2025-09-12 06:22:14,730 - INFO - igstream.stream_validator - 🛑 Stopping stream validation service...
2025-09-12 06:22:14,730 - INFO - igstream.chart_streamer - 📊 Validation stats for CS.D.GBPUSD.MINI.IP: {'total_validations': 0, 'successful_validations': 0, 'discrepancies_found': 0, 'api_errors': 0, 'corrections_made': 0, 'queue_size': 3, 'success_rate_pct': 0.0, 'processing': False}
2025-09-12 06:22:14,730 - INFO - igstream.chart_streamer - 🔌 Disconnecting Lightstreamer for CS.D.GBPUSD.MINI.IP...
2025-09-12 06:22:14,732 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.GBPUSD.MINI.IP: DISCONNECTED
2025-09-12 06:22:14,738 - INFO - igstream.chart_streamer - ✅ Cleanup complete for CS.D.GBPUSD.MINI.IP
2025-09-12 06:22:14,739 - INFO - igstream.chart_streamer - Chart streaming cancelled for CS.D.USDJPY.MINI.IP
2025-09-12 06:22:14,740 - INFO - igstream.stream_validator - 🛑 Stopping stream validation service...
2025-09-12 06:22:14,741 - INFO - igstream.chart_streamer - 📊 Validation stats for CS.D.USDJPY.MINI.IP: {'total_validations': 0, 'successful_validations': 0, 'discrepancies_found': 0, 'api_errors': 0, 'corrections_made': 0, 'queue_size': 3, 'success_rate_pct': 0.0, 'processing': False}
2025-09-12 06:22:14,741 - INFO - igstream.chart_streamer - 🔌 Disconnecting Lightstreamer for CS.D.USDJPY.MINI.IP...
2025-09-12 06:22:14,742 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.USDJPY.MINI.IP: DISCONNECTED
2025-09-12 06:22:14,746 - INFO - igstream.chart_streamer - ✅ Cleanup complete for CS.D.USDJPY.MINI.IP
