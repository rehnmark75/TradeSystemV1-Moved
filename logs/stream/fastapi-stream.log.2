2025-09-12 05:45:13,411 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.453, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:14,330 - INFO - igstream.sync_manager - üöÄ Starting chart stream for CS.D.AUDUSD.MINI.IP
2025-09-12 05:45:14,330 - INFO - igstream.sync_manager - ‚úÖ Stream CS.D.AUDUSD.MINI.IP restart triggered due to: stale_data
2025-09-12 05:45:14,330 - WARNING - igstream.sync_manager - ‚ö†Ô∏è Stream CS.D.USDCAD.MINI.IP needs restart (stale_data). Reconnecting...
2025-09-12 05:45:14,330 - INFO - igstream.chart_streamer - üöÄ Starting enhanced chart stream for CS.D.AUDUSD.MINI.IP
2025-09-12 05:45:14,330 - INFO - igstream.chart_streamer - üîå Connecting to Lightstreamer for CS.D.AUDUSD.MINI.IP...
2025-09-12 05:45:14,330 - INFO - igstream.chart_streamer - Chart streaming cancelled for CS.D.USDCAD.MINI.IP
2025-09-12 05:45:14,330 - INFO - igstream.stream_validator - üõë Stopping stream validation service...
2025-09-12 05:45:14,330 - INFO - igstream.chart_streamer - üìä Validation stats for CS.D.USDCAD.MINI.IP: {'total_validations': 0, 'successful_validations': 0, 'discrepancies_found': 0, 'api_errors': 0, 'corrections_made': 0, 'queue_size': 0, 'success_rate_pct': 0.0, 'processing': False}
2025-09-12 05:45:14,330 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.AUDUSD.MINI.IP: CONNECTING
2025-09-12 05:45:14,330 - INFO - igstream.chart_streamer - üîå Disconnecting Lightstreamer for CS.D.USDCAD.MINI.IP...
2025-09-12 05:45:14,331 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.USDCAD.MINI.IP: DISCONNECTED
2025-09-12 05:45:14,331 - INFO - igstream.chart_streamer - ‚úÖ Cleanup complete for CS.D.USDCAD.MINI.IP
2025-09-12 05:45:14,332 - INFO - igstream.sync_manager - Stopped stream for CS.D.USDCAD.MINI.IP
2025-09-12 05:45:14,558 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.AUDUSD.MINI.IP: CONNECTED:WS-STREAMING
2025-09-12 05:45:15,331 - INFO - igstream.chart_streamer - ‚úÖ Connected to Lightstreamer for CS.D.AUDUSD.MINI.IP
2025-09-12 05:45:15,331 - INFO - igstream.chart_streamer - üìä Setting up subscription: CHART:CS.D.AUDUSD.MINI.IP:5MINUTE
2025-09-12 05:45:15,332 - INFO - igstream.chart_streamer - üìä Setting up subscription: CHART:CS.D.AUDUSD.MINI.IP:HOUR
2025-09-12 05:45:15,333 - INFO - igstream.chart_streamer - üì° All subscriptions active for CS.D.AUDUSD.MINI.IP
2025-09-12 05:45:15,333 - INFO - igstream.chart_streamer - üîç Stream validation service started for CS.D.AUDUSD.MINI.IP
2025-09-12 05:45:15,333 - INFO - igstream.stream_validator - üöÄ Starting stream validation service...
2025-09-12 05:45:15,333 - INFO - igstream.stream_validator -    Validation delay: 300s
2025-09-12 05:45:15,333 - INFO - igstream.stream_validator -    Validation frequency: every 3 candles
2025-09-12 05:45:15,333 - INFO - igstream.stream_validator -    Rate limit: 80 requests/minute
2025-09-12 05:45:15,369 - INFO - igstream.chart_streamer - ‚úÖ Successfully subscribed to 5m for CS.D.AUDUSD.MINI.IP
2025-09-12 05:45:15,398 - INFO - igstream.chart_streamer - ‚úÖ Successfully subscribed to 60m for CS.D.AUDUSD.MINI.IP
2025-09-12 05:45:15,401 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.AUDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.66633, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:15,402 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.66633, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:15,406 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.AUDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.66633, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:15,407 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.66633, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:16,031 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 98.2535, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:16,033 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 98.2535, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:16,036 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.AUDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.6663399999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:16,038 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.6663399999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:16,061 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.2535, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:16,062 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.2535, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:16,064 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.AUDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.6663399999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:16,065 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.6663399999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:16,332 - INFO - igstream.sync_manager - üöÄ Starting chart stream for CS.D.USDCAD.MINI.IP
2025-09-12 05:45:16,332 - INFO - igstream.sync_manager - ‚úÖ Stream CS.D.USDCAD.MINI.IP restart triggered due to: stale_data
2025-09-12 05:45:16,333 - WARNING - igstream.sync_manager - ‚ö†Ô∏è Stream CS.D.EURJPY.MINI.IP needs restart (stale_data). Reconnecting...
2025-09-12 05:45:16,333 - INFO - igstream.chart_streamer - üöÄ Starting enhanced chart stream for CS.D.USDCAD.MINI.IP
2025-09-12 05:45:16,333 - INFO - igstream.chart_streamer - üîå Connecting to Lightstreamer for CS.D.USDCAD.MINI.IP...
2025-09-12 05:45:16,334 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.USDCAD.MINI.IP: CONNECTING
2025-09-12 05:45:16,335 - INFO - igstream.chart_streamer - Chart streaming cancelled for CS.D.EURJPY.MINI.IP
2025-09-12 05:45:16,335 - INFO - igstream.stream_validator - üõë Stopping stream validation service...
2025-09-12 05:45:16,336 - INFO - igstream.chart_streamer - üìä Validation stats for CS.D.EURJPY.MINI.IP: {'total_validations': 0, 'successful_validations': 0, 'discrepancies_found': 0, 'api_errors': 0, 'corrections_made': 0, 'queue_size': 0, 'success_rate_pct': 0.0, 'processing': False}
2025-09-12 05:45:16,336 - INFO - igstream.chart_streamer - üîå Disconnecting Lightstreamer for CS.D.EURJPY.MINI.IP...
2025-09-12 05:45:16,336 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.EURJPY.MINI.IP: DISCONNECTED
2025-09-12 05:45:16,337 - INFO - igstream.chart_streamer - ‚úÖ Cleanup complete for CS.D.EURJPY.MINI.IP
2025-09-12 05:45:16,337 - INFO - igstream.sync_manager - Stopped stream for CS.D.EURJPY.MINI.IP
2025-09-12 05:45:16,633 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.USDCAD.MINI.IP: CONNECTED:WS-STREAMING
2025-09-12 05:45:17,033 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.2525, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:17,036 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.2525, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:17,038 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.AUDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.66633, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:17,040 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.66633, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:17,042 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.NZDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.59724, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:17,043 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.59724, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:17,045 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.NZDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.59724, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:17,045 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.59724, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:17,063 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 98.2525, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:17,065 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 98.2525, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:17,068 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.AUDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.66633, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:17,069 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.66633, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:17,335 - INFO - igstream.chart_streamer - ‚úÖ Connected to Lightstreamer for CS.D.USDCAD.MINI.IP
2025-09-12 05:45:17,336 - INFO - igstream.chart_streamer - üìä Setting up subscription: CHART:CS.D.USDCAD.MINI.IP:5MINUTE
2025-09-12 05:45:17,337 - INFO - igstream.chart_streamer - üìä Setting up subscription: CHART:CS.D.USDCAD.MINI.IP:HOUR
2025-09-12 05:45:17,337 - INFO - igstream.chart_streamer - üì° All subscriptions active for CS.D.USDCAD.MINI.IP
2025-09-12 05:45:17,338 - INFO - igstream.chart_streamer - üîç Stream validation service started for CS.D.USDCAD.MINI.IP
2025-09-12 05:45:17,338 - INFO - igstream.stream_validator - üöÄ Starting stream validation service...
2025-09-12 05:45:17,338 - INFO - igstream.stream_validator -    Validation delay: 300s
2025-09-12 05:45:17,338 - INFO - igstream.stream_validator -    Validation frequency: every 3 candles
2025-09-12 05:45:17,338 - INFO - igstream.stream_validator -    Rate limit: 80 requests/minute
2025-09-12 05:45:17,374 - INFO - igstream.chart_streamer - ‚úÖ Successfully subscribed to 5m for CS.D.USDCAD.MINI.IP
2025-09-12 05:45:17,406 - INFO - igstream.chart_streamer - ‚úÖ Successfully subscribed to 60m for CS.D.USDCAD.MINI.IP
2025-09-12 05:45:17,412 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDCAD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.384255, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:17,416 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.384255, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:17,419 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDCAD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.384255, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:17,422 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.384255, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:18,338 - INFO - igstream.sync_manager - üöÄ Starting chart stream for CS.D.EURJPY.MINI.IP
2025-09-12 05:45:18,338 - INFO - igstream.sync_manager - ‚úÖ Stream CS.D.EURJPY.MINI.IP restart triggered due to: stale_data
2025-09-12 05:45:18,338 - WARNING - igstream.sync_manager - ‚ö†Ô∏è Stream CS.D.AUDJPY.MINI.IP needs restart (stale_data). Reconnecting...
2025-09-12 05:45:18,338 - INFO - igstream.chart_streamer - üöÄ Starting enhanced chart stream for CS.D.EURJPY.MINI.IP
2025-09-12 05:45:18,338 - INFO - igstream.chart_streamer - üîå Connecting to Lightstreamer for CS.D.EURJPY.MINI.IP...
2025-09-12 05:45:18,339 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.EURJPY.MINI.IP: CONNECTING
2025-09-12 05:45:18,339 - INFO - igstream.chart_streamer - Chart streaming cancelled for CS.D.AUDJPY.MINI.IP
2025-09-12 05:45:18,339 - INFO - igstream.stream_validator - üõë Stopping stream validation service...
2025-09-12 05:45:18,339 - INFO - igstream.chart_streamer - üìä Validation stats for CS.D.AUDJPY.MINI.IP: {'total_validations': 0, 'successful_validations': 0, 'discrepancies_found': 0, 'api_errors': 0, 'corrections_made': 0, 'queue_size': 0, 'success_rate_pct': 0.0, 'processing': False}
2025-09-12 05:45:18,339 - INFO - igstream.chart_streamer - üîå Disconnecting Lightstreamer for CS.D.AUDJPY.MINI.IP...
2025-09-12 05:45:18,340 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.AUDJPY.MINI.IP: DISCONNECTED
2025-09-12 05:45:18,340 - INFO - igstream.chart_streamer - ‚úÖ Cleanup complete for CS.D.AUDJPY.MINI.IP
2025-09-12 05:45:18,340 - INFO - igstream.sync_manager - Stopped stream for CS.D.AUDJPY.MINI.IP
2025-09-12 05:45:18,547 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.EURJPY.MINI.IP: CONNECTED:WS-STREAMING
2025-09-12 05:45:19,042 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.EURUSD.CEEM.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.1725299999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:19,042 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.1725299999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:19,044 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.EURUSD.CEEM.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.1725299999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:19,044 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.1725299999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:19,048 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.451, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:19,049 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.451, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:19,050 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.451, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:19,051 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.451, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:19,341 - INFO - igstream.chart_streamer - ‚úÖ Connected to Lightstreamer for CS.D.EURJPY.MINI.IP
2025-09-12 05:45:19,341 - INFO - igstream.chart_streamer - üìä Setting up subscription: CHART:CS.D.EURJPY.MINI.IP:5MINUTE
2025-09-12 05:45:19,342 - INFO - igstream.chart_streamer - üìä Setting up subscription: CHART:CS.D.EURJPY.MINI.IP:HOUR
2025-09-12 05:45:19,342 - INFO - igstream.chart_streamer - üì° All subscriptions active for CS.D.EURJPY.MINI.IP
2025-09-12 05:45:19,342 - INFO - igstream.chart_streamer - üîç Stream validation service started for CS.D.EURJPY.MINI.IP
2025-09-12 05:45:19,342 - INFO - igstream.stream_validator - üöÄ Starting stream validation service...
2025-09-12 05:45:19,343 - INFO - igstream.stream_validator -    Validation delay: 300s
2025-09-12 05:45:19,343 - INFO - igstream.stream_validator -    Validation frequency: every 3 candles
2025-09-12 05:45:19,343 - INFO - igstream.stream_validator -    Rate limit: 80 requests/minute
2025-09-12 05:45:19,378 - INFO - igstream.chart_streamer - ‚úÖ Successfully subscribed to 60m for CS.D.EURJPY.MINI.IP
2025-09-12 05:45:19,379 - INFO - igstream.chart_streamer - ‚úÖ Successfully subscribed to 5m for CS.D.EURJPY.MINI.IP
2025-09-12 05:45:19,411 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.89749999999998, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:19,412 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.89749999999998, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:19,414 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.89749999999998, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:19,415 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.89749999999998, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:20,341 - INFO - igstream.sync_manager - üöÄ Starting chart stream for CS.D.AUDJPY.MINI.IP
2025-09-12 05:45:20,341 - INFO - igstream.sync_manager - ‚úÖ Stream CS.D.AUDJPY.MINI.IP restart triggered due to: stale_data
2025-09-12 05:45:20,342 - WARNING - igstream.sync_manager - ‚ö†Ô∏è Stream CS.D.NZDUSD.MINI.IP needs restart (stale_data). Reconnecting...
2025-09-12 05:45:20,342 - INFO - igstream.chart_streamer - üöÄ Starting enhanced chart stream for CS.D.AUDJPY.MINI.IP
2025-09-12 05:45:20,342 - INFO - igstream.chart_streamer - üîå Connecting to Lightstreamer for CS.D.AUDJPY.MINI.IP...
2025-09-12 05:45:20,342 - INFO - igstream.chart_streamer - Chart streaming cancelled for CS.D.NZDUSD.MINI.IP
2025-09-12 05:45:20,343 - INFO - igstream.stream_validator - üõë Stopping stream validation service...
2025-09-12 05:45:20,343 - INFO - igstream.chart_streamer - üìä Validation stats for CS.D.NZDUSD.MINI.IP: {'total_validations': 0, 'successful_validations': 0, 'discrepancies_found': 0, 'api_errors': 0, 'corrections_made': 0, 'queue_size': 0, 'success_rate_pct': 0.0, 'processing': False}
2025-09-12 05:45:20,342 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.AUDJPY.MINI.IP: CONNECTING
2025-09-12 05:45:20,343 - INFO - igstream.chart_streamer - üîå Disconnecting Lightstreamer for CS.D.NZDUSD.MINI.IP...
2025-09-12 05:45:20,343 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.NZDUSD.MINI.IP: DISCONNECTED
2025-09-12 05:45:20,344 - INFO - igstream.chart_streamer - ‚úÖ Cleanup complete for CS.D.NZDUSD.MINI.IP
2025-09-12 05:45:20,346 - INFO - igstream.sync_manager - Stopped stream for CS.D.NZDUSD.MINI.IP
2025-09-12 05:45:20,553 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.AUDJPY.MINI.IP: CONNECTED:WS-STREAMING
2025-09-12 05:45:21,044 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDCHF.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.79646, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:21,045 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.79646, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:21,046 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.453, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:21,047 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.453, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:21,075 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDCHF.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.79646, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:21,076 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.79646, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:21,078 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.453, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:21,080 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.453, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:21,343 - INFO - igstream.chart_streamer - ‚úÖ Connected to Lightstreamer for CS.D.AUDJPY.MINI.IP
2025-09-12 05:45:21,343 - INFO - igstream.chart_streamer - üìä Setting up subscription: CHART:CS.D.AUDJPY.MINI.IP:5MINUTE
2025-09-12 05:45:21,344 - INFO - igstream.chart_streamer - üìä Setting up subscription: CHART:CS.D.AUDJPY.MINI.IP:HOUR
2025-09-12 05:45:21,344 - INFO - igstream.chart_streamer - üì° All subscriptions active for CS.D.AUDJPY.MINI.IP
2025-09-12 05:45:21,344 - INFO - igstream.chart_streamer - üîç Stream validation service started for CS.D.AUDJPY.MINI.IP
2025-09-12 05:45:21,345 - INFO - igstream.stream_validator - üöÄ Starting stream validation service...
2025-09-12 05:45:21,345 - INFO - igstream.stream_validator -    Validation delay: 300s
2025-09-12 05:45:21,345 - INFO - igstream.stream_validator -    Validation frequency: every 3 candles
2025-09-12 05:45:21,345 - INFO - igstream.stream_validator -    Rate limit: 80 requests/minute
2025-09-12 05:45:21,380 - INFO - igstream.chart_streamer - ‚úÖ Successfully subscribed to 5m for CS.D.AUDJPY.MINI.IP
2025-09-12 05:45:21,410 - INFO - igstream.chart_streamer - ‚úÖ Successfully subscribed to 60m for CS.D.AUDJPY.MINI.IP
2025-09-12 05:45:21,416 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.2525, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:21,419 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.2525, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:21,422 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 98.2525, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:21,424 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 98.2525, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:22,045 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.8965, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:22,046 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.8965, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:22,047 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.8965, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:22,047 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.8965, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:22,048 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.452, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:22,049 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.452, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:22,075 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.452, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:22,076 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.452, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:22,346 - INFO - igstream.sync_manager - üöÄ Starting chart stream for CS.D.NZDUSD.MINI.IP
2025-09-12 05:45:22,347 - INFO - igstream.sync_manager - ‚úÖ Stream CS.D.NZDUSD.MINI.IP restart triggered due to: stale_data
2025-09-12 05:45:22,347 - WARNING - igstream.sync_manager - ‚ö†Ô∏è Stream CS.D.USDCHF.MINI.IP needs restart (stale_data). Reconnecting...
2025-09-12 05:45:22,347 - INFO - igstream.chart_streamer - üöÄ Starting enhanced chart stream for CS.D.NZDUSD.MINI.IP
2025-09-12 05:45:22,347 - INFO - igstream.chart_streamer - üîå Connecting to Lightstreamer for CS.D.NZDUSD.MINI.IP...
2025-09-12 05:45:22,347 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.NZDUSD.MINI.IP: CONNECTING
2025-09-12 05:45:22,348 - INFO - igstream.chart_streamer - Chart streaming cancelled for CS.D.USDCHF.MINI.IP
2025-09-12 05:45:22,349 - INFO - igstream.stream_validator - üõë Stopping stream validation service...
2025-09-12 05:45:22,349 - INFO - igstream.chart_streamer - üìä Validation stats for CS.D.USDCHF.MINI.IP: {'total_validations': 0, 'successful_validations': 0, 'discrepancies_found': 0, 'api_errors': 0, 'corrections_made': 0, 'queue_size': 0, 'success_rate_pct': 0.0, 'processing': False}
2025-09-12 05:45:22,349 - INFO - igstream.chart_streamer - üîå Disconnecting Lightstreamer for CS.D.USDCHF.MINI.IP...
2025-09-12 05:45:22,349 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.USDCHF.MINI.IP: DISCONNECTED
2025-09-12 05:45:22,350 - INFO - igstream.chart_streamer - ‚úÖ Cleanup complete for CS.D.USDCHF.MINI.IP
2025-09-12 05:45:22,350 - INFO - igstream.sync_manager - Stopped stream for CS.D.USDCHF.MINI.IP
2025-09-12 05:45:22,581 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.NZDUSD.MINI.IP: CONNECTED:WS-STREAMING
2025-09-12 05:45:23,349 - INFO - igstream.chart_streamer - ‚úÖ Connected to Lightstreamer for CS.D.NZDUSD.MINI.IP
2025-09-12 05:45:23,349 - INFO - igstream.chart_streamer - üìä Setting up subscription: CHART:CS.D.NZDUSD.MINI.IP:5MINUTE
2025-09-12 05:45:23,349 - INFO - igstream.chart_streamer - üìä Setting up subscription: CHART:CS.D.NZDUSD.MINI.IP:HOUR
2025-09-12 05:45:23,349 - INFO - igstream.chart_streamer - üì° All subscriptions active for CS.D.NZDUSD.MINI.IP
2025-09-12 05:45:23,349 - INFO - igstream.chart_streamer - üîç Stream validation service started for CS.D.NZDUSD.MINI.IP
2025-09-12 05:45:23,349 - INFO - igstream.stream_validator - üöÄ Starting stream validation service...
2025-09-12 05:45:23,349 - INFO - igstream.stream_validator -    Validation delay: 300s
2025-09-12 05:45:23,350 - INFO - igstream.stream_validator -    Validation frequency: every 3 candles
2025-09-12 05:45:23,350 - INFO - igstream.stream_validator -    Rate limit: 80 requests/minute
2025-09-12 05:45:23,387 - INFO - igstream.chart_streamer - ‚úÖ Successfully subscribed to 5m for CS.D.NZDUSD.MINI.IP
2025-09-12 05:45:23,388 - INFO - igstream.chart_streamer - ‚úÖ Successfully subscribed to 60m for CS.D.NZDUSD.MINI.IP
2025-09-12 05:45:23,420 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.NZDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.59724, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:23,421 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.59724, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:23,423 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.NZDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.59724, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:23,425 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.59724, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:24,350 - INFO - igstream.sync_manager - üöÄ Starting chart stream for CS.D.USDCHF.MINI.IP
2025-09-12 05:45:24,351 - INFO - igstream.sync_manager - ‚úÖ Stream CS.D.USDCHF.MINI.IP restart triggered due to: stale_data
2025-09-12 05:45:24,351 - WARNING - igstream.sync_manager - ‚ö†Ô∏è Stream CS.D.EURUSD.CEEM.IP needs restart (stale_data). Reconnecting...
2025-09-12 05:45:24,351 - INFO - igstream.chart_streamer - üöÄ Starting enhanced chart stream for CS.D.USDCHF.MINI.IP
2025-09-12 05:45:24,351 - INFO - igstream.chart_streamer - üîå Connecting to Lightstreamer for CS.D.USDCHF.MINI.IP...
2025-09-12 05:45:24,351 - INFO - igstream.chart_streamer - Chart streaming cancelled for CS.D.EURUSD.CEEM.IP
2025-09-12 05:45:24,352 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.USDCHF.MINI.IP: CONNECTING
2025-09-12 05:45:24,352 - INFO - igstream.stream_validator - üõë Stopping stream validation service...
2025-09-12 05:45:24,352 - INFO - igstream.chart_streamer - üìä Validation stats for CS.D.EURUSD.CEEM.IP: {'total_validations': 0, 'successful_validations': 0, 'discrepancies_found': 0, 'api_errors': 0, 'corrections_made': 0, 'queue_size': 0, 'success_rate_pct': 0.0, 'processing': False}
2025-09-12 05:45:24,353 - INFO - igstream.chart_streamer - üîå Disconnecting Lightstreamer for CS.D.EURUSD.CEEM.IP...
2025-09-12 05:45:24,354 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.EURUSD.CEEM.IP: DISCONNECTED
2025-09-12 05:45:24,354 - INFO - igstream.chart_streamer - ‚úÖ Cleanup complete for CS.D.EURUSD.CEEM.IP
2025-09-12 05:45:24,355 - INFO - igstream.sync_manager - Stopped stream for CS.D.EURUSD.CEEM.IP
2025-09-12 05:45:24,601 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.USDCHF.MINI.IP: CONNECTED:WS-STREAMING
2025-09-12 05:45:25,352 - INFO - igstream.chart_streamer - ‚úÖ Connected to Lightstreamer for CS.D.USDCHF.MINI.IP
2025-09-12 05:45:25,353 - INFO - igstream.chart_streamer - üìä Setting up subscription: CHART:CS.D.USDCHF.MINI.IP:5MINUTE
2025-09-12 05:45:25,353 - INFO - igstream.chart_streamer - üìä Setting up subscription: CHART:CS.D.USDCHF.MINI.IP:HOUR
2025-09-12 05:45:25,353 - INFO - igstream.chart_streamer - üì° All subscriptions active for CS.D.USDCHF.MINI.IP
2025-09-12 05:45:25,353 - INFO - igstream.chart_streamer - üîç Stream validation service started for CS.D.USDCHF.MINI.IP
2025-09-12 05:45:25,353 - INFO - igstream.stream_validator - üöÄ Starting stream validation service...
2025-09-12 05:45:25,353 - INFO - igstream.stream_validator -    Validation delay: 300s
2025-09-12 05:45:25,353 - INFO - igstream.stream_validator -    Validation frequency: every 3 candles
2025-09-12 05:45:25,353 - INFO - igstream.stream_validator -    Rate limit: 80 requests/minute
2025-09-12 05:45:25,394 - INFO - igstream.chart_streamer - ‚úÖ Successfully subscribed to 5m for CS.D.USDCHF.MINI.IP
2025-09-12 05:45:25,395 - INFO - igstream.chart_streamer - ‚úÖ Successfully subscribed to 60m for CS.D.USDCHF.MINI.IP
2025-09-12 05:45:25,426 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDCHF.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.79646, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:25,428 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.79646, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:25,429 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDCHF.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.79646, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:25,430 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.79646, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:26,355 - INFO - igstream.sync_manager - üöÄ Starting chart stream for CS.D.EURUSD.CEEM.IP
2025-09-12 05:45:26,356 - INFO - igstream.sync_manager - ‚úÖ Stream CS.D.EURUSD.CEEM.IP restart triggered due to: stale_data
2025-09-12 05:45:26,356 - INFO - igstream.chart_streamer - üöÄ Starting enhanced chart stream for CS.D.EURUSD.CEEM.IP
2025-09-12 05:45:26,356 - INFO - igstream.chart_streamer - üîå Connecting to Lightstreamer for CS.D.EURUSD.CEEM.IP...
2025-09-12 05:45:26,356 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.EURUSD.CEEM.IP: CONNECTING
2025-09-12 05:45:26,621 - INFO - igstream.chart_streamer - Lightstreamer status for CS.D.EURUSD.CEEM.IP: CONNECTED:WS-STREAMING
2025-09-12 05:45:27,046 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDCHF.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.79647, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:27,048 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.79647, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:27,050 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDCHF.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.79647, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:27,051 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.79647, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:27,357 - INFO - igstream.chart_streamer - ‚úÖ Connected to Lightstreamer for CS.D.EURUSD.CEEM.IP
2025-09-12 05:45:27,357 - INFO - igstream.chart_streamer - üìä Setting up subscription: CHART:CS.D.EURUSD.CEEM.IP:5MINUTE
2025-09-12 05:45:27,359 - INFO - igstream.chart_streamer - üìä Setting up subscription: CHART:CS.D.EURUSD.CEEM.IP:HOUR
2025-09-12 05:45:27,359 - INFO - igstream.chart_streamer - üì° All subscriptions active for CS.D.EURUSD.CEEM.IP
2025-09-12 05:45:27,359 - INFO - igstream.chart_streamer - üîç Stream validation service started for CS.D.EURUSD.CEEM.IP
2025-09-12 05:45:27,360 - INFO - igstream.stream_validator - üöÄ Starting stream validation service...
2025-09-12 05:45:27,360 - INFO - igstream.stream_validator -    Validation delay: 300s
2025-09-12 05:45:27,360 - INFO - igstream.stream_validator -    Validation frequency: every 3 candles
2025-09-12 05:45:27,360 - INFO - igstream.stream_validator -    Rate limit: 80 requests/minute
2025-09-12 05:45:27,396 - INFO - igstream.chart_streamer - ‚úÖ Successfully subscribed to 5m for CS.D.EURUSD.CEEM.IP
2025-09-12 05:45:27,428 - INFO - igstream.chart_streamer - ‚úÖ Successfully subscribed to 60m for CS.D.EURUSD.CEEM.IP
2025-09-12 05:45:27,429 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.EURUSD.CEEM.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.17252, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:27,430 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.17252, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:27,431 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.EURUSD.CEEM.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.17252, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:27,432 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.17252, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:30,051 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.451, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:30,053 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.451, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:30,071 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.451, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:30,071 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.451, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:31,039 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.8955, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:31,041 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.8955, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:31,042 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.NZDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.59723, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:31,043 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.59723, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:31,070 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.8955, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:31,071 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.8955, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:31,074 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.NZDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.59723, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:31,075 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.59723, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:33,041 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.8965, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:33,042 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.8965, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:33,045 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.8965, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:33,046 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.8965, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:36,041 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.4515, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:36,041 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.4515, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:36,043 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.4515, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:36,043 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.4515, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:37,043 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.NZDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.5972500000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:37,044 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.5972500000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:37,073 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.NZDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.5972500000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:37,075 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.5972500000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:38,045 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.452, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:38,046 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.452, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:38,048 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.GBPUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.355685, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:38,049 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.355685, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:38,077 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.452, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:38,079 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.452, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:38,081 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.GBPUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.355685, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:38,083 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.355685, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:39,035 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.451, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:39,036 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.451, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:39,037 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.451, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:39,037 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.451, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:41,042 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.NZDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.59724, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:41,043 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.59724, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:41,044 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.NZDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.59724, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:41,045 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.59724, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:42,040 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.2535, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:42,042 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.2535, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:42,044 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 98.2535, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:42,045 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 98.2535, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:42,047 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.8985, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:42,048 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.8985, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:42,049 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.453, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:42,050 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.453, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:42,052 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.453, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:42,053 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.453, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:42,074 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDCHF.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.79647, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:42,076 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.79647, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:42,077 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDCHF.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.79647, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:42,078 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.79647, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:42,081 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.8985, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:42,082 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.8985, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:43,035 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.8985, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:43,036 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.8985, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:43,038 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.8985, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:43,039 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.8985, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:43,040 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.452, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:43,041 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.452, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:43,043 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.452, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:43,044 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.452, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:45,040 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDCAD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.3842050000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:45,041 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.3842050000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:45,043 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.4505, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:45,044 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.4505, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:45,046 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.4505, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:45,047 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.4505, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:45,069 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDCAD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.3842050000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:45,071 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.3842050000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:46,041 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDCAD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.384215, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:46,045 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.384215, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:46,048 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.4495, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:46,050 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.4495, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:46,051 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.4495, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:46,053 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.4495, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:46,070 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDCAD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.384215, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:46,072 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.384215, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:47,038 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.4485, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:47,039 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.4485, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:47,042 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.4485, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:47,044 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.4485, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:49,037 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.4495, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:49,038 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.4495, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:49,067 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.4495, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:49,069 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.4495, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:50,035 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDCAD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.384275, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:50,037 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.384275, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:50,038 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.4505, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:50,039 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.4505, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:50,040 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.4505, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:50,041 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.4505, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:50,067 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDCAD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.384275, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:50,068 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.384275, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:51,035 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDCHF.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.79646, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:51,036 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.79646, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:51,037 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDCHF.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.79646, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:51,038 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.79646, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:55,045 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDCAD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.384245, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:55,046 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.384245, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:55,047 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.NZDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.5972500000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:55,048 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.5972500000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:55,076 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDCAD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.384245, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:55,077 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.384245, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:55,079 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.NZDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.5972500000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:55,081 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.5972500000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:56,041 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.NZDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.59724, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:56,044 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.59724, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:56,046 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.NZDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.59724, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:56,047 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.59724, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:56,049 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.EURUSD.CEEM.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.17251, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:56,050 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.17251, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:56,051 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.EURUSD.CEEM.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.17251, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:56,052 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.17251, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:57,036 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.8985, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:57,037 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.8985, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:57,039 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.8985, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:57,040 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.8985, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:58,038 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.NZDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.59724, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:58,039 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.59724, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:58,041 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.NZDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.59724, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:58,042 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.59724, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:58,044 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.4495, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:58,045 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.4495, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:58,070 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.4495, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:58,072 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.4495, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:59,036 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.8995, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:59,037 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.8995, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:45:59,064 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.8995, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:45:59,065 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.8995, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:00,037 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.8995, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:00,038 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.8995, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:00,067 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.8995, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:00,068 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.8995, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:01,040 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.GBPUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.355655, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:01,041 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.355655, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:01,075 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.GBPUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.355655, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:01,077 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.355655, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:04,037 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 98.2575, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:04,037 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 98.2575, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:04,038 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.2575, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:04,039 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.2575, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:04,044 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.AUDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.66632, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:04,046 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.66632, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:04,048 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.90449999999998, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:04,051 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.90449999999998, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:04,054 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDCAD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.384255, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:04,056 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.384255, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:04,057 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.NZDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.5972500000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:04,059 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.5972500000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:04,060 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.NZDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.5972500000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:04,061 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.5972500000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:04,062 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDCHF.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.796495, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:04,063 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.796495, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:04,064 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.4555, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:04,065 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.4555, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:04,065 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.4555, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:04,066 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.4555, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:04,067 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.EURUSD.CEEM.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.1725, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:04,067 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.1725, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:04,072 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.AUDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.66632, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:04,073 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.66632, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:04,075 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.90449999999998, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:04,076 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.90449999999998, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:04,079 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDCAD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.384255, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:04,079 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.384255, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:04,080 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDCHF.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.796495, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:04,081 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.796495, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:04,086 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.EURUSD.CEEM.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.1725, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:04,087 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.1725, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:05,038 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.2585, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:05,039 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.2585, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:05,040 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 98.2585, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:05,041 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 98.2585, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:05,042 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.9085, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:05,043 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.9085, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:05,044 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.9085, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:05,044 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.9085, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:05,045 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.4575, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:05,045 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.4575, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:05,074 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.4575, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:05,075 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.4575, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:06,035 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.9065, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:06,037 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.9065, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:06,039 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.9065, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:06,040 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.9065, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:06,041 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.4565, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:06,042 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.4565, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:06,043 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.EURUSD.CEEM.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.1724900000000003, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:06,044 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.1724900000000003, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:06,066 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.4565, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:06,068 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.4565, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:06,070 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.EURUSD.CEEM.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.1724900000000003, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:06,071 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.1724900000000003, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:07,045 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.NZDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.59724, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:07,046 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.59724, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:07,047 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.NZDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.59724, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:07,049 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.59724, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:08,037 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDCAD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.384245, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:08,040 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.384245, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:08,065 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDCAD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.384245, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:08,066 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.384245, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:09,036 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDCAD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.384255, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:09,037 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.384255, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:09,066 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDCAD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.384255, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:09,067 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.384255, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:10,034 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.25450000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:10,035 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.25450000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:10,040 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.9005, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:10,041 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.9005, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:10,044 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDCAD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.384245, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:10,045 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.384245, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:10,046 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.4515, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:10,046 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.4515, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:10,047 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.4515, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:10,048 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.4515, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:10,056 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.EURUSD.CEEM.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.17251, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:10,057 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.17251, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:10,064 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 98.25450000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:10,065 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 98.25450000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:10,068 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.9005, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:10,069 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.9005, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:10,072 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDCAD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.384245, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:10,073 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.384245, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:10,086 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.EURUSD.CEEM.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.17251, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:10,087 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.17251, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:11,040 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.AUDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.66633, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:11,041 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.66633, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:11,043 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.9005, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:11,043 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.9005, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:11,044 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDCAD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.384255, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:11,045 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.384255, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:11,045 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDCAD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.384255, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:11,046 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.384255, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:11,047 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.45, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:11,047 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.45, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:11,048 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.45, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:11,049 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.45, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:11,068 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.AUDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.66633, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:11,069 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.66633, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:11,071 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.9005, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:11,072 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.9005, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:14,046 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDCAD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.384245, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:14,049 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.384245, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:14,052 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDCAD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.384245, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:14,054 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.384245, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:14,057 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.NZDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.5972500000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:14,059 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.5972500000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:14,073 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.NZDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.5972500000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:14,074 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.5972500000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:15,040 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 98.238, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:15,041 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 98.238, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:15,044 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.AUDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.666215, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:15,045 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.666215, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:15,047 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.8985, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:15,048 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.8985, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:15,049 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.8985, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:15,051 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.8985, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:15,054 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.GBPUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.3556249999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:15,055 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.3556249999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:15,057 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.GBPUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.3556249999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:15,058 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.3556249999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:15,060 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDCAD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.384295, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:15,061 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.384295, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:15,062 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDCHF.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.796535, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:15,063 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.796535, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:15,064 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.NZDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.59718, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:15,065 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.59718, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:15,067 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.EURUSD.CEEM.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.1724900000000003, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:15,068 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.1724900000000003, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:15,070 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.238, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:15,071 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.238, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:15,074 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.AUDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.666215, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:15,075 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.666215, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:15,083 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDCAD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.384295, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:15,084 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.384295, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:15,088 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.EURUSD.CEEM.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.1724900000000003, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:15,088 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.1724900000000003, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:15,089 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDCHF.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.796535, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:15,090 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.796535, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:15,091 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.NZDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.59718, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:15,092 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.59718, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:16,039 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.238, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:16,040 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.238, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:16,042 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.AUDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.6662049999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:16,044 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.6662049999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:16,045 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.AUDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.6662049999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:16,045 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.6662049999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:16,046 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.9035, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:16,047 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.9035, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:16,047 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.GBPUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.3556249999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:16,048 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.3556249999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:16,051 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.NZDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.59716, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:16,052 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.59716, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:16,056 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDCHF.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.7965249999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:16,057 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.7965249999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:16,059 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.EURUSD.CEEM.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.1725, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:16,061 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.1725, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:16,062 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.EURUSD.CEEM.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.1725, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:16,064 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.1725, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:16,071 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 98.238, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:16,075 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 98.238, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:16,078 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.454, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:16,079 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.454, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:16,081 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.454, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:16,082 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.454, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:16,083 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.9035, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:16,083 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.9035, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:16,084 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.GBPUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.3556249999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:16,085 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.3556249999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:16,086 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDCHF.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.7965249999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:16,087 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCHF.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCHF.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.7965249999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:16,088 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.NZDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.59716, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:16,088 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.NZDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.NZDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.59716, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:17,038 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.239, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:17,039 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.239, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:17,040 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.GBPUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.355675, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:17,041 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.355675, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:17,069 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 98.239, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:17,070 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 98.239, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:17,071 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.GBPUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.355675, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:17,073 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.355675, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:18,044 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.GBPUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.3556249999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:18,046 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.3556249999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:18,048 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.453, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:18,049 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.453, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:18,073 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.GBPUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.3556249999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:18,075 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.GBPUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.GBPUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.3556249999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:18,076 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.453, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:18,077 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.453, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:19,042 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.23599999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:19,043 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.23599999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:19,045 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 98.23599999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:19,046 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 98.23599999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:19,048 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.AUDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.6661950000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:19,049 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.6661950000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:19,049 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.9015, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:19,050 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.9015, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:19,051 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.451, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:19,051 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.451, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:19,074 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.AUDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.6661950000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:19,075 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.6661950000000001, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:19,076 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.9015, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:19,077 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.9015, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:19,078 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.451, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:19,079 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.451, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:20,036 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 98.237, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:20,039 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 98.237, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:20,042 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.237, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:20,043 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.237, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:20,046 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.9035, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:20,048 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 172.9035, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:20,051 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.EURJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.9035, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:20,052 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 172.9035, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:20,054 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.452, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:20,055 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.452, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:20,056 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.EURUSD.CEEM.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.17251, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:20,057 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.17251, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:20,071 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.452, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:20,073 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.452, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:20,080 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.EURUSD.CEEM.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.17251, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:20,081 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.EURUSD.CEEM.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.EURUSD.CEEM.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.17251, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:21,039 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.235, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:21,040 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.235, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:21,042 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.AUDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.666185, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:21,044 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 0.666185, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:21,045 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.AUDUSD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.666185, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:21,046 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDUSD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDUSD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 0.666185, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:21,047 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDCAD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.384295, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:21,048 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 1.384295, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:21,051 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDCAD.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.384295, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:21,052 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDCAD.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDCAD.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 1.384295, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:21,070 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 98.235, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:21,072 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 98.235, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:23,032 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 98.23599999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:23,034 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 98.23599999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:23,036 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.451, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:23,037 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 147.451, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:23,038 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.USDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.451, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:23,039 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.USDJPY.MINI.IP', 5, ...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.USDJPY.MINI.IP', 'timeframe': 5, 'timestamp': datetime.datetime(2025, 9, 12, 3, 45), 'close': 147.451, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-09-12 05:46:23,063 - ERROR - igstream.chart_streamer - ‚ùå Error storing candle for CS.D.AUDJPY.MINI.IP: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.23599999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-12 05:46:23,063 - ERROR - igstream.chart_streamer - Full traceback: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/igstream/chart_streamer.py", line 221, in _store_candle
    validation_result = validation_session.execute(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function validate_price_data(unknown, integer, timestamp without time zone, numeric, unknown, numeric) does not exist
LINE 1: SELECT * FROM validate_price_data('CS.D.AUDJPY.MINI.IP', 60,...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT * FROM validate_price_data(%(epic)s, %(timeframe)s, %(timestamp)s, %(close)s, %(source)s, %(threshold)s)]
[parameters: {'epic': 'CS.D.AUDJPY.MINI.IP', 'timeframe': 60, 'timestamp': datetime.datetime(2025, 9, 12, 3, 0), 'close': 98.23599999999999, 'source': 'chart_streamer', 'threshold': 5.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

